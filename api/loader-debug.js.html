<!DOCTYPE>
<html class="ltr" xmlns:yui="http://yuilibrary.com/rdf/1.0/yui.rdf#">
<head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
	<title>API: loader   loader-debug.js  (YUI Library)</title>

	<link rel="stylesheet" href="../build/aui-skin-classic/css/aui-skin-classic-all-min.css" type="text/css" media="screen" />
	<link rel="stylesheet" type="text/css" href="assets/custom.css" />

    <script type="text/javascript" src="assets/api-js"></script>
    <script type="text/javascript" src="assets/ac-js"></script>
</head>

<body>

<div id="wrapper">
	<div class="yui3-aui-header">
		<h1>
			<a class="yui3-aui-header-text" href="http://alloy.liferay.com/deploy/api" title="Alloy UI">Alloy UI</a>
		</h1>

		<h3>
			loader&nbsp; <span class="subtitle">1.0.1</span>
		</h3>

		<p class="breadcrumbs">
			<a href="./index.html" title="Alloy UI">Alloy UI</a>

	            <span class="separator">&gt;</span>

				<a class="modulename" href="./module_loader.html" title="loader">loader</a>

	                

	                 <span class="separator">&gt;</span> <span class="filename">loader-debug.js (source view)</span> 
		</p>

		<form onsubmit="return false;">
            <div id="propertysearch">
				<span class="yui3-aui-field yui3-aui-field-text yui3-aui-field-labels-inline yui3-aui-field-labels-right">
					<span class="yui3-aui-field-content">
						<label class="yui3-aui-field-label" for="searchinput">Search:</label>
						<input class="yui3-aui-field-input yui3-aui-field-input-text" id="searchinput" name="searchinput" type="text" value="" />
					</span>
				</span>
                <div id="searchresults">
                    &nbsp;
                </div>
            </div>
        </form>
	</div>

	<div class="yui3-aui-body">
		<form action="#" name="classOptions" id="classOptions">
			<fieldset>
				<legend>Filters</legend>

				<span class="yui3-aui-field yui3-aui-field-checkbox yui3-aui-field-choice yui3-aui-field-inline">
					<span class="yui3-aui-field-content">
						<label class="yui3-aui-field-label" for="show_private">
							<input class="yui3-aui-field-input yui3-aui-field-input-checkbox yui3-aui-field-input-choice" id="show_private" name="show_private" type="checkbox" value="" />
						Show Private</label>
					</span>
				</span>

				<span class="yui3-aui-field yui3-aui-field-checkbox yui3-aui-field-choice yui3-aui-field-inline">
					<span class="yui3-aui-field-content">
						<label class="yui3-aui-field-label" for="show_protected">
							<input class="yui3-aui-field-input yui3-aui-field-input-checkbox yui3-aui-field-input-choice" id="show_protected" name="show_protected" type="checkbox" value="" />
						Show Protected</label>
					</span>
				</span>

				<span class="yui3-aui-field yui3-aui-field-checkbox yui3-aui-field-choice yui3-aui-field-inline">
					<span class="yui3-aui-field-content">
						<label class="yui3-aui-field-label" for="show_deprecated">
							<input class="yui3-aui-field-input yui3-aui-field-input-checkbox yui3-aui-field-input-choice" id="show_deprecated" name="show_deprecated" type="checkbox" value="" />
						Show Deprecated</label>
					</span>
				</span>
			</fieldset>
		</form>

		<div class="yui3-aui-layout">
			<div class="yui3-aui-layout-content">
				<div class="yui3-aui-column yui3-aui-w25 yui3-aui-column-first">
					<div class="yui3-aui-column-content yui3-aui-column-content-first">

						<div class="yui3-widget yui3-aui-list yui3-aui-list-modules">
							<div class="yui3-widget-content">
								<div class="yui3-widget-hd yui3-aui-list-hd yui3-aui-list-modules-hd">
									<span class="yui3-widget-hd-text">Modules</span>
								</div>

								<div class="yui3-widget-bd yui3-aui-list-bd">
									<h4 class="yui3-aui-module-section-heading">Alloy Modules</h4>
									<ul class="content">
			                        </ul>

									<h4 class="yui3-aui-module-section-heading">YUI Modules</h4>
									<ul class="content">



			                                
													<li class=""><a href="module_align-plugin.html" title="align-plugin">align-plugin</a></li>



			                                
													<li class=""><a href="module_anim.html" title="anim">anim</a></li>



			                                
													<li class=""><a href="module_async-queue.html" title="async-queue">async-queue</a></li>



			                                
													<li class=""><a href="module_attribute.html" title="attribute">attribute</a></li>



			                                
													<li class=""><a href="module_aui-autocomplete.html" title="aui-autocomplete">aui-autocomplete</a></li>



			                                
													<li class=""><a href="module_aui-button-item.html" title="aui-button-item">aui-button-item</a></li>



			                                
													<li class=""><a href="module_aui-calendar.html" title="aui-calendar">aui-calendar</a></li>



			                                
													<li class=""><a href="module_aui-char-counter.html" title="aui-char-counter">aui-char-counter</a></li>



			                                
													<li class=""><a href="module_aui-color-picker.html" title="aui-color-picker">aui-color-picker</a></li>



			                                
													<li class=""><a href="module_aui-component.html" title="aui-component">aui-component</a></li>



			                                
													<li class=""><a href="module_aui-datatype.html" title="aui-datatype">aui-datatype</a></li>



			                                
													<li class=""><a href="module_aui-delayed-task.html" title="aui-delayed-task">aui-delayed-task</a></li>



			                                
													<li class=""><a href="module_aui-dialog.html" title="aui-dialog">aui-dialog</a></li>



			                                
													<li class=""><a href="module_aui-editable.html" title="aui-editable">aui-editable</a></li>



			                                
													<li class=""><a href="module_aui-event.html" title="aui-event">aui-event</a></li>



			                                
													<li class=""><a href="module_aui-image-viewer.html" title="aui-image-viewer">aui-image-viewer</a></li>



			                                
													<li class=""><a href="module_aui-io.html" title="aui-io">aui-io</a></li>



			                                
													<li class=""><a href="module_aui-live-search.html" title="aui-live-search">aui-live-search</a></li>



			                                
													<li class=""><a href="module_aui-loading-mask.html" title="aui-loading-mask">aui-loading-mask</a></li>



			                                
													<li class=""><a href="module_aui-nested-list.html" title="aui-nested-list">aui-nested-list</a></li>



			                                
													<li class=""><a href="module_aui-node.html" title="aui-node">aui-node</a></li>



			                                
													<li class=""><a href="module_aui-overlay.html" title="aui-overlay">aui-overlay</a></li>



			                                
													<li class=""><a href="module_aui-paginator.html" title="aui-paginator">aui-paginator</a></li>



			                                
													<li class=""><a href="module_aui-panel.html" title="aui-panel">aui-panel</a></li>



			                                
													<li class=""><a href="module_aui-parse-content.html" title="aui-parse-content">aui-parse-content</a></li>



			                                
													<li class=""><a href="module_aui-portal-layout.html" title="aui-portal-layout">aui-portal-layout</a></li>



			                                
													<li class=""><a href="module_aui-progressbar.html" title="aui-progressbar">aui-progressbar</a></li>



			                                
													<li class=""><a href="module_aui-rating.html" title="aui-rating">aui-rating</a></li>



			                                
													<li class=""><a href="module_aui-resize.html" title="aui-resize">aui-resize</a></li>



			                                
													<li class=""><a href="module_aui-textboxlist.html" title="aui-textboxlist">aui-textboxlist</a></li>



			                                
													<li class=""><a href="module_aui-toolbar.html" title="aui-toolbar">aui-toolbar</a></li>



			                                
													<li class=""><a href="module_aui-tooltip.html" title="aui-tooltip">aui-tooltip</a></li>



			                                
													<li class=""><a href="module_aui-tree.html" title="aui-tree">aui-tree</a></li>



			                                
													<li class=""><a href="module_autocomplete.html" title="autocomplete">autocomplete</a></li>



			                                
													<li class=""><a href="module_base.html" title="base">base</a></li>



			                                
													<li class=""><a href="module_cache.html" title="cache">cache</a></li>



			                                
													<li class=""><a href="module_charts.html" title="charts">charts</a></li>



			                                
													<li class=""><a href="module_classnamemanager.html" title="classnamemanager">classnamemanager</a></li>



			                                
													<li class=""><a href="module_collection.html" title="collection">collection</a></li>



			                                
													<li class=""><a href="module_console.html" title="console">console</a></li>



			                                
													<li class=""><a href="module_console-filters.html" title="console-filters">console-filters</a></li>



			                                
													<li class=""><a href="module_cookie.html" title="cookie">cookie</a></li>



			                                
													<li class=""><a href="module_dataschema.html" title="dataschema">dataschema</a></li>



			                                
													<li class=""><a href="module_datasource.html" title="datasource">datasource</a></li>



			                                
													<li class=""><a href="module_datatable.html" title="datatable">datatable</a></li>



			                                
													<li class=""><a href="module_datatype.html" title="datatype">datatype</a></li>



			                                
													<li class=""><a href="module_dd.html" title="dd">dd</a></li>



			                                
													<li class=""><a href="module_dial.html" title="dial">dial</a></li>



			                                
													<li class=""><a href="module_dom.html" title="dom">dom</a></li>



			                                
													<li class=""><a href="module_dump.html" title="dump">dump</a></li>



			                                
													<li class=""><a href="module_editor.html" title="editor">editor</a></li>



			                                
													<li class=""><a href="module_escape.html" title="escape">escape</a></li>



			                                
													<li class=""><a href="module_event.html" title="event">event</a></li>



			                                
													<li class=""><a href="module_event-custom.html" title="event-custom">event-custom</a></li>



			                                
													<li class=""><a href="module_event-gestures.html" title="event-gestures">event-gestures</a></li>



			                                
													<li class=""><a href="module_event-simulate.html" title="event-simulate">event-simulate</a></li>



			                                
													<li class=""><a href="module_event-touch.html" title="event-touch">event-touch</a></li>



			                                
													<li class=""><a href="module_event-valuechange.html" title="event-valuechange">event-valuechange</a></li>



			                                
													<li class=""><a href="module_highlight.html" title="highlight">highlight</a></li>



			                                
													<li class=""><a href="module_history.html" title="history">history</a></li>



			                                
													<li class=""><a href="module_history-deprecated.html" title="history-deprecated">history-deprecated</a></li>



			                                
													<li class=""><a href="module_imageloader.html" title="imageloader">imageloader</a></li>



			                                
													<li class=""><a href="module_intl.html" title="intl">intl</a></li>



			                                
													<li class=""><a href="module_io.html" title="io">io</a></li>



			                                
													<li class=""><a href="module_json.html" title="json">json</a></li>



			                                
													<li class=""><a href="module_jsonp.html" title="jsonp">jsonp</a></li>



			                                
													<li class="selected"><a href="module_loader.html" title="loader">loader</a></li>



			                                
													<li class=""><a href="module_node.html" title="node">node</a></li>



			                                
													<li class=""><a href="module_node-flick.html" title="node-flick">node-flick</a></li>



			                                
													<li class=""><a href="module_node-focusmanager.html" title="node-focusmanager">node-focusmanager</a></li>



			                                
													<li class=""><a href="module_node-menunav.html" title="node-menunav">node-menunav</a></li>



			                                
													<li class=""><a href="module_oop.html" title="oop">oop</a></li>



			                                
													<li class=""><a href="module_overlay.html" title="overlay">overlay</a></li>



			                                
													<li class=""><a href="module_plugin.html" title="plugin">plugin</a></li>



			                                
													<li class=""><a href="module_pluginhost.html" title="pluginhost">pluginhost</a></li>



			                                
													<li class=""><a href="module_pluginhost-base.html" title="pluginhost-base">pluginhost-base</a></li>



			                                
													<li class=""><a href="module_profiler.html" title="profiler">profiler</a></li>



			                                
													<li class=""><a href="module_querystring.html" title="querystring">querystring</a></li>



			                                
													<li class=""><a href="module_queue-promote.html" title="queue-promote">queue-promote</a></li>



			                                
													<li class=""><a href="module_recordset.html" title="recordset">recordset</a></li>



			                                
													<li class=""><a href="module_resize.html" title="resize">resize</a></li>



			                                
													<li class=""><a href="module_scrollview.html" title="scrollview">scrollview</a></li>



			                                
													<li class=""><a href="module_scrollview-base.html" title="scrollview-base">scrollview-base</a></li>



			                                
													<li class=""><a href="module_scrollview-base-ie.html" title="scrollview-base-ie">scrollview-base-ie</a></li>



			                                
													<li class=""><a href="module_scrollview-paginator.html" title="scrollview-paginator">scrollview-paginator</a></li>



			                                
													<li class=""><a href="module_scrollview-scrollbars.html" title="scrollview-scrollbars">scrollview-scrollbars</a></li>



			                                
													<li class=""><a href="module_shim-plugin.html" title="shim-plugin">shim-plugin</a></li>



			                                
													<li class=""><a href="module_slider.html" title="slider">slider</a></li>



			                                
													<li class=""><a href="module_sortable.html" title="sortable">sortable</a></li>



			                                
													<li class=""><a href="module_stylesheet.html" title="stylesheet">stylesheet</a></li>



			                                
													<li class=""><a href="module_substitute.html" title="substitute">substitute</a></li>



			                                
													<li class=""><a href="module_swf.html" title="swf">swf</a></li>



			                                
													<li class=""><a href="module_swfdetect.html" title="swfdetect">swfdetect</a></li>



			                                
													<li class=""><a href="module_tabview.html" title="tabview">tabview</a></li>



			                                
													<li class=""><a href="module_test.html" title="test">test</a></li>



			                                
													<li class=""><a href="module_text.html" title="text">text</a></li>



			                                
													<li class=""><a href="module_transition.html" title="transition">transition</a></li>



			                                
													<li class=""><a href="module_uploader.html" title="uploader">uploader</a></li>



			                                
													<li class=""><a href="module_value-change.html" title="value-change">value-change</a></li>



			                                
													<li class=""><a href="module_widget.html" title="widget">widget</a></li>



			                                
													<li class=""><a href="module_widget-anim.html" title="widget-anim">widget-anim</a></li>



			                                
													<li class=""><a href="module_widget-base-ie.html" title="widget-base-ie">widget-base-ie</a></li>



			                                
													<li class=""><a href="module_widget-child.html" title="widget-child">widget-child</a></li>



			                                
													<li class=""><a href="module_widget-locale.html" title="widget-locale">widget-locale</a></li>



			                                
													<li class=""><a href="module_widget-parent.html" title="widget-parent">widget-parent</a></li>



			                                
													<li class=""><a href="module_widget-position.html" title="widget-position">widget-position</a></li>



			                                
													<li class=""><a href="module_widget-position-align.html" title="widget-position-align">widget-position-align</a></li>



			                                
													<li class=""><a href="module_widget-position-constrain.html" title="widget-position-constrain">widget-position-constrain</a></li>



			                                
													<li class=""><a href="module_widget-stack.html" title="widget-stack">widget-stack</a></li>



			                                
													<li class=""><a href="module_widget-stdmod.html" title="widget-stdmod">widget-stdmod</a></li>



			                                
													<li class=""><a href="module_yql.html" title="yql">yql</a></li>



			                                
													<li class=""><a href="module_yui.html" title="yui">yui</a></li>
			                        </ul>
								</div>
							</div>
						</div>

							<div class="yui3-widget yui3-aui-list yui3-aui-list-classes">
								<div class="yui3-widget-content">
									<div class="yui3-widget-hd yui3-aui-list-hd yui3-aui-list-classes-hd">
										<span class="yui3-widget-hd-text">Classes</span>
									</div>

									<div class="yui3-widget-bd yui3-aui-list-bd">
										<ul class="content">


				                                <li class=""><a href="Loader.html" title="Loader">Loader</a></li>
				                        </ul>
									</div>
								</div>
							</div>




					</div>

						<div class="yui3-widget yui3-aui-list yui3-aui-list-files">
							<div class="yui3-widget-content">
								<div class="yui3-widget-hd yui3-aui-list-hd yui3-aui-list-files-hd">
									<span class="yui3-widget-hd-text">Files</span>
								</div>

								<div class="yui3-widget-bd yui3-aui-list-bd">
									<ul class="content">


			                                <li class=""><a href="loader-base-debug.js.html" title="loader-base-debug.js">loader-base-debug.js</a></li>


			                                <li class=""><a href="loader-base-min.js.html" title="loader-base-min.js">loader-base-min.js</a></li>


			                                <li class=""><a href="loader-base.js.html" title="loader-base.js">loader-base.js</a></li>


			                                <li class="selected"><a href="loader-debug.js.html" title="loader-debug.js">loader-debug.js</a></li>


			                                <li class=""><a href="loader-min.js.html" title="loader-min.js">loader-min.js</a></li>


			                                <li class=""><a href="loader-rollup-debug.js.html" title="loader-rollup-debug.js">loader-rollup-debug.js</a></li>


			                                <li class=""><a href="loader-rollup-min.js.html" title="loader-rollup-min.js">loader-rollup-min.js</a></li>


			                                <li class=""><a href="loader-rollup.js.html" title="loader-rollup.js">loader-rollup.js</a></li>


			                                <li class=""><a href="loader-yui3-debug.js.html" title="loader-yui3-debug.js">loader-yui3-debug.js</a></li>


			                                <li class=""><a href="loader-yui3-min.js.html" title="loader-yui3-min.js">loader-yui3-min.js</a></li>


			                                <li class=""><a href="loader-yui3.js.html" title="loader-yui3.js">loader-yui3.js</a></li>


			                                <li class=""><a href="loader.js.html" title="loader.js">loader.js</a></li>
			                        </ul>
								</div>
							</div>
						</div>
				</div>
				<div class="yui3-aui-column yui3-aui-w75 yui3-aui-column-last">
					<div class="yui3-aui-column-content yui3-aui-column-content-last">


							<div id="srcout">
								<style>
									#doc3 .classopts { display:none; }
								</style>
								<div class="highlight"><pre><span class="cm">/*</span>
<span class="cm">Copyright (c) 2010, Yahoo! Inc. All rights reserved.</span>
<span class="cm">Code licensed under the BSD License:</span>
<span class="cm">http://developer.yahoo.com/yui/license.html</span>
<span class="cm">version: 3.3.0</span>
<span class="cm">build: nightly</span>
<span class="cm">*/</span>
<span class="nx">YUI</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="s1">&#39;loader-base&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">Y</span><span class="p">)</span> <span class="p">{</span>

<span class="cm">/**</span>
<span class="cm"> * The YUI loader core</span>
<span class="cm"> * @module loader</span>
<span class="cm"> * @submodule loader-base</span>
<span class="cm"> */</span>

<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">YUI</span><span class="p">.</span><span class="nx">Env</span><span class="p">[</span><span class="nx">Y</span><span class="p">.</span><span class="nx">version</span><span class="p">])</span> <span class="p">{</span>

    <span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">VERSION</span> <span class="o">=</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">version</span><span class="p">,</span>
            <span class="nx">BUILD</span> <span class="o">=</span> <span class="s1">&#39;/build/&#39;</span><span class="p">,</span>
            <span class="nx">ROOT</span> <span class="o">=</span> <span class="nx">VERSION</span> <span class="o">+</span> <span class="nx">BUILD</span><span class="p">,</span>
            <span class="nx">CDN_BASE</span> <span class="o">=</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">Env</span><span class="p">.</span><span class="nx">base</span><span class="p">,</span>
            <span class="nx">GALLERY_VERSION</span> <span class="o">=</span> <span class="s1">&#39;gallery-2010.12.16-18-24&#39;</span><span class="p">,</span>
            <span class="nx">TNT</span> <span class="o">=</span> <span class="s1">&#39;2in3&#39;</span><span class="p">,</span>
            <span class="nx">TNT_VERSION</span> <span class="o">=</span> <span class="s1">&#39;4&#39;</span><span class="p">,</span>
            <span class="nx">YUI2_VERSION</span> <span class="o">=</span> <span class="s1">&#39;2.8.2&#39;</span><span class="p">,</span>
            <span class="nx">COMBO_BASE</span> <span class="o">=</span> <span class="nx">CDN_BASE</span> <span class="o">+</span> <span class="s1">&#39;combo?&#39;</span><span class="p">,</span>
            <span class="nx">META</span> <span class="o">=</span> <span class="p">{</span> <span class="nx">version</span><span class="o">:</span> <span class="nx">VERSION</span><span class="p">,</span>
                              <span class="nx">root</span><span class="o">:</span> <span class="nx">ROOT</span><span class="p">,</span>
                              <span class="nx">base</span><span class="o">:</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">Env</span><span class="p">.</span><span class="nx">base</span><span class="p">,</span>
                              <span class="nx">comboBase</span><span class="o">:</span> <span class="nx">COMBO_BASE</span><span class="p">,</span>
                              <span class="nx">skin</span><span class="o">:</span> <span class="p">{</span> <span class="nx">defaultSkin</span><span class="o">:</span> <span class="s1">&#39;sam&#39;</span><span class="p">,</span>
                                           <span class="nx">base</span><span class="o">:</span> <span class="s1">&#39;assets/skins/&#39;</span><span class="p">,</span>
                                           <span class="nx">path</span><span class="o">:</span> <span class="s1">&#39;skin.css&#39;</span><span class="p">,</span>
                                           <span class="nx">after</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;cssreset&#39;</span><span class="p">,</span>
                                                          <span class="s1">&#39;cssfonts&#39;</span><span class="p">,</span>
                                                          <span class="s1">&#39;cssgrids&#39;</span><span class="p">,</span>
                                                          <span class="s1">&#39;cssbase&#39;</span><span class="p">,</span>
                                                          <span class="s1">&#39;cssreset-context&#39;</span><span class="p">,</span>
                                                          <span class="s1">&#39;cssfonts-context&#39;</span><span class="p">]},</span>
                              <span class="nx">groups</span><span class="o">:</span> <span class="p">{},</span>
                              <span class="nx">patterns</span><span class="o">:</span> <span class="p">{}</span> <span class="p">},</span>
            <span class="nx">groups</span> <span class="o">=</span> <span class="nx">META</span><span class="p">.</span><span class="nx">groups</span><span class="p">,</span>
            <span class="nx">yui2Update</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">tnt</span><span class="p">,</span> <span class="nx">yui2</span><span class="p">)</span> <span class="p">{</span>
                                  <span class="kd">var</span> <span class="nx">root</span> <span class="o">=</span> <span class="nx">TNT</span> <span class="o">+</span> <span class="s1">&#39;.&#39;</span> <span class="o">+</span>
                                            <span class="p">(</span><span class="nx">tnt</span> <span class="o">||</span> <span class="nx">TNT_VERSION</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span> <span class="o">+</span>
                                            <span class="p">(</span><span class="nx">yui2</span> <span class="o">||</span> <span class="nx">YUI2_VERSION</span><span class="p">)</span> <span class="o">+</span> <span class="nx">BUILD</span><span class="p">;</span>
                                  <span class="nx">groups</span><span class="p">.</span><span class="nx">yui2</span><span class="p">.</span><span class="nx">base</span> <span class="o">=</span> <span class="nx">CDN_BASE</span> <span class="o">+</span> <span class="nx">root</span><span class="p">;</span>
                                  <span class="nx">groups</span><span class="p">.</span><span class="nx">yui2</span><span class="p">.</span><span class="nx">root</span> <span class="o">=</span> <span class="nx">root</span><span class="p">;</span>
                              <span class="p">},</span>
            <span class="nx">galleryUpdate</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">tag</span><span class="p">)</span> <span class="p">{</span>
                                  <span class="kd">var</span> <span class="nx">root</span> <span class="o">=</span> <span class="p">(</span><span class="nx">tag</span> <span class="o">||</span> <span class="nx">GALLERY_VERSION</span><span class="p">)</span> <span class="o">+</span> <span class="nx">BUILD</span><span class="p">;</span>
                                  <span class="nx">groups</span><span class="p">.</span><span class="nx">gallery</span><span class="p">.</span><span class="nx">base</span> <span class="o">=</span> <span class="nx">CDN_BASE</span> <span class="o">+</span> <span class="nx">root</span><span class="p">;</span>
                                  <span class="nx">groups</span><span class="p">.</span><span class="nx">gallery</span><span class="p">.</span><span class="nx">root</span> <span class="o">=</span> <span class="nx">root</span><span class="p">;</span>
                              <span class="p">};</span>

        <span class="nx">groups</span><span class="p">[</span><span class="nx">VERSION</span><span class="p">]</span> <span class="o">=</span> <span class="p">{};</span>

        <span class="nx">groups</span><span class="p">.</span><span class="nx">gallery</span> <span class="o">=</span> <span class="p">{</span>
            <span class="nx">ext</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
            <span class="nx">combine</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
            <span class="nx">comboBase</span><span class="o">:</span> <span class="nx">COMBO_BASE</span><span class="p">,</span>
            <span class="nx">update</span><span class="o">:</span> <span class="nx">galleryUpdate</span><span class="p">,</span>
            <span class="nx">patterns</span><span class="o">:</span> <span class="p">{</span> <span class="s1">&#39;gallery-&#39;</span><span class="o">:</span> <span class="p">{</span> <span class="p">},</span>
                        <span class="s1">&#39;gallerycss-&#39;</span><span class="o">:</span> <span class="p">{</span> <span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;css&#39;</span> <span class="p">}</span> <span class="p">}</span>
        <span class="p">};</span>

        <span class="nx">groups</span><span class="p">.</span><span class="nx">yui2</span> <span class="o">=</span> <span class="p">{</span>
            <span class="nx">combine</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
            <span class="nx">ext</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
            <span class="nx">comboBase</span><span class="o">:</span> <span class="nx">COMBO_BASE</span><span class="p">,</span>
            <span class="nx">update</span><span class="o">:</span> <span class="nx">yui2Update</span><span class="p">,</span>
            <span class="nx">patterns</span><span class="o">:</span> <span class="p">{</span>
                <span class="s1">&#39;yui2-&#39;</span><span class="o">:</span> <span class="p">{</span>
                    <span class="nx">configFn</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">me</span><span class="p">)</span> <span class="p">{</span>
                        <span class="k">if</span> <span class="p">(</span><span class="sr">/-skin|reset|fonts|grids|base/</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">me</span><span class="p">.</span><span class="nx">name</span><span class="p">))</span> <span class="p">{</span>
                            <span class="nx">me</span><span class="p">.</span><span class="nx">type</span> <span class="o">=</span> <span class="s1">&#39;css&#39;</span><span class="p">;</span>
                            <span class="nx">me</span><span class="p">.</span><span class="nx">path</span> <span class="o">=</span> <span class="nx">me</span><span class="p">.</span><span class="nx">path</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/\.js/</span><span class="p">,</span> <span class="s1">&#39;.css&#39;</span><span class="p">);</span>
                            <span class="c1">// this makes skins in builds earlier than</span>
                            <span class="c1">// 2.6.0 work as long as combine is false</span>
                            <span class="nx">me</span><span class="p">.</span><span class="nx">path</span> <span class="o">=</span> <span class="nx">me</span><span class="p">.</span><span class="nx">path</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/\/yui2-skin/</span><span class="p">,</span>
                                             <span class="s1">&#39;/assets/skins/sam/yui2-skin&#39;</span><span class="p">);</span>
                        <span class="p">}</span>
                    <span class="p">}</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">};</span>

        <span class="nx">galleryUpdate</span><span class="p">();</span>
        <span class="nx">yui2Update</span><span class="p">();</span>

        <span class="nx">YUI</span><span class="p">.</span><span class="nx">Env</span><span class="p">[</span><span class="nx">VERSION</span><span class="p">]</span> <span class="o">=</span> <span class="nx">META</span><span class="p">;</span>
    <span class="p">}());</span>
<span class="p">}</span>



<span class="cm">/**</span>
<span class="cm"> * Loader dynamically loads script and css files.  It includes the dependency</span>
<span class="cm"> * info for the version of the library in use, and will automatically pull in</span>
<span class="cm"> * dependencies for the modules requested.  It supports rollup files and will</span>
<span class="cm"> * automatically use these when appropriate in order to minimize the number of</span>
<span class="cm"> * http connections required to load all of the dependencies.  It can load the</span>
<span class="cm"> * files from the Yahoo! CDN, and it can utilize the combo service provided on</span>
<span class="cm"> * this network to reduce the number of http connections required to download</span>
<span class="cm"> * YUI files.</span>
<span class="cm"> *</span>
<span class="cm"> * @module loader</span>
<span class="cm"> * @submodule loader-base</span>
<span class="cm"> */</span>

<span class="kd">var</span> <span class="nx">NOT_FOUND</span> <span class="o">=</span> <span class="p">{},</span>
    <span class="nx">NO_REQUIREMENTS</span> <span class="o">=</span> <span class="p">[],</span>
    <span class="nx">MAX_URL_LENGTH</span> <span class="o">=</span> <span class="p">(</span><span class="nx">Y</span><span class="p">.</span><span class="nx">UA</span><span class="p">.</span><span class="nx">ie</span><span class="p">)</span> <span class="o">?</span> <span class="mi">2048</span> <span class="o">:</span> <span class="mi">8192</span><span class="p">,</span>
    <span class="nx">GLOBAL_ENV</span> <span class="o">=</span> <span class="nx">YUI</span><span class="p">.</span><span class="nx">Env</span><span class="p">,</span>
    <span class="nx">GLOBAL_LOADED</span> <span class="o">=</span> <span class="nx">GLOBAL_ENV</span><span class="p">.</span><span class="nx">_loaded</span><span class="p">,</span>
    <span class="nx">CSS</span> <span class="o">=</span> <span class="s1">&#39;css&#39;</span><span class="p">,</span>
    <span class="nx">JS</span> <span class="o">=</span> <span class="s1">&#39;js&#39;</span><span class="p">,</span>
    <span class="nx">INTL</span> <span class="o">=</span> <span class="s1">&#39;intl&#39;</span><span class="p">,</span>
    <span class="nx">VERSION</span> <span class="o">=</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">version</span><span class="p">,</span>
    <span class="nx">ROOT_LANG</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
    <span class="nx">YObject</span> <span class="o">=</span> <span class="nx">Y</span><span class="p">.</span><span class="nb">Object</span><span class="p">,</span>
    <span class="nx">oeach</span> <span class="o">=</span> <span class="nx">YObject</span><span class="p">.</span><span class="nx">each</span><span class="p">,</span>
    <span class="nx">YArray</span> <span class="o">=</span> <span class="nx">Y</span><span class="p">.</span><span class="nb">Array</span><span class="p">,</span>
    <span class="nx">_queue</span> <span class="o">=</span> <span class="nx">GLOBAL_ENV</span><span class="p">.</span><span class="nx">_loaderQueue</span><span class="p">,</span>
    <span class="nx">META</span> <span class="o">=</span> <span class="nx">GLOBAL_ENV</span><span class="p">[</span><span class="nx">VERSION</span><span class="p">],</span>
    <span class="nx">SKIN_PREFIX</span> <span class="o">=</span> <span class="s1">&#39;skin-&#39;</span><span class="p">,</span>
    <span class="nx">L</span> <span class="o">=</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">Lang</span><span class="p">,</span>
    <span class="nx">ON_PAGE</span> <span class="o">=</span> <span class="nx">GLOBAL_ENV</span><span class="p">.</span><span class="nx">mods</span><span class="p">,</span>
    <span class="nx">modulekey</span><span class="p">,</span>
    <span class="nx">cache</span><span class="p">,</span>
    <span class="nx">_path</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">dir</span><span class="p">,</span> <span class="nx">file</span><span class="p">,</span> <span class="nx">type</span><span class="p">,</span> <span class="nx">nomin</span><span class="p">)</span> <span class="p">{</span>
                        <span class="kd">var</span> <span class="nx">path</span> <span class="o">=</span> <span class="nx">dir</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span> <span class="o">+</span> <span class="nx">file</span><span class="p">;</span>
                        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">nomin</span><span class="p">)</span> <span class="p">{</span>
                            <span class="nx">path</span> <span class="o">+=</span> <span class="s1">&#39;-min&#39;</span><span class="p">;</span>
                        <span class="p">}</span>
                        <span class="nx">path</span> <span class="o">+=</span> <span class="s1">&#39;.&#39;</span> <span class="o">+</span> <span class="p">(</span><span class="nx">type</span> <span class="o">||</span> <span class="nx">CSS</span><span class="p">);</span>

                        <span class="k">return</span> <span class="nx">path</span><span class="p">;</span>
                    <span class="p">};</span>

<span class="cm">/**</span>
<span class="cm"> * The component metadata is stored in Y.Env.meta.</span>
<span class="cm"> * Part of the loader module.</span>
<span class="cm"> * @property Env.meta</span>
<span class="cm"> * @for YUI</span>
<span class="cm"> */</span>
<span class="nx">Y</span><span class="p">.</span><span class="nx">Env</span><span class="p">.</span><span class="nx">meta</span> <span class="o">=</span> <span class="nx">META</span><span class="p">;</span>

<span class="cm">/**</span>
<span class="cm"> * Loader dynamically loads script and css files.  It includes the dependency</span>
<span class="cm"> * info for the version of the library in use, and will automatically pull in</span>
<span class="cm"> * dependencies for the modules requested.  It supports rollup files and will</span>
<span class="cm"> * automatically use these when appropriate in order to minimize the number of</span>
<span class="cm"> * http connections required to load all of the dependencies.  It can load the</span>
<span class="cm"> * files from the Yahoo! CDN, and it can utilize the combo service provided on</span>
<span class="cm"> * this network to reduce the number of http connections required to download</span>
<span class="cm"> * YUI files.</span>
<span class="cm"> *</span>
<span class="cm"> * While the loader can be instantiated by the end user, it normally is not.</span>
<span class="cm"> * @see YUI.use for the normal use case.  The use function automatically will</span>
<span class="cm"> * pull in missing dependencies.</span>
<span class="cm"> *</span>
<span class="cm"> * @constructor</span>
<span class="cm"> * @class Loader</span>
<span class="cm"> * @param {object} o an optional set of configuration options.  Valid options:</span>
<span class="cm"> * &lt;ul&gt;</span>
<span class="cm"> *  &lt;li&gt;base:</span>
<span class="cm"> *  The base dir&lt;/li&gt;</span>
<span class="cm"> *  &lt;li&gt;comboBase:</span>
<span class="cm"> *  The YUI combo service base dir. Ex: http://yui.yahooapis.com/combo?&lt;/li&gt;</span>
<span class="cm"> *  &lt;li&gt;root:</span>
<span class="cm"> *  The root path to prepend to module names for the combo service.</span>
<span class="cm"> *  Ex: 2.5.2/build/&lt;/li&gt;</span>
<span class="cm"> *  &lt;li&gt;filter:.</span>
<span class="cm"> *</span>
<span class="cm"> * A filter to apply to result urls.  This filter will modify the default</span>
<span class="cm"> * path for all modules.  The default path for the YUI library is the</span>
<span class="cm"> * minified version of the files (e.g., event-min.js).  The filter property</span>
<span class="cm"> * can be a predefined filter or a custom filter.  The valid predefined</span>
<span class="cm"> * filters are:</span>
<span class="cm"> * &lt;dl&gt;</span>
<span class="cm"> *  &lt;dt&gt;DEBUG&lt;/dt&gt;</span>
<span class="cm"> *  &lt;dd&gt;Selects the debug versions of the library (e.g., event-debug.js).</span>
<span class="cm"> *      This option will automatically include the Logger widget&lt;/dd&gt;</span>
<span class="cm"> *  &lt;dt&gt;RAW&lt;/dt&gt;</span>
<span class="cm"> *  &lt;dd&gt;Selects the non-minified version of the library (e.g., event.js).</span>
<span class="cm"> *  &lt;/dd&gt;</span>
<span class="cm"> * &lt;/dl&gt;</span>
<span class="cm"> * You can also define a custom filter, which must be an object literal</span>
<span class="cm"> * containing a search expression and a replace string:</span>
<span class="cm"> * &lt;pre&gt;</span>
<span class="cm"> *  myFilter: &amp;#123;</span>
<span class="cm"> *      &#39;searchExp&#39;: &quot;-min\\.js&quot;,</span>
<span class="cm"> *      &#39;replaceStr&#39;: &quot;-debug.js&quot;</span>
<span class="cm"> *  &amp;#125;</span>
<span class="cm"> * &lt;/pre&gt;</span>
<span class="cm"> *</span>
<span class="cm"> *  &lt;/li&gt;</span>
<span class="cm"> *  &lt;li&gt;filters: per-component filter specification.  If specified</span>
<span class="cm"> *  for a given component, this overrides the filter config&lt;/li&gt;</span>
<span class="cm"> *  &lt;li&gt;combine:</span>
<span class="cm"> *  Use the YUI combo service to reduce the number of http connections</span>
<span class="cm"> *  required to load your dependencies&lt;/li&gt;</span>
<span class="cm"> *  &lt;li&gt;ignore:</span>
<span class="cm"> *  A list of modules that should never be dynamically loaded&lt;/li&gt;</span>
<span class="cm"> *  &lt;li&gt;force:</span>
<span class="cm"> *  A list of modules that should always be loaded when required, even if</span>
<span class="cm"> *  already present on the page&lt;/li&gt;</span>
<span class="cm"> *  &lt;li&gt;insertBefore:</span>
<span class="cm"> *  Node or id for a node that should be used as the insertion point for</span>
<span class="cm"> *  new nodes&lt;/li&gt;</span>
<span class="cm"> *  &lt;li&gt;charset:</span>
<span class="cm"> *  charset for dynamic nodes (deprecated, use jsAttributes or cssAttributes)</span>
<span class="cm"> *  &lt;/li&gt;</span>
<span class="cm"> *  &lt;li&gt;jsAttributes: object literal containing attributes to add to script</span>
<span class="cm"> *  nodes&lt;/li&gt;</span>
<span class="cm"> *  &lt;li&gt;cssAttributes: object literal containing attributes to add to link</span>
<span class="cm"> *  nodes&lt;/li&gt;</span>
<span class="cm"> *  &lt;li&gt;timeout:</span>
<span class="cm"> *  The number of milliseconds before a timeout occurs when dynamically</span>
<span class="cm"> *  loading nodes.  If not set, there is no timeout&lt;/li&gt;</span>
<span class="cm"> *  &lt;li&gt;context:</span>
<span class="cm"> *  execution context for all callbacks&lt;/li&gt;</span>
<span class="cm"> *  &lt;li&gt;onSuccess:</span>
<span class="cm"> *  callback for the &#39;success&#39; event&lt;/li&gt;</span>
<span class="cm"> *  &lt;li&gt;onFailure: callback for the &#39;failure&#39; event&lt;/li&gt;</span>
<span class="cm"> *  &lt;li&gt;onCSS: callback for the &#39;CSSComplete&#39; event.  When loading YUI</span>
<span class="cm"> *  components with CSS the CSS is loaded first, then the script.  This</span>
<span class="cm"> *  provides a moment you can tie into to improve</span>
<span class="cm"> *  the presentation of the page while the script is loading.&lt;/li&gt;</span>
<span class="cm"> *  &lt;li&gt;onTimeout:</span>
<span class="cm"> *  callback for the &#39;timeout&#39; event&lt;/li&gt;</span>
<span class="cm"> *  &lt;li&gt;onProgress:</span>
<span class="cm"> *  callback executed each time a script or css file is loaded&lt;/li&gt;</span>
<span class="cm"> *  &lt;li&gt;modules:</span>
<span class="cm"> *  A list of module definitions.  See Loader.addModule for the supported</span>
<span class="cm"> *  module metadata&lt;/li&gt;</span>
<span class="cm"> *  &lt;li&gt;groups:</span>
<span class="cm"> *  A list of group definitions.  Each group can contain specific definitions</span>
<span class="cm"> *  for base, comboBase, combine, and accepts a list of modules.  See above</span>
<span class="cm"> *  for the description of these properties.&lt;/li&gt;</span>
<span class="cm"> *  &lt;li&gt;2in3: the version of the YUI 2 in 3 wrapper to use.  The intrinsic</span>
<span class="cm"> *  support for YUI 2 modules in YUI 3 relies on versions of the YUI 2</span>
<span class="cm"> *  components inside YUI 3 module wrappers.  These wrappers</span>
<span class="cm"> *  change over time to accomodate the issues that arise from running YUI 2</span>
<span class="cm"> *  in a YUI 3 sandbox.&lt;/li&gt;</span>
<span class="cm"> *  &lt;li&gt;yui2: when using the 2in3 project, you can select the version of</span>
<span class="cm"> *  YUI 2 to use.  Valid values *  are 2.2.2, 2.3.1, 2.4.1, 2.5.2, 2.6.0,</span>
<span class="cm"> *  2.7.0, 2.8.0, and 2.8.1 [default] -- plus all versions of YUI 2</span>
<span class="cm"> *  going forward.&lt;/li&gt;</span>
<span class="cm"> * &lt;/ul&gt;</span>
<span class="cm"> */</span>
<span class="nx">Y</span><span class="p">.</span><span class="nx">Loader</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">o</span><span class="p">)</span> <span class="p">{</span>

    <span class="kd">var</span> <span class="nx">defaults</span> <span class="o">=</span> <span class="nx">META</span><span class="p">.</span><span class="nx">modules</span><span class="p">,</span>
        <span class="nx">self</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>

    <span class="nx">modulekey</span> <span class="o">=</span> <span class="nx">META</span><span class="p">.</span><span class="nx">md5</span><span class="p">;</span>

    <span class="cm">/**</span>
<span class="cm">     * Internal callback to handle multiple internal insert() calls</span>
<span class="cm">     * so that css is inserted prior to js</span>
<span class="cm">     * @property _internalCallback</span>
<span class="cm">     * @private</span>
<span class="cm">     */</span>
    <span class="c1">// self._internalCallback = null;</span>

    <span class="cm">/**</span>
<span class="cm">     * Callback that will be executed when the loader is finished</span>
<span class="cm">     * with an insert</span>
<span class="cm">     * @method onSuccess</span>
<span class="cm">     * @type function</span>
<span class="cm">     */</span>
    <span class="c1">// self.onSuccess = null;</span>

    <span class="cm">/**</span>
<span class="cm">     * Callback that will be executed if there is a failure</span>
<span class="cm">     * @method onFailure</span>
<span class="cm">     * @type function</span>
<span class="cm">     */</span>
    <span class="c1">// self.onFailure = null;</span>

    <span class="cm">/**</span>
<span class="cm">     * Callback for the &#39;CSSComplete&#39; event.  When loading YUI components</span>
<span class="cm">     * with CSS the CSS is loaded first, then the script.  This provides</span>
<span class="cm">     * a moment you can tie into to improve the presentation of the page</span>
<span class="cm">     * while the script is loading.</span>
<span class="cm">     * @method onCSS</span>
<span class="cm">     * @type function</span>
<span class="cm">     */</span>
    <span class="c1">// self.onCSS = null;</span>

    <span class="cm">/**</span>
<span class="cm">     * Callback executed each time a script or css file is loaded</span>
<span class="cm">     * @method onProgress</span>
<span class="cm">     * @type function</span>
<span class="cm">     */</span>
    <span class="c1">// self.onProgress = null;</span>

    <span class="cm">/**</span>
<span class="cm">     * Callback that will be executed if a timeout occurs</span>
<span class="cm">     * @method onTimeout</span>
<span class="cm">     * @type function</span>
<span class="cm">     */</span>
    <span class="c1">// self.onTimeout = null;</span>

    <span class="cm">/**</span>
<span class="cm">     * The execution context for all callbacks</span>
<span class="cm">     * @property context</span>
<span class="cm">     * @default {YUI} the YUI instance</span>
<span class="cm">     */</span>
    <span class="nx">self</span><span class="p">.</span><span class="nx">context</span> <span class="o">=</span> <span class="nx">Y</span><span class="p">;</span>

    <span class="cm">/**</span>
<span class="cm">     * Data that is passed to all callbacks</span>
<span class="cm">     * @property data</span>
<span class="cm">     */</span>
    <span class="c1">// self.data = null;</span>

    <span class="cm">/**</span>
<span class="cm">     * Node reference or id where new nodes should be inserted before</span>
<span class="cm">     * @property insertBefore</span>
<span class="cm">     * @type string|HTMLElement</span>
<span class="cm">     */</span>
    <span class="c1">// self.insertBefore = null;</span>

    <span class="cm">/**</span>
<span class="cm">     * The charset attribute for inserted nodes</span>
<span class="cm">     * @property charset</span>
<span class="cm">     * @type string</span>
<span class="cm">     * @deprecated , use cssAttributes or jsAttributes.</span>
<span class="cm">     */</span>
    <span class="c1">// self.charset = null;</span>

    <span class="cm">/**</span>
<span class="cm">     * An object literal containing attributes to add to link nodes</span>
<span class="cm">     * @property cssAttributes</span>
<span class="cm">     * @type object</span>
<span class="cm">     */</span>
    <span class="c1">// self.cssAttributes = null;</span>

    <span class="cm">/**</span>
<span class="cm">     * An object literal containing attributes to add to script nodes</span>
<span class="cm">     * @property jsAttributes</span>
<span class="cm">     * @type object</span>
<span class="cm">     */</span>
    <span class="c1">// self.jsAttributes = null;</span>

    <span class="cm">/**</span>
<span class="cm">     * The base directory.</span>
<span class="cm">     * @property base</span>
<span class="cm">     * @type string</span>
<span class="cm">     * @default http://yui.yahooapis.com/[YUI VERSION]/build/</span>
<span class="cm">     */</span>
    <span class="nx">self</span><span class="p">.</span><span class="nx">base</span> <span class="o">=</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">Env</span><span class="p">.</span><span class="nx">meta</span><span class="p">.</span><span class="nx">base</span><span class="p">;</span>

    <span class="cm">/**</span>
<span class="cm">     * Base path for the combo service</span>
<span class="cm">     * @property comboBase</span>
<span class="cm">     * @type string</span>
<span class="cm">     * @default http://yui.yahooapis.com/combo?</span>
<span class="cm">     */</span>
    <span class="nx">self</span><span class="p">.</span><span class="nx">comboBase</span> <span class="o">=</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">Env</span><span class="p">.</span><span class="nx">meta</span><span class="p">.</span><span class="nx">comboBase</span><span class="p">;</span>

    <span class="cm">/*</span>
<span class="cm">     * Base path for language packs.</span>
<span class="cm">     */</span>
    <span class="c1">// self.langBase = Y.Env.meta.langBase;</span>
    <span class="c1">// self.lang = &quot;&quot;;</span>

    <span class="cm">/**</span>
<span class="cm">     * If configured, the loader will attempt to use the combo</span>
<span class="cm">     * service for YUI resources and configured external resources.</span>
<span class="cm">     * @property combine</span>
<span class="cm">     * @type boolean</span>
<span class="cm">     * @default true if a base dir isn&#39;t in the config</span>
<span class="cm">     */</span>
    <span class="nx">self</span><span class="p">.</span><span class="nx">combine</span> <span class="o">=</span> <span class="nx">o</span><span class="p">.</span><span class="nx">base</span> <span class="o">&amp;&amp;</span>
        <span class="p">(</span><span class="nx">o</span><span class="p">.</span><span class="nx">base</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">self</span><span class="p">.</span><span class="nx">comboBase</span><span class="p">.</span><span class="nx">substr</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">))</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mi">1</span><span class="p">);</span>

    <span class="cm">/**</span>
<span class="cm">     * Max url length for combo urls.  The default is 2048 for</span>
<span class="cm">     * internet explorer, and 8192 otherwise.  This is the URL</span>
<span class="cm">     * limit for the Yahoo! hosted combo servers.  If consuming</span>
<span class="cm">     * a different combo service that has a different URL limit</span>
<span class="cm">     * it is possible to override this default by supplying</span>
<span class="cm">     * the maxURLLength config option.  The config option will</span>
<span class="cm">     * only take effect if lower than the default.</span>
<span class="cm">     *</span>
<span class="cm">     * Browsers:</span>
<span class="cm">     *    IE: 2048</span>
<span class="cm">     *    Other A-Grade Browsers: Higher that what is typically supported</span>
<span class="cm">     *    &#39;capable&#39; mobile browsers:</span>
<span class="cm">     *</span>
<span class="cm">     * Servers:</span>
<span class="cm">     *    Apache: 8192</span>
<span class="cm">     *</span>
<span class="cm">     * @property maxURLLength</span>
<span class="cm">     * @type int</span>
<span class="cm">     */</span>
    <span class="nx">self</span><span class="p">.</span><span class="nx">maxURLLength</span> <span class="o">=</span> <span class="nx">MAX_URL_LENGTH</span><span class="p">;</span>

    <span class="cm">/**</span>
<span class="cm">     * Ignore modules registered on the YUI global</span>
<span class="cm">     * @property ignoreRegistered</span>
<span class="cm">     * @default false</span>
<span class="cm">     */</span>
    <span class="c1">// self.ignoreRegistered = false;</span>

    <span class="cm">/**</span>
<span class="cm">     * Root path to prepend to module path for the combo</span>
<span class="cm">     * service</span>
<span class="cm">     * @property root</span>
<span class="cm">     * @type string</span>
<span class="cm">     * @default [YUI VERSION]/build/</span>
<span class="cm">     */</span>
    <span class="nx">self</span><span class="p">.</span><span class="nx">root</span> <span class="o">=</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">Env</span><span class="p">.</span><span class="nx">meta</span><span class="p">.</span><span class="nx">root</span><span class="p">;</span>

    <span class="cm">/**</span>
<span class="cm">     * Timeout value in milliseconds.  If set, self value will be used by</span>
<span class="cm">     * the get utility.  the timeout event will fire if</span>
<span class="cm">     * a timeout occurs.</span>
<span class="cm">     * @property timeout</span>
<span class="cm">     * @type int</span>
<span class="cm">     */</span>
    <span class="nx">self</span><span class="p">.</span><span class="nx">timeout</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

    <span class="cm">/**</span>
<span class="cm">     * A list of modules that should not be loaded, even if</span>
<span class="cm">     * they turn up in the dependency tree</span>
<span class="cm">     * @property ignore</span>
<span class="cm">     * @type string[]</span>
<span class="cm">     */</span>
    <span class="c1">// self.ignore = null;</span>

    <span class="cm">/**</span>
<span class="cm">     * A list of modules that should always be loaded, even</span>
<span class="cm">     * if they have already been inserted into the page.</span>
<span class="cm">     * @property force</span>
<span class="cm">     * @type string[]</span>
<span class="cm">     */</span>
    <span class="c1">// self.force = null;</span>

    <span class="nx">self</span><span class="p">.</span><span class="nx">forceMap</span> <span class="o">=</span> <span class="p">{};</span>

    <span class="cm">/**</span>
<span class="cm">     * Should we allow rollups</span>
<span class="cm">     * @property allowRollup</span>
<span class="cm">     * @type boolean</span>
<span class="cm">     * @default true</span>
<span class="cm">     */</span>
    <span class="nx">self</span><span class="p">.</span><span class="nx">allowRollup</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>

    <span class="cm">/**</span>
<span class="cm">     * A filter to apply to result urls.  This filter will modify the default</span>
<span class="cm">     * path for all modules.  The default path for the YUI library is the</span>
<span class="cm">     * minified version of the files (e.g., event-min.js).  The filter property</span>
<span class="cm">     * can be a predefined filter or a custom filter.  The valid predefined</span>
<span class="cm">     * filters are:</span>
<span class="cm">     * &lt;dl&gt;</span>
<span class="cm">     *  &lt;dt&gt;DEBUG&lt;/dt&gt;</span>
<span class="cm">     *  &lt;dd&gt;Selects the debug versions of the library (e.g., event-debug.js).</span>
<span class="cm">     *      This option will automatically include the Logger widget&lt;/dd&gt;</span>
<span class="cm">     *  &lt;dt&gt;RAW&lt;/dt&gt;</span>
<span class="cm">     *  &lt;dd&gt;Selects the non-minified version of the library (e.g., event.js).</span>
<span class="cm">     *  &lt;/dd&gt;</span>
<span class="cm">     * &lt;/dl&gt;</span>
<span class="cm">     * You can also define a custom filter, which must be an object literal</span>
<span class="cm">     * containing a search expression and a replace string:</span>
<span class="cm">     * &lt;pre&gt;</span>
<span class="cm">     *  myFilter: &amp;#123;</span>
<span class="cm">     *      &#39;searchExp&#39;: &quot;-min\\.js&quot;,</span>
<span class="cm">     *      &#39;replaceStr&#39;: &quot;-debug.js&quot;</span>
<span class="cm">     *  &amp;#125;</span>
<span class="cm">     * &lt;/pre&gt;</span>
<span class="cm">     * @property filter</span>
<span class="cm">     * @type string| {searchExp: string, replaceStr: string}</span>
<span class="cm">     */</span>
    <span class="c1">// self.filter = null;</span>

    <span class="cm">/**</span>
<span class="cm">     * per-component filter specification.  If specified for a given</span>
<span class="cm">     * component, this overrides the filter config.</span>
<span class="cm">     * @property filters</span>
<span class="cm">     * @type object</span>
<span class="cm">     */</span>
    <span class="nx">self</span><span class="p">.</span><span class="nx">filters</span> <span class="o">=</span> <span class="p">{};</span>

    <span class="cm">/**</span>
<span class="cm">     * The list of requested modules</span>
<span class="cm">     * @property required</span>
<span class="cm">     * @type {string: boolean}</span>
<span class="cm">     */</span>
    <span class="nx">self</span><span class="p">.</span><span class="nx">required</span> <span class="o">=</span> <span class="p">{};</span>

    <span class="cm">/**</span>
<span class="cm">     * If a module name is predefined when requested, it is checked againsts</span>
<span class="cm">     * the patterns provided in this property.  If there is a match, the</span>
<span class="cm">     * module is added with the default configuration.</span>
<span class="cm">     *</span>
<span class="cm">     * At the moment only supporting module prefixes, but anticipate</span>
<span class="cm">     * supporting at least regular expressions.</span>
<span class="cm">     * @property patterns</span>
<span class="cm">     * @type Object</span>
<span class="cm">     */</span>
    <span class="c1">// self.patterns = Y.merge(Y.Env.meta.patterns);</span>
    <span class="nx">self</span><span class="p">.</span><span class="nx">patterns</span> <span class="o">=</span> <span class="p">{};</span>

    <span class="cm">/**</span>
<span class="cm">     * The library metadata</span>
<span class="cm">     * @property moduleInfo</span>
<span class="cm">     */</span>
    <span class="c1">// self.moduleInfo = Y.merge(Y.Env.meta.moduleInfo);</span>
    <span class="nx">self</span><span class="p">.</span><span class="nx">moduleInfo</span> <span class="o">=</span> <span class="p">{};</span>

    <span class="nx">self</span><span class="p">.</span><span class="nx">groups</span> <span class="o">=</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">merge</span><span class="p">(</span><span class="nx">Y</span><span class="p">.</span><span class="nx">Env</span><span class="p">.</span><span class="nx">meta</span><span class="p">.</span><span class="nx">groups</span><span class="p">);</span>

    <span class="cm">/**</span>
<span class="cm">     * Provides the information used to skin the skinnable components.</span>
<span class="cm">     * The following skin definition would result in &#39;skin1&#39; and &#39;skin2&#39;</span>
<span class="cm">     * being loaded for calendar (if calendar was requested), and</span>
<span class="cm">     * &#39;sam&#39; for all other skinnable components:</span>
<span class="cm">     *</span>
<span class="cm">     *   &lt;code&gt;</span>
<span class="cm">     *   skin: {</span>
<span class="cm">     *</span>
<span class="cm">     *      // The default skin, which is automatically applied if not</span>
<span class="cm">     *      // overriden by a component-specific skin definition.</span>
<span class="cm">     *      // Change this in to apply a different skin globally</span>
<span class="cm">     *      defaultSkin: &#39;sam&#39;,</span>
<span class="cm">     *</span>
<span class="cm">     *      // This is combined with the loader base property to get</span>
<span class="cm">     *      // the default root directory for a skin. ex:</span>
<span class="cm">     *      // http://yui.yahooapis.com/2.3.0/build/assets/skins/sam/</span>
<span class="cm">     *      base: &#39;assets/skins/&#39;,</span>
<span class="cm">     *</span>
<span class="cm">     *      // Any component-specific overrides can be specified here,</span>
<span class="cm">     *      // making it possible to load different skins for different</span>
<span class="cm">     *      // components.  It is possible to load more than one skin</span>
<span class="cm">     *      // for a given component as well.</span>
<span class="cm">     *      overrides: {</span>
<span class="cm">     *          calendar: [&#39;skin1&#39;, &#39;skin2&#39;]</span>
<span class="cm">     *      }</span>
<span class="cm">     *   }</span>
<span class="cm">     *   &lt;/code&gt;</span>
<span class="cm">     *   @property skin</span>
<span class="cm">     */</span>
    <span class="nx">self</span><span class="p">.</span><span class="nx">skin</span> <span class="o">=</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">merge</span><span class="p">(</span><span class="nx">Y</span><span class="p">.</span><span class="nx">Env</span><span class="p">.</span><span class="nx">meta</span><span class="p">.</span><span class="nx">skin</span><span class="p">);</span>

    <span class="cm">/*</span>
<span class="cm">     * Map of conditional modules</span>
<span class="cm">     * @since 3.2.0</span>
<span class="cm">     */</span>
    <span class="nx">self</span><span class="p">.</span><span class="nx">conditions</span> <span class="o">=</span> <span class="p">{};</span>

    <span class="c1">// map of modules with a hash of modules that meet the requirement</span>
    <span class="c1">// self.provides = {};</span>

    <span class="nx">self</span><span class="p">.</span><span class="nx">config</span> <span class="o">=</span> <span class="nx">o</span><span class="p">;</span>
    <span class="nx">self</span><span class="p">.</span><span class="nx">_internal</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>


    <span class="nx">cache</span> <span class="o">=</span> <span class="nx">GLOBAL_ENV</span><span class="p">.</span><span class="nx">_renderedMods</span><span class="p">;</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">cache</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">oeach</span><span class="p">(</span><span class="nx">cache</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">v</span><span class="p">,</span> <span class="nx">k</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">self</span><span class="p">.</span><span class="nx">moduleInfo</span><span class="p">[</span><span class="nx">k</span><span class="p">]</span> <span class="o">=</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">merge</span><span class="p">(</span><span class="nx">v</span><span class="p">);</span>
        <span class="p">});</span>

        <span class="nx">cache</span> <span class="o">=</span> <span class="nx">GLOBAL_ENV</span><span class="p">.</span><span class="nx">_conditions</span><span class="p">;</span>

        <span class="nx">oeach</span><span class="p">(</span><span class="nx">cache</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">v</span><span class="p">,</span> <span class="nx">k</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">self</span><span class="p">.</span><span class="nx">conditions</span><span class="p">[</span><span class="nx">k</span><span class="p">]</span> <span class="o">=</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">merge</span><span class="p">(</span><span class="nx">v</span><span class="p">);</span>
        <span class="p">});</span>

    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nx">oeach</span><span class="p">(</span><span class="nx">defaults</span><span class="p">,</span> <span class="nx">self</span><span class="p">.</span><span class="nx">addModule</span><span class="p">,</span> <span class="nx">self</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">GLOBAL_ENV</span><span class="p">.</span><span class="nx">_renderedMods</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">GLOBAL_ENV</span><span class="p">.</span><span class="nx">_renderedMods</span> <span class="o">=</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">merge</span><span class="p">(</span><span class="nx">self</span><span class="p">.</span><span class="nx">moduleInfo</span><span class="p">);</span>
        <span class="nx">GLOBAL_ENV</span><span class="p">.</span><span class="nx">_conditions</span> <span class="o">=</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">merge</span><span class="p">(</span><span class="nx">self</span><span class="p">.</span><span class="nx">conditions</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="nx">self</span><span class="p">.</span><span class="nx">_inspectPage</span><span class="p">();</span>

    <span class="nx">self</span><span class="p">.</span><span class="nx">_internal</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>

    <span class="nx">self</span><span class="p">.</span><span class="nx">_config</span><span class="p">(</span><span class="nx">o</span><span class="p">);</span>

    <span class="cm">/**</span>
<span class="cm">     * List of rollup files found in the library metadata</span>
<span class="cm">     * @property rollups</span>
<span class="cm">     */</span>
    <span class="c1">// self.rollups = null;</span>

    <span class="cm">/**</span>
<span class="cm">     * Whether or not to load optional dependencies for</span>
<span class="cm">     * the requested modules</span>
<span class="cm">     * @property loadOptional</span>
<span class="cm">     * @type boolean</span>
<span class="cm">     * @default false</span>
<span class="cm">     */</span>
    <span class="c1">// self.loadOptional = false;</span>

    <span class="cm">/**</span>
<span class="cm">     * All of the derived dependencies in sorted order, which</span>
<span class="cm">     * will be populated when either calculate() or insert()</span>
<span class="cm">     * is called</span>
<span class="cm">     * @property sorted</span>
<span class="cm">     * @type string[]</span>
<span class="cm">     */</span>
    <span class="nx">self</span><span class="p">.</span><span class="nx">sorted</span> <span class="o">=</span> <span class="p">[];</span>

    <span class="cm">/**</span>
<span class="cm">     * Set when beginning to compute the dependency tree.</span>
<span class="cm">     * Composed of what YUI reports to be loaded combined</span>
<span class="cm">     * with what has been loaded by any instance on the page</span>
<span class="cm">     * with the version number specified in the metadata.</span>
<span class="cm">     * @property loaded</span>
<span class="cm">     * @type {string: boolean}</span>
<span class="cm">     */</span>
    <span class="nx">self</span><span class="p">.</span><span class="nx">loaded</span> <span class="o">=</span> <span class="nx">GLOBAL_LOADED</span><span class="p">[</span><span class="nx">VERSION</span><span class="p">];</span>

    <span class="cm">/*</span>
<span class="cm">     * A list of modules to attach to the YUI instance when complete.</span>
<span class="cm">     * If not supplied, the sorted list of dependencies are applied.</span>
<span class="cm">     * @property attaching</span>
<span class="cm">     */</span>
    <span class="c1">// self.attaching = null;</span>

    <span class="cm">/**</span>
<span class="cm">     * Flag to indicate the dependency tree needs to be recomputed</span>
<span class="cm">     * if insert is called again.</span>
<span class="cm">     * @property dirty</span>
<span class="cm">     * @type boolean</span>
<span class="cm">     * @default true</span>
<span class="cm">     */</span>
    <span class="nx">self</span><span class="p">.</span><span class="nx">dirty</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>

    <span class="cm">/**</span>
<span class="cm">     * List of modules inserted by the utility</span>
<span class="cm">     * @property inserted</span>
<span class="cm">     * @type {string: boolean}</span>
<span class="cm">     */</span>
    <span class="nx">self</span><span class="p">.</span><span class="nx">inserted</span> <span class="o">=</span> <span class="p">{};</span>

    <span class="cm">/**</span>
<span class="cm">     * List of skipped modules during insert() because the module</span>
<span class="cm">     * was not defined</span>
<span class="cm">     * @property skipped</span>
<span class="cm">     */</span>
    <span class="nx">self</span><span class="p">.</span><span class="nx">skipped</span> <span class="o">=</span> <span class="p">{};</span>

    <span class="c1">// Y.on(&#39;yui:load&#39;, self.loadNext, self);</span>

    <span class="nx">self</span><span class="p">.</span><span class="nx">tested</span> <span class="o">=</span> <span class="p">{};</span>

    <span class="cm">/*</span>
<span class="cm">     * Cached sorted calculate results</span>
<span class="cm">     * @property results</span>
<span class="cm">     * @since 3.2.0</span>
<span class="cm">     */</span>
    <span class="c1">//self.results = {};</span>

<span class="p">};</span>

<span class="nx">Y</span><span class="p">.</span><span class="nx">Loader</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="p">{</span>

    <span class="nx">FILTER_DEFS</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">RAW</span><span class="o">:</span> <span class="p">{</span>
            <span class="s1">&#39;searchExp&#39;</span><span class="o">:</span> <span class="s1">&#39;-min\\.js&#39;</span><span class="p">,</span>
            <span class="s1">&#39;replaceStr&#39;</span><span class="o">:</span> <span class="s1">&#39;.js&#39;</span>
        <span class="p">},</span>
        <span class="nx">DEBUG</span><span class="o">:</span> <span class="p">{</span>
            <span class="s1">&#39;searchExp&#39;</span><span class="o">:</span> <span class="s1">&#39;-min\\.js&#39;</span><span class="p">,</span>
            <span class="s1">&#39;replaceStr&#39;</span><span class="o">:</span> <span class="s1">&#39;-debug.js&#39;</span>
        <span class="p">}</span>
    <span class="p">},</span>

   <span class="nx">_inspectPage</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
       <span class="nx">oeach</span><span class="p">(</span><span class="nx">ON_PAGE</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">v</span><span class="p">,</span> <span class="nx">k</span><span class="p">)</span> <span class="p">{</span>
           <span class="k">if</span> <span class="p">(</span><span class="nx">v</span><span class="p">.</span><span class="nx">details</span><span class="p">)</span> <span class="p">{</span>
               <span class="kd">var</span> <span class="nx">m</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">moduleInfo</span><span class="p">[</span><span class="nx">k</span><span class="p">],</span>
                   <span class="nx">req</span> <span class="o">=</span> <span class="nx">v</span><span class="p">.</span><span class="nx">details</span><span class="p">.</span><span class="nx">requires</span><span class="p">,</span>
                   <span class="nx">mr</span> <span class="o">=</span> <span class="nx">m</span> <span class="o">&amp;&amp;</span> <span class="nx">m</span><span class="p">.</span><span class="nx">requires</span><span class="p">;</span>
               <span class="k">if</span> <span class="p">(</span><span class="nx">m</span><span class="p">)</span> <span class="p">{</span>
                   <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">m</span><span class="p">.</span><span class="nx">_inspected</span> <span class="o">&amp;&amp;</span> <span class="nx">req</span> <span class="o">&amp;&amp;</span> <span class="nx">mr</span><span class="p">.</span><span class="nx">length</span> <span class="o">!=</span> <span class="nx">req</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
                       <span class="c1">// console.log(&#39;deleting &#39; + m.name);</span>
                       <span class="k">delete</span> <span class="nx">m</span><span class="p">.</span><span class="nx">expanded</span><span class="p">;</span>
                   <span class="p">}</span>
               <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                   <span class="nx">m</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">addModule</span><span class="p">(</span><span class="nx">v</span><span class="p">.</span><span class="nx">details</span><span class="p">,</span> <span class="nx">k</span><span class="p">);</span>
               <span class="p">}</span>
               <span class="nx">m</span><span class="p">.</span><span class="nx">_inspected</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
           <span class="p">}</span>
       <span class="p">},</span> <span class="k">this</span><span class="p">);</span>
   <span class="p">},</span>

<span class="c1">// returns true if b is not loaded, and is required</span>
<span class="c1">// directly or by means of modules it supersedes.</span>
   <span class="nx">_requires</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">mod1</span><span class="p">,</span> <span class="nx">mod2</span><span class="p">)</span> <span class="p">{</span>

        <span class="kd">var</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">rm</span><span class="p">,</span> <span class="nx">after_map</span><span class="p">,</span> <span class="nx">s</span><span class="p">,</span>
            <span class="nx">info</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">moduleInfo</span><span class="p">,</span>
            <span class="nx">m</span> <span class="o">=</span> <span class="nx">info</span><span class="p">[</span><span class="nx">mod1</span><span class="p">],</span>
            <span class="nx">other</span> <span class="o">=</span> <span class="nx">info</span><span class="p">[</span><span class="nx">mod2</span><span class="p">];</span>
            <span class="c1">// key = mod1 + mod2;</span>

        <span class="c1">// if (this.tested[key]) {</span>
            <span class="c1">// return this.tested[key];</span>
        <span class="c1">// }</span>

        <span class="c1">// if (loaded[mod2] || !m || !other) {</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">m</span> <span class="o">||</span> <span class="o">!</span><span class="nx">other</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="nx">rm</span> <span class="o">=</span> <span class="nx">m</span><span class="p">.</span><span class="nx">expanded_map</span><span class="p">;</span>
        <span class="nx">after_map</span> <span class="o">=</span> <span class="nx">m</span><span class="p">.</span><span class="nx">after_map</span><span class="p">;</span>

        <span class="c1">// check if this module should be sorted after the other</span>
        <span class="c1">// do this first to short circut circular deps</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">after_map</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nx">mod2</span> <span class="k">in</span> <span class="nx">after_map</span><span class="p">))</span> <span class="p">{</span>
            <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="nx">after_map</span> <span class="o">=</span> <span class="nx">other</span><span class="p">.</span><span class="nx">after_map</span><span class="p">;</span>

        <span class="c1">// and vis-versa</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">after_map</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nx">mod1</span> <span class="k">in</span> <span class="nx">after_map</span><span class="p">))</span> <span class="p">{</span>
            <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="c1">// check if this module requires one the other supersedes</span>
        <span class="nx">s</span> <span class="o">=</span> <span class="nx">info</span><span class="p">[</span><span class="nx">mod2</span><span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="nx">info</span><span class="p">[</span><span class="nx">mod2</span><span class="p">].</span><span class="nx">supersedes</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">s</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">s</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_requires</span><span class="p">(</span><span class="nx">mod1</span><span class="p">,</span> <span class="nx">s</span><span class="p">[</span><span class="nx">i</span><span class="p">]))</span> <span class="p">{</span>
                    <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="nx">s</span> <span class="o">=</span> <span class="nx">info</span><span class="p">[</span><span class="nx">mod1</span><span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="nx">info</span><span class="p">[</span><span class="nx">mod1</span><span class="p">].</span><span class="nx">supersedes</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">s</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">s</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_requires</span><span class="p">(</span><span class="nx">mod2</span><span class="p">,</span> <span class="nx">s</span><span class="p">[</span><span class="nx">i</span><span class="p">]))</span> <span class="p">{</span>
                    <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="c1">// check if this module requires the other directly</span>
        <span class="c1">// if (r &amp;&amp; YArray.indexOf(r, mod2) &gt; -1) {</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">rm</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nx">mod2</span> <span class="k">in</span> <span class="nx">rm</span><span class="p">))</span> <span class="p">{</span>
            <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="c1">// external css files should be sorted below yui css</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">m</span><span class="p">.</span><span class="nx">ext</span> <span class="o">&amp;&amp;</span> <span class="nx">m</span><span class="p">.</span><span class="nx">type</span> <span class="o">==</span> <span class="nx">CSS</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">other</span><span class="p">.</span><span class="nx">ext</span> <span class="o">&amp;&amp;</span> <span class="nx">other</span><span class="p">.</span><span class="nx">type</span> <span class="o">==</span> <span class="nx">CSS</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
    <span class="p">},</span>

    <span class="nx">_config</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">o</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">j</span><span class="p">,</span> <span class="nx">val</span><span class="p">,</span> <span class="nx">f</span><span class="p">,</span> <span class="nx">group</span><span class="p">,</span> <span class="nx">groupName</span><span class="p">,</span> <span class="nx">self</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
        <span class="c1">// apply config values</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">o</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="k">in</span> <span class="nx">o</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">o</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">(</span><span class="nx">i</span><span class="p">))</span> <span class="p">{</span>
                    <span class="nx">val</span> <span class="o">=</span> <span class="nx">o</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
                    <span class="k">if</span> <span class="p">(</span><span class="nx">i</span> <span class="o">==</span> <span class="s1">&#39;require&#39;</span><span class="p">)</span> <span class="p">{</span>
                        <span class="nx">self</span><span class="p">.</span><span class="nx">require</span><span class="p">(</span><span class="nx">val</span><span class="p">);</span>
                    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">i</span> <span class="o">==</span> <span class="s1">&#39;skin&#39;</span><span class="p">)</span> <span class="p">{</span>
                        <span class="nx">Y</span><span class="p">.</span><span class="nx">mix</span><span class="p">(</span><span class="nx">self</span><span class="p">.</span><span class="nx">skin</span><span class="p">,</span> <span class="nx">o</span><span class="p">[</span><span class="nx">i</span><span class="p">],</span> <span class="kc">true</span><span class="p">);</span>
                    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">i</span> <span class="o">==</span> <span class="s1">&#39;groups&#39;</span><span class="p">)</span> <span class="p">{</span>
                        <span class="k">for</span> <span class="p">(</span><span class="nx">j</span> <span class="k">in</span> <span class="nx">val</span><span class="p">)</span> <span class="p">{</span>
                            <span class="k">if</span> <span class="p">(</span><span class="nx">val</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">(</span><span class="nx">j</span><span class="p">))</span> <span class="p">{</span>
                                <span class="c1">// Y.log(&#39;group: &#39; + j);</span>
                                <span class="nx">groupName</span> <span class="o">=</span> <span class="nx">j</span><span class="p">;</span>
                                <span class="nx">group</span> <span class="o">=</span> <span class="nx">val</span><span class="p">[</span><span class="nx">j</span><span class="p">];</span>
                                <span class="nx">self</span><span class="p">.</span><span class="nx">addGroup</span><span class="p">(</span><span class="nx">group</span><span class="p">,</span> <span class="nx">groupName</span><span class="p">);</span>
                            <span class="p">}</span>
                        <span class="p">}</span>

                    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">i</span> <span class="o">==</span> <span class="s1">&#39;modules&#39;</span><span class="p">)</span> <span class="p">{</span>
                        <span class="c1">// add a hash of module definitions</span>
                        <span class="nx">oeach</span><span class="p">(</span><span class="nx">val</span><span class="p">,</span> <span class="nx">self</span><span class="p">.</span><span class="nx">addModule</span><span class="p">,</span> <span class="nx">self</span><span class="p">);</span>
                    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">i</span> <span class="o">==</span> <span class="s1">&#39;gallery&#39;</span><span class="p">)</span> <span class="p">{</span>
                        <span class="k">this</span><span class="p">.</span><span class="nx">groups</span><span class="p">.</span><span class="nx">gallery</span><span class="p">.</span><span class="nx">update</span><span class="p">(</span><span class="nx">val</span><span class="p">);</span>
                    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">i</span> <span class="o">==</span> <span class="s1">&#39;yui2&#39;</span> <span class="o">||</span> <span class="nx">i</span> <span class="o">==</span> <span class="s1">&#39;2in3&#39;</span><span class="p">)</span> <span class="p">{</span>
                        <span class="k">this</span><span class="p">.</span><span class="nx">groups</span><span class="p">.</span><span class="nx">yui2</span><span class="p">.</span><span class="nx">update</span><span class="p">(</span><span class="nx">o</span><span class="p">[</span><span class="s1">&#39;2in3&#39;</span><span class="p">],</span> <span class="nx">o</span><span class="p">.</span><span class="nx">yui2</span><span class="p">);</span>
                    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">i</span> <span class="o">==</span> <span class="s1">&#39;maxURLLength&#39;</span><span class="p">)</span> <span class="p">{</span>
                        <span class="nx">self</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">min</span><span class="p">(</span><span class="nx">MAX_URL_LENGTH</span><span class="p">,</span> <span class="nx">val</span><span class="p">);</span>
                    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                        <span class="nx">self</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="nx">val</span><span class="p">;</span>
                    <span class="p">}</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="c1">// fix filter</span>
        <span class="nx">f</span> <span class="o">=</span> <span class="nx">self</span><span class="p">.</span><span class="nx">filter</span><span class="p">;</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">L</span><span class="p">.</span><span class="nx">isString</span><span class="p">(</span><span class="nx">f</span><span class="p">))</span> <span class="p">{</span>
            <span class="nx">f</span> <span class="o">=</span> <span class="nx">f</span><span class="p">.</span><span class="nx">toUpperCase</span><span class="p">();</span>
            <span class="nx">self</span><span class="p">.</span><span class="nx">filterName</span> <span class="o">=</span> <span class="nx">f</span><span class="p">;</span>
            <span class="nx">self</span><span class="p">.</span><span class="nx">filter</span> <span class="o">=</span> <span class="nx">self</span><span class="p">.</span><span class="nx">FILTER_DEFS</span><span class="p">[</span><span class="nx">f</span><span class="p">];</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">f</span> <span class="o">==</span> <span class="s1">&#39;DEBUG&#39;</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">self</span><span class="p">.</span><span class="nx">require</span><span class="p">(</span><span class="s1">&#39;yui-log&#39;</span><span class="p">,</span> <span class="s1">&#39;dump&#39;</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>

    <span class="p">},</span>

    <span class="cm">/**</span>
<span class="cm">     * Returns the skin module name for the specified skin name.  If a</span>
<span class="cm">     * module name is supplied, the returned skin module name is</span>
<span class="cm">     * specific to the module passed in.</span>
<span class="cm">     * @method formatSkin</span>
<span class="cm">     * @param {string} skin the name of the skin.</span>
<span class="cm">     * @param {string} mod optional: the name of a module to skin.</span>
<span class="cm">     * @return {string} the full skin module name.</span>
<span class="cm">     */</span>
    <span class="nx">formatSkin</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">skin</span><span class="p">,</span> <span class="nx">mod</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">s</span> <span class="o">=</span> <span class="nx">SKIN_PREFIX</span> <span class="o">+</span> <span class="nx">skin</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">mod</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">s</span> <span class="o">=</span> <span class="nx">s</span> <span class="o">+</span> <span class="s1">&#39;-&#39;</span> <span class="o">+</span> <span class="nx">mod</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="nx">s</span><span class="p">;</span>
    <span class="p">},</span>

    <span class="cm">/**</span>
<span class="cm">     * Adds the skin def to the module info</span>
<span class="cm">     * @method _addSkin</span>
<span class="cm">     * @param {string} skin the name of the skin.</span>
<span class="cm">     * @param {string} mod the name of the module.</span>
<span class="cm">     * @param {string} parent parent module if this is a skin of a</span>
<span class="cm">     * submodule or plugin.</span>
<span class="cm">     * @return {string} the module name for the skin.</span>
<span class="cm">     * @private</span>
<span class="cm">     */</span>
    <span class="nx">_addSkin</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">skin</span><span class="p">,</span> <span class="nx">mod</span><span class="p">,</span> <span class="nx">parent</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">mdef</span><span class="p">,</span> <span class="nx">pkg</span><span class="p">,</span> <span class="nx">name</span><span class="p">,</span>
            <span class="nx">info</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">moduleInfo</span><span class="p">,</span>
            <span class="nx">sinf</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">skin</span><span class="p">,</span>
            <span class="nx">ext</span> <span class="o">=</span> <span class="nx">info</span><span class="p">[</span><span class="nx">mod</span><span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="nx">info</span><span class="p">[</span><span class="nx">mod</span><span class="p">].</span><span class="nx">ext</span><span class="p">;</span>

        <span class="c1">// Add a module definition for the module-specific skin css</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">mod</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">name</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">formatSkin</span><span class="p">(</span><span class="nx">skin</span><span class="p">,</span> <span class="nx">mod</span><span class="p">);</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">info</span><span class="p">[</span><span class="nx">name</span><span class="p">])</span> <span class="p">{</span>
                <span class="nx">mdef</span> <span class="o">=</span> <span class="nx">info</span><span class="p">[</span><span class="nx">mod</span><span class="p">];</span>
                <span class="nx">pkg</span> <span class="o">=</span> <span class="nx">mdef</span><span class="p">.</span><span class="nx">pkg</span> <span class="o">||</span> <span class="nx">mod</span><span class="p">;</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">addModule</span><span class="p">({</span>
                    <span class="nx">name</span><span class="o">:</span> <span class="nx">name</span><span class="p">,</span>
                    <span class="nx">group</span><span class="o">:</span> <span class="nx">mdef</span><span class="p">.</span><span class="nx">group</span><span class="p">,</span>
                    <span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;css&#39;</span><span class="p">,</span>
                    <span class="nx">after</span><span class="o">:</span> <span class="nx">sinf</span><span class="p">.</span><span class="nx">after</span><span class="p">,</span>
                    <span class="nx">path</span><span class="o">:</span> <span class="p">(</span><span class="nx">parent</span> <span class="o">||</span> <span class="nx">pkg</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span> <span class="o">+</span> <span class="nx">sinf</span><span class="p">.</span><span class="nx">base</span> <span class="o">+</span> <span class="nx">skin</span> <span class="o">+</span>
                          <span class="s1">&#39;/&#39;</span> <span class="o">+</span> <span class="nx">mod</span> <span class="o">+</span> <span class="s1">&#39;.css&#39;</span><span class="p">,</span>
                    <span class="nx">ext</span><span class="o">:</span> <span class="nx">ext</span>
                <span class="p">});</span>

                <span class="c1">// Y.log(&#39;adding skin &#39; + name + &#39;, &#39;</span>
                <span class="c1">// + parent + &#39;, &#39; + pkg + &#39;, &#39; + info[name].path);</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="nx">name</span><span class="p">;</span>
    <span class="p">},</span>

    <span class="cm">/** Add a new module group</span>
<span class="cm">     * &lt;dl&gt;</span>
<span class="cm">     *   &lt;dt&gt;name:&lt;/dt&gt;      &lt;dd&gt;required, the group name&lt;/dd&gt;</span>
<span class="cm">     *   &lt;dt&gt;base:&lt;/dt&gt;      &lt;dd&gt;The base dir for this module group&lt;/dd&gt;</span>
<span class="cm">     *   &lt;dt&gt;root:&lt;/dt&gt;      &lt;dd&gt;The root path to add to each combo</span>
<span class="cm">     *   resource path&lt;/dd&gt;</span>
<span class="cm">     *   &lt;dt&gt;combine:&lt;/dt&gt;   &lt;dd&gt;combo handle&lt;/dd&gt;</span>
<span class="cm">     *   &lt;dt&gt;comboBase:&lt;/dt&gt; &lt;dd&gt;combo service base path&lt;/dd&gt;</span>
<span class="cm">     *   &lt;dt&gt;modules:&lt;/dt&gt;   &lt;dd&gt;the group of modules&lt;/dd&gt;</span>
<span class="cm">     * &lt;/dl&gt;</span>
<span class="cm">     * @method addGroup</span>
<span class="cm">     * @param {object} o An object containing the module data.</span>
<span class="cm">     * @param {string} name the group name.</span>
<span class="cm">     */</span>
    <span class="nx">addGroup</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">o</span><span class="p">,</span> <span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">mods</span> <span class="o">=</span> <span class="nx">o</span><span class="p">.</span><span class="nx">modules</span><span class="p">,</span>
            <span class="nx">self</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
        <span class="nx">name</span> <span class="o">=</span> <span class="nx">name</span> <span class="o">||</span> <span class="nx">o</span><span class="p">.</span><span class="nx">name</span><span class="p">;</span>
        <span class="nx">o</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="nx">name</span><span class="p">;</span>
        <span class="nx">self</span><span class="p">.</span><span class="nx">groups</span><span class="p">[</span><span class="nx">name</span><span class="p">]</span> <span class="o">=</span> <span class="nx">o</span><span class="p">;</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">o</span><span class="p">.</span><span class="nx">patterns</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">oeach</span><span class="p">(</span><span class="nx">o</span><span class="p">.</span><span class="nx">patterns</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">v</span><span class="p">,</span> <span class="nx">k</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">v</span><span class="p">.</span><span class="nx">group</span> <span class="o">=</span> <span class="nx">name</span><span class="p">;</span>
                <span class="nx">self</span><span class="p">.</span><span class="nx">patterns</span><span class="p">[</span><span class="nx">k</span><span class="p">]</span> <span class="o">=</span> <span class="nx">v</span><span class="p">;</span>
            <span class="p">});</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">mods</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">oeach</span><span class="p">(</span><span class="nx">mods</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">v</span><span class="p">,</span> <span class="nx">k</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">v</span><span class="p">.</span><span class="nx">group</span> <span class="o">=</span> <span class="nx">name</span><span class="p">;</span>
                <span class="nx">self</span><span class="p">.</span><span class="nx">addModule</span><span class="p">(</span><span class="nx">v</span><span class="p">,</span> <span class="nx">k</span><span class="p">);</span>
            <span class="p">},</span> <span class="nx">self</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">},</span>

    <span class="cm">/** Add a new module to the component metadata.</span>
<span class="cm">     * &lt;dl&gt;</span>
<span class="cm">     *     &lt;dt&gt;name:&lt;/dt&gt;       &lt;dd&gt;required, the component name&lt;/dd&gt;</span>
<span class="cm">     *     &lt;dt&gt;type:&lt;/dt&gt;       &lt;dd&gt;required, the component type (js or css)</span>
<span class="cm">     *     &lt;/dd&gt;</span>
<span class="cm">     *     &lt;dt&gt;path:&lt;/dt&gt;       &lt;dd&gt;required, the path to the script from</span>
<span class="cm">     *     &quot;base&quot;&lt;/dd&gt;</span>
<span class="cm">     *     &lt;dt&gt;requires:&lt;/dt&gt;   &lt;dd&gt;array of modules required by this</span>
<span class="cm">     *     component&lt;/dd&gt;</span>
<span class="cm">     *     &lt;dt&gt;optional:&lt;/dt&gt;   &lt;dd&gt;array of optional modules for this</span>
<span class="cm">     *     component&lt;/dd&gt;</span>
<span class="cm">     *     &lt;dt&gt;supersedes:&lt;/dt&gt; &lt;dd&gt;array of the modules this component</span>
<span class="cm">     *     replaces&lt;/dd&gt;</span>
<span class="cm">     *     &lt;dt&gt;after:&lt;/dt&gt;      &lt;dd&gt;array of modules the components which, if</span>
<span class="cm">     *     present, should be sorted above this one&lt;/dd&gt;</span>
<span class="cm">     *     &lt;dt&gt;after_map:&lt;/dt&gt;  &lt;dd&gt;faster alternative to &#39;after&#39; -- supply</span>
<span class="cm">     *     a hash instead of an array&lt;/dd&gt;</span>
<span class="cm">     *     &lt;dt&gt;rollup:&lt;/dt&gt;     &lt;dd&gt;the number of superseded modules required</span>
<span class="cm">     *     for automatic rollup&lt;/dd&gt;</span>
<span class="cm">     *     &lt;dt&gt;fullpath:&lt;/dt&gt;   &lt;dd&gt;If fullpath is specified, this is used</span>
<span class="cm">     *     instead of the configured base + path&lt;/dd&gt;</span>
<span class="cm">     *     &lt;dt&gt;skinnable:&lt;/dt&gt;  &lt;dd&gt;flag to determine if skin assets should</span>
<span class="cm">     *     automatically be pulled in&lt;/dd&gt;</span>
<span class="cm">     *     &lt;dt&gt;submodules:&lt;/dt&gt; &lt;dd&gt;a hash of submodules&lt;/dd&gt;</span>
<span class="cm">     *     &lt;dt&gt;group:&lt;/dt&gt;      &lt;dd&gt;The group the module belongs to -- this</span>
<span class="cm">     *     is set automatically when it is added as part of a group</span>
<span class="cm">     *     configuration.&lt;/dd&gt;</span>
<span class="cm">     *     &lt;dt&gt;lang:&lt;/dt&gt;</span>
<span class="cm">     *       &lt;dd&gt;array of BCP 47 language tags of languages for which this</span>
<span class="cm">     *           module has localized resource bundles,</span>
<span class="cm">     *           e.g., [&quot;en-GB&quot;,&quot;zh-Hans-CN&quot;]&lt;/dd&gt;</span>
<span class="cm">     *     &lt;dt&gt;condition:&lt;/dt&gt;</span>
<span class="cm">     *       &lt;dd&gt;Specifies that the module should be loaded automatically if</span>
<span class="cm">     *           a condition is met.  This is an object with up to three fields:</span>
<span class="cm">     *           [trigger] - the name of a module that can trigger the auto-load</span>
<span class="cm">     *           [test] - a function that returns true when the module is to be</span>
<span class="cm">     *           loaded.</span>
<span class="cm">     *           [when] - specifies the load order of the conditional module</span>
<span class="cm">     *           with regard to the position of the trigger module.</span>
<span class="cm">     *           This should be one of three values: &#39;before&#39;, &#39;after&#39;, or</span>
<span class="cm">     *           &#39;instead&#39;.  The default is &#39;after&#39;.</span>
<span class="cm">     *       &lt;/dd&gt;</span>
<span class="cm">     * &lt;/dl&gt;</span>
<span class="cm">     * @method addModule</span>
<span class="cm">     * @param {object} o An object containing the module data.</span>
<span class="cm">     * @param {string} name the module name (optional), required if not</span>
<span class="cm">     * in the module data.</span>
<span class="cm">     * @return {object} the module definition or null if</span>
<span class="cm">     * the object passed in did not provide all required attributes.</span>
<span class="cm">     */</span>
    <span class="nx">addModule</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">o</span><span class="p">,</span> <span class="nx">name</span><span class="p">)</span> <span class="p">{</span>

        <span class="nx">name</span> <span class="o">=</span> <span class="nx">name</span> <span class="o">||</span> <span class="nx">o</span><span class="p">.</span><span class="nx">name</span><span class="p">;</span>
        <span class="nx">o</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="nx">name</span><span class="p">;</span>

        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">o</span> <span class="o">||</span> <span class="o">!</span><span class="nx">o</span><span class="p">.</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">o</span><span class="p">.</span><span class="nx">type</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">o</span><span class="p">.</span><span class="nx">type</span> <span class="o">=</span> <span class="nx">JS</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">o</span><span class="p">.</span><span class="nx">path</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">o</span><span class="p">.</span><span class="nx">fullpath</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">o</span><span class="p">.</span><span class="nx">path</span> <span class="o">=</span> <span class="nx">_path</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="nx">name</span><span class="p">,</span> <span class="nx">o</span><span class="p">.</span><span class="nx">type</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="nx">o</span><span class="p">.</span><span class="nx">supersedes</span> <span class="o">=</span> <span class="nx">o</span><span class="p">.</span><span class="nx">supersedes</span> <span class="o">||</span> <span class="nx">o</span><span class="p">.</span><span class="nx">use</span><span class="p">;</span>

        <span class="nx">o</span><span class="p">.</span><span class="nx">ext</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;ext&#39;</span> <span class="k">in</span> <span class="nx">o</span><span class="p">)</span> <span class="o">?</span> <span class="nx">o</span><span class="p">.</span><span class="nx">ext</span> <span class="o">:</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_internal</span><span class="p">)</span> <span class="o">?</span> <span class="kc">false</span> <span class="o">:</span> <span class="kc">true</span><span class="p">;</span>
        <span class="nx">o</span><span class="p">.</span><span class="nx">requires</span> <span class="o">=</span> <span class="nx">o</span><span class="p">.</span><span class="nx">requires</span> <span class="o">||</span> <span class="p">[];</span>

        <span class="c1">// Handle submodule logic</span>
        <span class="kd">var</span> <span class="nx">subs</span> <span class="o">=</span> <span class="nx">o</span><span class="p">.</span><span class="nx">submodules</span><span class="p">,</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">l</span><span class="p">,</span> <span class="nx">sup</span><span class="p">,</span> <span class="nx">s</span><span class="p">,</span> <span class="nx">smod</span><span class="p">,</span> <span class="nx">plugins</span><span class="p">,</span> <span class="nx">plug</span><span class="p">,</span>
            <span class="nx">j</span><span class="p">,</span> <span class="nx">langs</span><span class="p">,</span> <span class="nx">packName</span><span class="p">,</span> <span class="nx">supName</span><span class="p">,</span> <span class="nx">flatSup</span><span class="p">,</span> <span class="nx">flatLang</span><span class="p">,</span> <span class="nx">lang</span><span class="p">,</span> <span class="nx">ret</span><span class="p">,</span>
            <span class="nx">overrides</span><span class="p">,</span> <span class="nx">skinname</span><span class="p">,</span> <span class="nx">when</span><span class="p">,</span>
            <span class="nx">conditions</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">conditions</span><span class="p">,</span> <span class="nx">trigger</span><span class="p">;</span>
            <span class="c1">// , existing = this.moduleInfo[name], newr;</span>

        <span class="k">this</span><span class="p">.</span><span class="nx">moduleInfo</span><span class="p">[</span><span class="nx">name</span><span class="p">]</span> <span class="o">=</span> <span class="nx">o</span><span class="p">;</span>

        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">o</span><span class="p">.</span><span class="nx">langPack</span> <span class="o">&amp;&amp;</span> <span class="nx">o</span><span class="p">.</span><span class="nx">lang</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">langs</span> <span class="o">=</span> <span class="nx">YArray</span><span class="p">(</span><span class="nx">o</span><span class="p">.</span><span class="nx">lang</span><span class="p">);</span>
            <span class="k">for</span> <span class="p">(</span><span class="nx">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">j</span> <span class="o">&lt;</span> <span class="nx">langs</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">lang</span> <span class="o">=</span> <span class="nx">langs</span><span class="p">[</span><span class="nx">j</span><span class="p">];</span>
                <span class="nx">packName</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">getLangPackName</span><span class="p">(</span><span class="nx">lang</span><span class="p">,</span> <span class="nx">name</span><span class="p">);</span>
                <span class="nx">smod</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">moduleInfo</span><span class="p">[</span><span class="nx">packName</span><span class="p">];</span>
                <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">smod</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">smod</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_addLangPack</span><span class="p">(</span><span class="nx">lang</span><span class="p">,</span> <span class="nx">o</span><span class="p">,</span> <span class="nx">packName</span><span class="p">);</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">subs</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">sup</span> <span class="o">=</span> <span class="nx">o</span><span class="p">.</span><span class="nx">supersedes</span> <span class="o">||</span> <span class="p">[];</span>
            <span class="nx">l</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

            <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="k">in</span> <span class="nx">subs</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">subs</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">(</span><span class="nx">i</span><span class="p">))</span> <span class="p">{</span>
                    <span class="nx">s</span> <span class="o">=</span> <span class="nx">subs</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>

                    <span class="nx">s</span><span class="p">.</span><span class="nx">path</span> <span class="o">=</span> <span class="nx">s</span><span class="p">.</span><span class="nx">path</span> <span class="o">||</span> <span class="nx">_path</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">o</span><span class="p">.</span><span class="nx">type</span><span class="p">);</span>
                    <span class="nx">s</span><span class="p">.</span><span class="nx">pkg</span> <span class="o">=</span> <span class="nx">name</span><span class="p">;</span>
                    <span class="nx">s</span><span class="p">.</span><span class="nx">group</span> <span class="o">=</span> <span class="nx">o</span><span class="p">.</span><span class="nx">group</span><span class="p">;</span>

                    <span class="k">if</span> <span class="p">(</span><span class="nx">s</span><span class="p">.</span><span class="nx">supersedes</span><span class="p">)</span> <span class="p">{</span>
                        <span class="nx">sup</span> <span class="o">=</span> <span class="nx">sup</span><span class="p">.</span><span class="nx">concat</span><span class="p">(</span><span class="nx">s</span><span class="p">.</span><span class="nx">supersedes</span><span class="p">);</span>
                    <span class="p">}</span>

                    <span class="nx">smod</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">addModule</span><span class="p">(</span><span class="nx">s</span><span class="p">,</span> <span class="nx">i</span><span class="p">);</span>
                    <span class="nx">sup</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">i</span><span class="p">);</span>

                    <span class="k">if</span> <span class="p">(</span><span class="nx">smod</span><span class="p">.</span><span class="nx">skinnable</span><span class="p">)</span> <span class="p">{</span>
                        <span class="nx">o</span><span class="p">.</span><span class="nx">skinnable</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
                        <span class="nx">overrides</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">skin</span><span class="p">.</span><span class="nx">overrides</span><span class="p">;</span>
                        <span class="k">if</span> <span class="p">(</span><span class="nx">overrides</span> <span class="o">&amp;&amp;</span> <span class="nx">overrides</span><span class="p">[</span><span class="nx">i</span><span class="p">])</span> <span class="p">{</span>
                            <span class="k">for</span> <span class="p">(</span><span class="nx">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">j</span> <span class="o">&lt;</span> <span class="nx">overrides</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">length</span><span class="p">;</span> <span class="nx">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
                                <span class="nx">skinname</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_addSkin</span><span class="p">(</span><span class="nx">overrides</span><span class="p">[</span><span class="nx">i</span><span class="p">][</span><span class="nx">j</span><span class="p">],</span>
                                         <span class="nx">i</span><span class="p">,</span> <span class="nx">name</span><span class="p">);</span>
                                <span class="nx">sup</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">skinname</span><span class="p">);</span>
                            <span class="p">}</span>
                        <span class="p">}</span>
                        <span class="nx">skinname</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_addSkin</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">skin</span><span class="p">.</span><span class="nx">defaultSkin</span><span class="p">,</span>
                                        <span class="nx">i</span><span class="p">,</span> <span class="nx">name</span><span class="p">);</span>
                        <span class="nx">sup</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">skinname</span><span class="p">);</span>
                    <span class="p">}</span>

                    <span class="c1">// looks like we are expected to work out the metadata</span>
                    <span class="c1">// for the parent module language packs from what is</span>
                    <span class="c1">// specified in the child modules.</span>
                    <span class="k">if</span> <span class="p">(</span><span class="nx">s</span><span class="p">.</span><span class="nx">lang</span> <span class="o">&amp;&amp;</span> <span class="nx">s</span><span class="p">.</span><span class="nx">lang</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>

                        <span class="nx">langs</span> <span class="o">=</span> <span class="nx">YArray</span><span class="p">(</span><span class="nx">s</span><span class="p">.</span><span class="nx">lang</span><span class="p">);</span>
                        <span class="k">for</span> <span class="p">(</span><span class="nx">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">j</span> <span class="o">&lt;</span> <span class="nx">langs</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
                            <span class="nx">lang</span> <span class="o">=</span> <span class="nx">langs</span><span class="p">[</span><span class="nx">j</span><span class="p">];</span>
                            <span class="nx">packName</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">getLangPackName</span><span class="p">(</span><span class="nx">lang</span><span class="p">,</span> <span class="nx">name</span><span class="p">);</span>
                            <span class="nx">supName</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">getLangPackName</span><span class="p">(</span><span class="nx">lang</span><span class="p">,</span> <span class="nx">i</span><span class="p">);</span>
                            <span class="nx">smod</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">moduleInfo</span><span class="p">[</span><span class="nx">packName</span><span class="p">];</span>

                            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">smod</span><span class="p">)</span> <span class="p">{</span>
                                <span class="nx">smod</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_addLangPack</span><span class="p">(</span><span class="nx">lang</span><span class="p">,</span> <span class="nx">o</span><span class="p">,</span> <span class="nx">packName</span><span class="p">);</span>
                            <span class="p">}</span>

                            <span class="nx">flatSup</span> <span class="o">=</span> <span class="nx">flatSup</span> <span class="o">||</span> <span class="nx">YArray</span><span class="p">.</span><span class="nx">hash</span><span class="p">(</span><span class="nx">smod</span><span class="p">.</span><span class="nx">supersedes</span><span class="p">);</span>

                            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="nx">supName</span> <span class="k">in</span> <span class="nx">flatSup</span><span class="p">))</span> <span class="p">{</span>
                                <span class="nx">smod</span><span class="p">.</span><span class="nx">supersedes</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">supName</span><span class="p">);</span>
                            <span class="p">}</span>

                            <span class="nx">o</span><span class="p">.</span><span class="nx">lang</span> <span class="o">=</span> <span class="nx">o</span><span class="p">.</span><span class="nx">lang</span> <span class="o">||</span> <span class="p">[];</span>

                            <span class="nx">flatLang</span> <span class="o">=</span> <span class="nx">flatLang</span> <span class="o">||</span> <span class="nx">YArray</span><span class="p">.</span><span class="nx">hash</span><span class="p">(</span><span class="nx">o</span><span class="p">.</span><span class="nx">lang</span><span class="p">);</span>

                            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="nx">lang</span> <span class="k">in</span> <span class="nx">flatLang</span><span class="p">))</span> <span class="p">{</span>
                                <span class="nx">o</span><span class="p">.</span><span class="nx">lang</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">lang</span><span class="p">);</span>
                            <span class="p">}</span>

<span class="c1">// Y.log(&#39;pack &#39; + packName + &#39; should supersede &#39; + supName);</span>
<span class="c1">// Add rollup file, need to add to supersedes list too</span>

                            <span class="c1">// default packages</span>
                            <span class="nx">packName</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">getLangPackName</span><span class="p">(</span><span class="nx">ROOT_LANG</span><span class="p">,</span> <span class="nx">name</span><span class="p">);</span>
                            <span class="nx">supName</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">getLangPackName</span><span class="p">(</span><span class="nx">ROOT_LANG</span><span class="p">,</span> <span class="nx">i</span><span class="p">);</span>

                            <span class="nx">smod</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">moduleInfo</span><span class="p">[</span><span class="nx">packName</span><span class="p">];</span>

                            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">smod</span><span class="p">)</span> <span class="p">{</span>
                                <span class="nx">smod</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_addLangPack</span><span class="p">(</span><span class="nx">lang</span><span class="p">,</span> <span class="nx">o</span><span class="p">,</span> <span class="nx">packName</span><span class="p">);</span>
                            <span class="p">}</span>

                            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="nx">supName</span> <span class="k">in</span> <span class="nx">flatSup</span><span class="p">))</span> <span class="p">{</span>
                                <span class="nx">smod</span><span class="p">.</span><span class="nx">supersedes</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">supName</span><span class="p">);</span>
                            <span class="p">}</span>

<span class="c1">// Y.log(&#39;pack &#39; + packName + &#39; should supersede &#39; + supName);</span>
<span class="c1">// Add rollup file, need to add to supersedes list too</span>

                        <span class="p">}</span>
                    <span class="p">}</span>

                    <span class="nx">l</span><span class="o">++</span><span class="p">;</span>
                <span class="p">}</span>
            <span class="p">}</span>
            <span class="nx">o</span><span class="p">.</span><span class="nx">supersedes</span> <span class="o">=</span> <span class="nx">YObject</span><span class="p">.</span><span class="nx">keys</span><span class="p">(</span><span class="nx">YArray</span><span class="p">.</span><span class="nx">hash</span><span class="p">(</span><span class="nx">sup</span><span class="p">));</span>
            <span class="nx">o</span><span class="p">.</span><span class="nx">rollup</span> <span class="o">=</span> <span class="p">(</span><span class="nx">l</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">)</span> <span class="o">?</span> <span class="nx">l</span> <span class="o">:</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">min</span><span class="p">(</span><span class="nx">l</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="nx">plugins</span> <span class="o">=</span> <span class="nx">o</span><span class="p">.</span><span class="nx">plugins</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">plugins</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="k">in</span> <span class="nx">plugins</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">plugins</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">(</span><span class="nx">i</span><span class="p">))</span> <span class="p">{</span>
                    <span class="nx">plug</span> <span class="o">=</span> <span class="nx">plugins</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
                    <span class="nx">plug</span><span class="p">.</span><span class="nx">pkg</span> <span class="o">=</span> <span class="nx">name</span><span class="p">;</span>
                    <span class="nx">plug</span><span class="p">.</span><span class="nx">path</span> <span class="o">=</span> <span class="nx">plug</span><span class="p">.</span><span class="nx">path</span> <span class="o">||</span> <span class="nx">_path</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">o</span><span class="p">.</span><span class="nx">type</span><span class="p">);</span>
                    <span class="nx">plug</span><span class="p">.</span><span class="nx">requires</span> <span class="o">=</span> <span class="nx">plug</span><span class="p">.</span><span class="nx">requires</span> <span class="o">||</span> <span class="p">[];</span>
                    <span class="nx">plug</span><span class="p">.</span><span class="nx">group</span> <span class="o">=</span> <span class="nx">o</span><span class="p">.</span><span class="nx">group</span><span class="p">;</span>
                    <span class="k">this</span><span class="p">.</span><span class="nx">addModule</span><span class="p">(</span><span class="nx">plug</span><span class="p">,</span> <span class="nx">i</span><span class="p">);</span>
                    <span class="k">if</span> <span class="p">(</span><span class="nx">o</span><span class="p">.</span><span class="nx">skinnable</span><span class="p">)</span> <span class="p">{</span>
                        <span class="k">this</span><span class="p">.</span><span class="nx">_addSkin</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">skin</span><span class="p">.</span><span class="nx">defaultSkin</span><span class="p">,</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">name</span><span class="p">);</span>
                    <span class="p">}</span>

                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">o</span><span class="p">.</span><span class="nx">condition</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">trigger</span> <span class="o">=</span> <span class="nx">o</span><span class="p">.</span><span class="nx">condition</span><span class="p">.</span><span class="nx">trigger</span><span class="p">;</span>
            <span class="nx">when</span> <span class="o">=</span> <span class="nx">o</span><span class="p">.</span><span class="nx">condition</span><span class="p">.</span><span class="nx">when</span><span class="p">;</span>
            <span class="nx">conditions</span><span class="p">[</span><span class="nx">trigger</span><span class="p">]</span> <span class="o">=</span> <span class="nx">conditions</span><span class="p">[</span><span class="nx">trigger</span><span class="p">]</span> <span class="o">||</span> <span class="p">{};</span>
            <span class="nx">conditions</span><span class="p">[</span><span class="nx">trigger</span><span class="p">][</span><span class="nx">name</span><span class="p">]</span> <span class="o">=</span> <span class="nx">o</span><span class="p">.</span><span class="nx">condition</span><span class="p">;</span>
            <span class="c1">// the &#39;when&#39; attribute can be &#39;before&#39;, &#39;after&#39;, or &#39;instead&#39;</span>
            <span class="c1">// the default is after.</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">when</span> <span class="o">&amp;&amp;</span> <span class="nx">when</span> <span class="o">!=</span> <span class="s1">&#39;after&#39;</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">when</span> <span class="o">==</span> <span class="s1">&#39;instead&#39;</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// replace the trigger</span>
                    <span class="nx">o</span><span class="p">.</span><span class="nx">supersedes</span> <span class="o">=</span> <span class="nx">o</span><span class="p">.</span><span class="nx">supersedes</span> <span class="o">||</span> <span class="p">[];</span>
                    <span class="nx">o</span><span class="p">.</span><span class="nx">supersedes</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">trigger</span><span class="p">);</span>
                <span class="p">}</span> <span class="k">else</span> <span class="p">{</span> <span class="c1">// before the trigger</span>
                    <span class="c1">// the trigger requires the conditional mod,</span>
                    <span class="c1">// so it should appear before the conditional</span>
                    <span class="c1">// mod if we do not intersede.</span>
                <span class="p">}</span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span> <span class="c1">// after the trigger</span>
                <span class="nx">o</span><span class="p">.</span><span class="nx">after</span> <span class="o">=</span> <span class="nx">o</span><span class="p">.</span><span class="nx">after</span> <span class="o">||</span> <span class="p">[];</span>
                <span class="nx">o</span><span class="p">.</span><span class="nx">after</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">trigger</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">o</span><span class="p">.</span><span class="nx">after</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">o</span><span class="p">.</span><span class="nx">after_map</span> <span class="o">=</span> <span class="nx">YArray</span><span class="p">.</span><span class="nx">hash</span><span class="p">(</span><span class="nx">o</span><span class="p">.</span><span class="nx">after</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="c1">// this.dirty = true;</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">o</span><span class="p">.</span><span class="nx">configFn</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">ret</span> <span class="o">=</span> <span class="nx">o</span><span class="p">.</span><span class="nx">configFn</span><span class="p">(</span><span class="nx">o</span><span class="p">);</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">ret</span> <span class="o">===</span> <span class="kc">false</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">delete</span> <span class="k">this</span><span class="p">.</span><span class="nx">moduleInfo</span><span class="p">[</span><span class="nx">name</span><span class="p">];</span>
                <span class="nx">o</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="nx">o</span><span class="p">;</span>
    <span class="p">},</span>

    <span class="cm">/**</span>
<span class="cm">     * Add a requirement for one or more module</span>
<span class="cm">     * @method require</span>
<span class="cm">     * @param {string[] | string*} what the modules to load.</span>
<span class="cm">     */</span>
    <span class="nx">require</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">what</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">a</span> <span class="o">=</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">what</span> <span class="o">===</span> <span class="s1">&#39;string&#39;</span><span class="p">)</span> <span class="o">?</span> <span class="nx">arguments</span> <span class="o">:</span> <span class="nx">what</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">dirty</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
        <span class="nx">Y</span><span class="p">.</span><span class="nx">mix</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">required</span><span class="p">,</span> <span class="nx">YArray</span><span class="p">.</span><span class="nx">hash</span><span class="p">(</span><span class="nx">a</span><span class="p">));</span>
    <span class="p">},</span>

    <span class="cm">/**</span>
<span class="cm">     * Returns an object containing properties for all modules required</span>
<span class="cm">     * in order to load the requested module</span>
<span class="cm">     * @method getRequires</span>
<span class="cm">     * @param {object}  mod The module definition from moduleInfo.</span>
<span class="cm">     * @return {array} the expanded requirement list.</span>
<span class="cm">     */</span>
    <span class="nx">getRequires</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">mod</span><span class="p">)</span> <span class="p">{</span>

        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">mod</span> <span class="o">||</span> <span class="nx">mod</span><span class="p">.</span><span class="nx">_parsed</span><span class="p">)</span> <span class="p">{</span>
            <span class="c1">// Y.log(&#39;returning no reqs for &#39; + mod.name);</span>
            <span class="k">return</span> <span class="nx">NO_REQUIREMENTS</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="kd">var</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">m</span><span class="p">,</span> <span class="nx">j</span><span class="p">,</span> <span class="nx">add</span><span class="p">,</span> <span class="nx">packName</span><span class="p">,</span> <span class="nx">lang</span><span class="p">,</span>
            <span class="nx">name</span> <span class="o">=</span> <span class="nx">mod</span><span class="p">.</span><span class="nx">name</span><span class="p">,</span> <span class="nx">cond</span><span class="p">,</span> <span class="nx">go</span><span class="p">,</span>
            <span class="nx">adddef</span> <span class="o">=</span> <span class="nx">ON_PAGE</span><span class="p">[</span><span class="nx">name</span><span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="nx">ON_PAGE</span><span class="p">[</span><span class="nx">name</span><span class="p">].</span><span class="nx">details</span><span class="p">,</span>
            <span class="nx">d</span><span class="p">,</span>
            <span class="nx">r</span><span class="p">,</span> <span class="nx">old_mod</span><span class="p">,</span>
            <span class="nx">o</span><span class="p">,</span> <span class="nx">skinmod</span><span class="p">,</span> <span class="nx">skindef</span><span class="p">,</span>
            <span class="nx">intl</span> <span class="o">=</span> <span class="nx">mod</span><span class="p">.</span><span class="nx">lang</span> <span class="o">||</span> <span class="nx">mod</span><span class="p">.</span><span class="nx">intl</span><span class="p">,</span>
            <span class="nx">info</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">moduleInfo</span><span class="p">,</span>
            <span class="nx">hash</span><span class="p">;</span>

        <span class="c1">// pattern match leaves module stub that needs to be filled out</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">mod</span><span class="p">.</span><span class="nx">temp</span> <span class="o">&amp;&amp;</span> <span class="nx">adddef</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">old_mod</span> <span class="o">=</span> <span class="nx">mod</span><span class="p">;</span>
            <span class="nx">mod</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">addModule</span><span class="p">(</span><span class="nx">adddef</span><span class="p">,</span> <span class="nx">name</span><span class="p">);</span>
            <span class="nx">mod</span><span class="p">.</span><span class="nx">group</span> <span class="o">=</span> <span class="nx">old_mod</span><span class="p">.</span><span class="nx">group</span><span class="p">;</span>
            <span class="nx">mod</span><span class="p">.</span><span class="nx">pkg</span> <span class="o">=</span> <span class="nx">old_mod</span><span class="p">.</span><span class="nx">pkg</span><span class="p">;</span>
            <span class="k">delete</span> <span class="nx">mod</span><span class="p">.</span><span class="nx">expanded</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="c1">// if (mod.expanded &amp;&amp; (!mod.langCache || mod.langCache == this.lang)) {</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">mod</span><span class="p">.</span><span class="nx">expanded</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">lang</span> <span class="o">||</span> <span class="nx">mod</span><span class="p">.</span><span class="nx">langCache</span> <span class="o">===</span> <span class="k">this</span><span class="p">.</span><span class="nx">lang</span><span class="p">))</span> <span class="p">{</span>
            <span class="c1">// Y.log(&#39;already expanded &#39; + name + &#39;, &#39; + mod.expanded);</span>
            <span class="k">return</span> <span class="nx">mod</span><span class="p">.</span><span class="nx">expanded</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="nx">d</span> <span class="o">=</span> <span class="p">[];</span>
        <span class="nx">hash</span> <span class="o">=</span> <span class="p">{};</span>

        <span class="nx">r</span> <span class="o">=</span> <span class="nx">mod</span><span class="p">.</span><span class="nx">requires</span><span class="p">;</span>
        <span class="nx">o</span> <span class="o">=</span> <span class="nx">mod</span><span class="p">.</span><span class="nx">optional</span><span class="p">;</span>

        <span class="c1">// Y.log(&quot;getRequires: &quot; + name + &quot; (dirty:&quot; + this.dirty +</span>
        <span class="c1">// &quot;, expanded:&quot; + mod.expanded + &quot;)&quot;);</span>

        <span class="nx">mod</span><span class="p">.</span><span class="nx">_parsed</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>


        <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">r</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="c1">// Y.log(name + &#39; requiring &#39; + r[i]);</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">hash</span><span class="p">[</span><span class="nx">r</span><span class="p">[</span><span class="nx">i</span><span class="p">]])</span> <span class="p">{</span>
                <span class="nx">d</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">r</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span>
                <span class="nx">hash</span><span class="p">[</span><span class="nx">r</span><span class="p">[</span><span class="nx">i</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
                <span class="nx">m</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">getModule</span><span class="p">(</span><span class="nx">r</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">m</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">add</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">getRequires</span><span class="p">(</span><span class="nx">m</span><span class="p">);</span>
                    <span class="nx">intl</span> <span class="o">=</span> <span class="nx">intl</span> <span class="o">||</span> <span class="p">(</span><span class="nx">m</span><span class="p">.</span><span class="nx">expanded_map</span> <span class="o">&amp;&amp;</span>
                        <span class="p">(</span><span class="nx">INTL</span> <span class="k">in</span> <span class="nx">m</span><span class="p">.</span><span class="nx">expanded_map</span><span class="p">));</span>
                    <span class="k">for</span> <span class="p">(</span><span class="nx">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">j</span> <span class="o">&lt;</span> <span class="nx">add</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
                        <span class="nx">d</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">add</span><span class="p">[</span><span class="nx">j</span><span class="p">]);</span>
                    <span class="p">}</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="c1">// get the requirements from superseded modules, if any</span>
        <span class="nx">r</span> <span class="o">=</span> <span class="nx">mod</span><span class="p">.</span><span class="nx">supersedes</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">r</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">r</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">hash</span><span class="p">[</span><span class="nx">r</span><span class="p">[</span><span class="nx">i</span><span class="p">]])</span> <span class="p">{</span>
                    <span class="c1">// if this module has submodules, the requirements list is</span>
                    <span class="c1">// expanded to include the submodules.  This is so we can</span>
                    <span class="c1">// prevent dups when a submodule is already loaded and the</span>
                    <span class="c1">// parent is requested.</span>
                    <span class="k">if</span> <span class="p">(</span><span class="nx">mod</span><span class="p">.</span><span class="nx">submodules</span><span class="p">)</span> <span class="p">{</span>
                        <span class="nx">d</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">r</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span>
                    <span class="p">}</span>

                    <span class="nx">hash</span><span class="p">[</span><span class="nx">r</span><span class="p">[</span><span class="nx">i</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
                    <span class="nx">m</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">getModule</span><span class="p">(</span><span class="nx">r</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span>

                    <span class="k">if</span> <span class="p">(</span><span class="nx">m</span><span class="p">)</span> <span class="p">{</span>
                        <span class="nx">add</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">getRequires</span><span class="p">(</span><span class="nx">m</span><span class="p">);</span>
                        <span class="nx">intl</span> <span class="o">=</span> <span class="nx">intl</span> <span class="o">||</span> <span class="p">(</span><span class="nx">m</span><span class="p">.</span><span class="nx">expanded_map</span> <span class="o">&amp;&amp;</span>
                            <span class="p">(</span><span class="nx">INTL</span> <span class="k">in</span> <span class="nx">m</span><span class="p">.</span><span class="nx">expanded_map</span><span class="p">));</span>
                        <span class="k">for</span> <span class="p">(</span><span class="nx">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">j</span> <span class="o">&lt;</span> <span class="nx">add</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
                            <span class="nx">d</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">add</span><span class="p">[</span><span class="nx">j</span><span class="p">]);</span>
                        <span class="p">}</span>
                    <span class="p">}</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">o</span> <span class="o">&amp;&amp;</span> <span class="k">this</span><span class="p">.</span><span class="nx">loadOptional</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">o</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">hash</span><span class="p">[</span><span class="nx">o</span><span class="p">[</span><span class="nx">i</span><span class="p">]])</span> <span class="p">{</span>
                    <span class="nx">d</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">o</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span>
                    <span class="nx">hash</span><span class="p">[</span><span class="nx">o</span><span class="p">[</span><span class="nx">i</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
                    <span class="nx">m</span> <span class="o">=</span> <span class="nx">info</span><span class="p">[</span><span class="nx">o</span><span class="p">[</span><span class="nx">i</span><span class="p">]];</span>
                    <span class="k">if</span> <span class="p">(</span><span class="nx">m</span><span class="p">)</span> <span class="p">{</span>
                        <span class="nx">add</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">getRequires</span><span class="p">(</span><span class="nx">m</span><span class="p">);</span>
                        <span class="nx">intl</span> <span class="o">=</span> <span class="nx">intl</span> <span class="o">||</span> <span class="p">(</span><span class="nx">m</span><span class="p">.</span><span class="nx">expanded_map</span> <span class="o">&amp;&amp;</span>
                            <span class="p">(</span><span class="nx">INTL</span> <span class="k">in</span> <span class="nx">m</span><span class="p">.</span><span class="nx">expanded_map</span><span class="p">));</span>
                        <span class="k">for</span> <span class="p">(</span><span class="nx">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">j</span> <span class="o">&lt;</span> <span class="nx">add</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
                            <span class="nx">d</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">add</span><span class="p">[</span><span class="nx">j</span><span class="p">]);</span>
                        <span class="p">}</span>
                    <span class="p">}</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="nx">cond</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">conditions</span><span class="p">[</span><span class="nx">name</span><span class="p">];</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">cond</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">oeach</span><span class="p">(</span><span class="nx">cond</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">def</span><span class="p">,</span> <span class="nx">condmod</span><span class="p">)</span> <span class="p">{</span>

                <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">hash</span><span class="p">[</span><span class="nx">condmod</span><span class="p">])</span> <span class="p">{</span>
                    <span class="nx">go</span> <span class="o">=</span> <span class="nx">def</span> <span class="o">&amp;&amp;</span> <span class="p">((</span><span class="nx">def</span><span class="p">.</span><span class="nx">ua</span> <span class="o">&amp;&amp;</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">UA</span><span class="p">[</span><span class="nx">def</span><span class="p">.</span><span class="nx">ua</span><span class="p">])</span> <span class="o">||</span>
                                 <span class="p">(</span><span class="nx">def</span><span class="p">.</span><span class="nx">test</span> <span class="o">&amp;&amp;</span> <span class="nx">def</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">Y</span><span class="p">,</span> <span class="nx">r</span><span class="p">)));</span>
                    <span class="k">if</span> <span class="p">(</span><span class="nx">go</span><span class="p">)</span> <span class="p">{</span>
                        <span class="nx">hash</span><span class="p">[</span><span class="nx">condmod</span><span class="p">]</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
                        <span class="nx">d</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">condmod</span><span class="p">);</span>
                        <span class="nx">m</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">getModule</span><span class="p">(</span><span class="nx">condmod</span><span class="p">);</span>
                        <span class="c1">// Y.log(&#39;conditional&#39;, m);</span>
                        <span class="k">if</span> <span class="p">(</span><span class="nx">m</span><span class="p">)</span> <span class="p">{</span>
                            <span class="nx">add</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">getRequires</span><span class="p">(</span><span class="nx">m</span><span class="p">);</span>
                            <span class="k">for</span> <span class="p">(</span><span class="nx">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">j</span> <span class="o">&lt;</span> <span class="nx">add</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
                                <span class="nx">d</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">add</span><span class="p">[</span><span class="nx">j</span><span class="p">]);</span>
                            <span class="p">}</span>
                        <span class="p">}</span>
                    <span class="p">}</span>
                <span class="p">}</span>
            <span class="p">},</span> <span class="k">this</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="c1">// Create skin modules</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">mod</span><span class="p">.</span><span class="nx">skinnable</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">skindef</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">skin</span><span class="p">.</span><span class="nx">overrides</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">skindef</span> <span class="o">&amp;&amp;</span> <span class="nx">skindef</span><span class="p">[</span><span class="nx">name</span><span class="p">])</span> <span class="p">{</span>
                <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">skindef</span><span class="p">[</span><span class="nx">name</span><span class="p">].</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">skinmod</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_addSkin</span><span class="p">(</span><span class="nx">skindef</span><span class="p">[</span><span class="nx">name</span><span class="p">][</span><span class="nx">i</span><span class="p">],</span> <span class="nx">name</span><span class="p">);</span>
                    <span class="nx">d</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">skinmod</span><span class="p">);</span>
                <span class="p">}</span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                <span class="nx">skinmod</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_addSkin</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">skin</span><span class="p">.</span><span class="nx">defaultSkin</span><span class="p">,</span> <span class="nx">name</span><span class="p">);</span>
                <span class="nx">d</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">skinmod</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="nx">mod</span><span class="p">.</span><span class="nx">_parsed</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">intl</span><span class="p">)</span> <span class="p">{</span>

            <span class="k">if</span> <span class="p">(</span><span class="nx">mod</span><span class="p">.</span><span class="nx">lang</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">mod</span><span class="p">.</span><span class="nx">langPack</span> <span class="o">&amp;&amp;</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">Intl</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">lang</span> <span class="o">=</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">Intl</span><span class="p">.</span><span class="nx">lookupBestLang</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">lang</span> <span class="o">||</span> <span class="nx">ROOT_LANG</span><span class="p">,</span> <span class="nx">mod</span><span class="p">.</span><span class="nx">lang</span><span class="p">);</span>
<span class="c1">// Y.log(&#39;Best lang: &#39; + lang + &#39;, this.lang: &#39; +</span>
<span class="c1">// this.lang + &#39;, mod.lang: &#39; + mod.lang);</span>
                <span class="nx">mod</span><span class="p">.</span><span class="nx">langCache</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">lang</span><span class="p">;</span>
                <span class="nx">packName</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">getLangPackName</span><span class="p">(</span><span class="nx">lang</span><span class="p">,</span> <span class="nx">name</span><span class="p">);</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">packName</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">d</span><span class="p">.</span><span class="nx">unshift</span><span class="p">(</span><span class="nx">packName</span><span class="p">);</span>
                <span class="p">}</span>
            <span class="p">}</span>

            <span class="nx">d</span><span class="p">.</span><span class="nx">unshift</span><span class="p">(</span><span class="nx">INTL</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="nx">mod</span><span class="p">.</span><span class="nx">expanded_map</span> <span class="o">=</span> <span class="nx">YArray</span><span class="p">.</span><span class="nx">hash</span><span class="p">(</span><span class="nx">d</span><span class="p">);</span>

        <span class="nx">mod</span><span class="p">.</span><span class="nx">expanded</span> <span class="o">=</span> <span class="nx">YObject</span><span class="p">.</span><span class="nx">keys</span><span class="p">(</span><span class="nx">mod</span><span class="p">.</span><span class="nx">expanded_map</span><span class="p">);</span>

        <span class="k">return</span> <span class="nx">mod</span><span class="p">.</span><span class="nx">expanded</span><span class="p">;</span>
    <span class="p">},</span>


    <span class="cm">/**</span>
<span class="cm">     * Returns a hash of module names the supplied module satisfies.</span>
<span class="cm">     * @method getProvides</span>
<span class="cm">     * @param {string} name The name of the module.</span>
<span class="cm">     * @return {object} what this module provides.</span>
<span class="cm">     */</span>
    <span class="nx">getProvides</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">m</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">getModule</span><span class="p">(</span><span class="nx">name</span><span class="p">),</span> <span class="nx">o</span><span class="p">,</span> <span class="nx">s</span><span class="p">;</span>
            <span class="c1">// supmap = this.provides;</span>

        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">m</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">NOT_FOUND</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">m</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">m</span><span class="p">.</span><span class="nx">provides</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">o</span> <span class="o">=</span> <span class="p">{};</span>
            <span class="nx">s</span> <span class="o">=</span> <span class="nx">m</span><span class="p">.</span><span class="nx">supersedes</span><span class="p">;</span>

            <span class="k">if</span> <span class="p">(</span><span class="nx">s</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">YArray</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="nx">s</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">v</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">Y</span><span class="p">.</span><span class="nx">mix</span><span class="p">(</span><span class="nx">o</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">getProvides</span><span class="p">(</span><span class="nx">v</span><span class="p">));</span>
                <span class="p">},</span> <span class="k">this</span><span class="p">);</span>
            <span class="p">}</span>

            <span class="nx">o</span><span class="p">[</span><span class="nx">name</span><span class="p">]</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
            <span class="nx">m</span><span class="p">.</span><span class="nx">provides</span> <span class="o">=</span> <span class="nx">o</span><span class="p">;</span>

        <span class="p">}</span>

        <span class="k">return</span> <span class="nx">m</span><span class="p">.</span><span class="nx">provides</span><span class="p">;</span>
    <span class="p">},</span>

    <span class="cm">/**</span>
<span class="cm">     * Calculates the dependency tree, the result is stored in the sorted</span>
<span class="cm">     * property.</span>
<span class="cm">     * @method calculate</span>
<span class="cm">     * @param {object} o optional options object.</span>
<span class="cm">     * @param {string} type optional argument to prune modules.</span>
<span class="cm">     */</span>
    <span class="nx">calculate</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">o</span><span class="p">,</span> <span class="nx">type</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">o</span> <span class="o">||</span> <span class="nx">type</span> <span class="o">||</span> <span class="k">this</span><span class="p">.</span><span class="nx">dirty</span><span class="p">)</span> <span class="p">{</span>

            <span class="k">if</span> <span class="p">(</span><span class="nx">o</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">_config</span><span class="p">(</span><span class="nx">o</span><span class="p">);</span>
            <span class="p">}</span>

            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">_init</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">_setup</span><span class="p">();</span>
            <span class="p">}</span>

            <span class="k">this</span><span class="p">.</span><span class="nx">_explode</span><span class="p">();</span>

            <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">allowRollup</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">_rollup</span><span class="p">();</span>
            <span class="p">}</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">_reduce</span><span class="p">();</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">_sort</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">},</span>

    <span class="nx">_addLangPack</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">lang</span><span class="p">,</span> <span class="nx">m</span><span class="p">,</span> <span class="nx">packName</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">name</span> <span class="o">=</span> <span class="nx">m</span><span class="p">.</span><span class="nx">name</span><span class="p">,</span>
            <span class="nx">packPath</span><span class="p">,</span>
            <span class="nx">existing</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">moduleInfo</span><span class="p">[</span><span class="nx">packName</span><span class="p">];</span>

        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">existing</span><span class="p">)</span> <span class="p">{</span>

            <span class="nx">packPath</span> <span class="o">=</span> <span class="nx">_path</span><span class="p">((</span><span class="nx">m</span><span class="p">.</span><span class="nx">pkg</span> <span class="o">||</span> <span class="nx">name</span><span class="p">),</span> <span class="nx">packName</span><span class="p">,</span> <span class="nx">JS</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>

            <span class="k">this</span><span class="p">.</span><span class="nx">addModule</span><span class="p">({</span> <span class="nx">path</span><span class="o">:</span> <span class="nx">packPath</span><span class="p">,</span>
                             <span class="nx">intl</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
                             <span class="nx">langPack</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
                             <span class="nx">ext</span><span class="o">:</span> <span class="nx">m</span><span class="p">.</span><span class="nx">ext</span><span class="p">,</span>
                             <span class="nx">group</span><span class="o">:</span> <span class="nx">m</span><span class="p">.</span><span class="nx">group</span><span class="p">,</span>
                             <span class="nx">supersedes</span><span class="o">:</span> <span class="p">[]</span> <span class="p">},</span> <span class="nx">packName</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>

            <span class="k">if</span> <span class="p">(</span><span class="nx">lang</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">Y</span><span class="p">.</span><span class="nx">Env</span><span class="p">.</span><span class="nx">lang</span> <span class="o">=</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">Env</span><span class="p">.</span><span class="nx">lang</span> <span class="o">||</span> <span class="p">{};</span>
                <span class="nx">Y</span><span class="p">.</span><span class="nx">Env</span><span class="p">.</span><span class="nx">lang</span><span class="p">[</span><span class="nx">lang</span><span class="p">]</span> <span class="o">=</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">Env</span><span class="p">.</span><span class="nx">lang</span><span class="p">[</span><span class="nx">lang</span><span class="p">]</span> <span class="o">||</span> <span class="p">{};</span>
                <span class="nx">Y</span><span class="p">.</span><span class="nx">Env</span><span class="p">.</span><span class="nx">lang</span><span class="p">[</span><span class="nx">lang</span><span class="p">][</span><span class="nx">name</span><span class="p">]</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">moduleInfo</span><span class="p">[</span><span class="nx">packName</span><span class="p">];</span>
    <span class="p">},</span>

    <span class="cm">/**</span>
<span class="cm">     * Investigates the current YUI configuration on the page.  By default,</span>
<span class="cm">     * modules already detected will not be loaded again unless a force</span>
<span class="cm">     * option is encountered.  Called by calculate()</span>
<span class="cm">     * @method _setup</span>
<span class="cm">     * @private</span>
<span class="cm">     */</span>
    <span class="nx">_setup</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">info</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">moduleInfo</span><span class="p">,</span> <span class="nx">name</span><span class="p">,</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">j</span><span class="p">,</span> <span class="nx">m</span><span class="p">,</span> <span class="nx">l</span><span class="p">,</span>
            <span class="nx">packName</span><span class="p">;</span>

        <span class="k">for</span> <span class="p">(</span><span class="nx">name</span> <span class="k">in</span> <span class="nx">info</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">info</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">(</span><span class="nx">name</span><span class="p">))</span> <span class="p">{</span>
                <span class="nx">m</span> <span class="o">=</span> <span class="nx">info</span><span class="p">[</span><span class="nx">name</span><span class="p">];</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">m</span><span class="p">)</span> <span class="p">{</span>

                    <span class="c1">// remove dups</span>
                    <span class="nx">m</span><span class="p">.</span><span class="nx">requires</span> <span class="o">=</span> <span class="nx">YObject</span><span class="p">.</span><span class="nx">keys</span><span class="p">(</span><span class="nx">YArray</span><span class="p">.</span><span class="nx">hash</span><span class="p">(</span><span class="nx">m</span><span class="p">.</span><span class="nx">requires</span><span class="p">));</span>

                    <span class="c1">// Create lang pack modules</span>
                    <span class="k">if</span> <span class="p">(</span><span class="nx">m</span><span class="p">.</span><span class="nx">lang</span> <span class="o">&amp;&amp;</span> <span class="nx">m</span><span class="p">.</span><span class="nx">lang</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
                        <span class="c1">// Setup root package if the module has lang defined,</span>
                        <span class="c1">// it needs to provide a root language pack</span>
                        <span class="nx">packName</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">getLangPackName</span><span class="p">(</span><span class="nx">ROOT_LANG</span><span class="p">,</span> <span class="nx">name</span><span class="p">);</span>
                        <span class="k">this</span><span class="p">.</span><span class="nx">_addLangPack</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span> <span class="nx">m</span><span class="p">,</span> <span class="nx">packName</span><span class="p">);</span>
                    <span class="p">}</span>

                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>


        <span class="c1">//l = Y.merge(this.inserted);</span>
        <span class="nx">l</span> <span class="o">=</span> <span class="p">{};</span>

        <span class="c1">// available modules</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">ignoreRegistered</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">Y</span><span class="p">.</span><span class="nx">mix</span><span class="p">(</span><span class="nx">l</span><span class="p">,</span> <span class="nx">GLOBAL_ENV</span><span class="p">.</span><span class="nx">mods</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="c1">// add the ignore list to the list of loaded packages</span>
        <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">ignore</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">Y</span><span class="p">.</span><span class="nx">mix</span><span class="p">(</span><span class="nx">l</span><span class="p">,</span> <span class="nx">YArray</span><span class="p">.</span><span class="nx">hash</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">ignore</span><span class="p">));</span>
        <span class="p">}</span>

        <span class="c1">// expand the list to include superseded modules</span>
        <span class="k">for</span> <span class="p">(</span><span class="nx">j</span> <span class="k">in</span> <span class="nx">l</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">l</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">(</span><span class="nx">j</span><span class="p">))</span> <span class="p">{</span>
                <span class="nx">Y</span><span class="p">.</span><span class="nx">mix</span><span class="p">(</span><span class="nx">l</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">getProvides</span><span class="p">(</span><span class="nx">j</span><span class="p">));</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="c1">// remove modules on the force list from the loaded list</span>
        <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">force</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">force</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">force</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="k">in</span> <span class="nx">l</span><span class="p">)</span> <span class="p">{</span>
                    <span class="k">delete</span> <span class="nx">l</span><span class="p">[</span><span class="k">this</span><span class="p">.</span><span class="nx">force</span><span class="p">[</span><span class="nx">i</span><span class="p">]];</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="nx">Y</span><span class="p">.</span><span class="nx">mix</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">loaded</span><span class="p">,</span> <span class="nx">l</span><span class="p">);</span>

        <span class="k">this</span><span class="p">.</span><span class="nx">_init</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
    <span class="p">},</span>

    <span class="cm">/**</span>
<span class="cm">     * Builds a module name for a language pack</span>
<span class="cm">     * @method getLangPackName</span>
<span class="cm">     * @param {string} lang the language code.</span>
<span class="cm">     * @param {string} mname the module to build it for.</span>
<span class="cm">     * @return {string} the language pack module name.</span>
<span class="cm">     */</span>
    <span class="nx">getLangPackName</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">lang</span><span class="p">,</span> <span class="nx">mname</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">(</span><span class="s1">&#39;lang/&#39;</span> <span class="o">+</span> <span class="nx">mname</span> <span class="o">+</span> <span class="p">((</span><span class="nx">lang</span><span class="p">)</span> <span class="o">?</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="nx">lang</span> <span class="o">:</span> <span class="s1">&#39;&#39;</span><span class="p">));</span>
    <span class="p">},</span>

    <span class="cm">/**</span>
<span class="cm">     * Inspects the required modules list looking for additional</span>
<span class="cm">     * dependencies.  Expands the required list to include all</span>
<span class="cm">     * required modules.  Called by calculate()</span>
<span class="cm">     * @method _explode</span>
<span class="cm">     * @private</span>
<span class="cm">     */</span>
    <span class="nx">_explode</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">r</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">required</span><span class="p">,</span> <span class="nx">m</span><span class="p">,</span> <span class="nx">reqs</span><span class="p">,</span> <span class="nx">done</span> <span class="o">=</span> <span class="p">{},</span>
            <span class="nx">self</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>

        <span class="c1">// the setup phase is over, all modules have been created</span>
        <span class="nx">self</span><span class="p">.</span><span class="nx">dirty</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>

        <span class="nx">oeach</span><span class="p">(</span><span class="nx">r</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">v</span><span class="p">,</span> <span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">done</span><span class="p">[</span><span class="nx">name</span><span class="p">])</span> <span class="p">{</span>
                <span class="nx">done</span><span class="p">[</span><span class="nx">name</span><span class="p">]</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
                <span class="nx">m</span> <span class="o">=</span> <span class="nx">self</span><span class="p">.</span><span class="nx">getModule</span><span class="p">(</span><span class="nx">name</span><span class="p">);</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">m</span><span class="p">)</span> <span class="p">{</span>
                    <span class="kd">var</span> <span class="nx">expound</span> <span class="o">=</span> <span class="nx">m</span><span class="p">.</span><span class="nx">expound</span><span class="p">;</span>

                    <span class="k">if</span> <span class="p">(</span><span class="nx">expound</span><span class="p">)</span> <span class="p">{</span>
                        <span class="nx">r</span><span class="p">[</span><span class="nx">expound</span><span class="p">]</span> <span class="o">=</span> <span class="nx">self</span><span class="p">.</span><span class="nx">getModule</span><span class="p">(</span><span class="nx">expound</span><span class="p">);</span>
                        <span class="nx">reqs</span> <span class="o">=</span> <span class="nx">self</span><span class="p">.</span><span class="nx">getRequires</span><span class="p">(</span><span class="nx">r</span><span class="p">[</span><span class="nx">expound</span><span class="p">]);</span>
                        <span class="nx">Y</span><span class="p">.</span><span class="nx">mix</span><span class="p">(</span><span class="nx">r</span><span class="p">,</span> <span class="nx">YArray</span><span class="p">.</span><span class="nx">hash</span><span class="p">(</span><span class="nx">reqs</span><span class="p">));</span>
                    <span class="p">}</span>

                    <span class="nx">reqs</span> <span class="o">=</span> <span class="nx">self</span><span class="p">.</span><span class="nx">getRequires</span><span class="p">(</span><span class="nx">m</span><span class="p">);</span>
                    <span class="nx">Y</span><span class="p">.</span><span class="nx">mix</span><span class="p">(</span><span class="nx">r</span><span class="p">,</span> <span class="nx">YArray</span><span class="p">.</span><span class="nx">hash</span><span class="p">(</span><span class="nx">reqs</span><span class="p">));</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">});</span>

        <span class="c1">// Y.log(&#39;After explode: &#39; + YObject.keys(r));</span>
    <span class="p">},</span>

    <span class="nx">getModule</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">mname</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">//TODO: Remove name check - it&#39;s a quick hack to fix pattern WIP</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">mname</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="kd">var</span> <span class="nx">p</span><span class="p">,</span> <span class="nx">found</span><span class="p">,</span> <span class="nx">pname</span><span class="p">,</span>
            <span class="nx">m</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">moduleInfo</span><span class="p">[</span><span class="nx">mname</span><span class="p">],</span>
            <span class="nx">patterns</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">patterns</span><span class="p">;</span>

        <span class="c1">// check the patterns library to see if we should automatically add</span>
        <span class="c1">// the module with defaults</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">m</span><span class="p">)</span> <span class="p">{</span>
           <span class="c1">// Y.log(&#39;testing patterns &#39; + YObject.keys(patterns));</span>
            <span class="k">for</span> <span class="p">(</span><span class="nx">pname</span> <span class="k">in</span> <span class="nx">patterns</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">patterns</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">(</span><span class="nx">pname</span><span class="p">))</span> <span class="p">{</span>
                    <span class="c1">// Y.log(&#39;testing pattern &#39; + i);</span>
                    <span class="nx">p</span> <span class="o">=</span> <span class="nx">patterns</span><span class="p">[</span><span class="nx">pname</span><span class="p">];</span>

                    <span class="c1">// use the metadata supplied for the pattern</span>
                    <span class="c1">// as the module definition.</span>
                    <span class="k">if</span> <span class="p">(</span><span class="nx">mname</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">pname</span><span class="p">)</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
                        <span class="nx">found</span> <span class="o">=</span> <span class="nx">p</span><span class="p">;</span>
                        <span class="k">break</span><span class="p">;</span>
                    <span class="p">}</span>
                <span class="p">}</span>
            <span class="p">}</span>

            <span class="k">if</span> <span class="p">(</span><span class="nx">found</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">p</span><span class="p">.</span><span class="nx">action</span><span class="p">)</span> <span class="p">{</span>
                    <span class="c1">// Y.log(&#39;executing pattern action: &#39; + pname);</span>
                    <span class="nx">p</span><span class="p">.</span><span class="nx">action</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">mname</span><span class="p">,</span> <span class="nx">pname</span><span class="p">);</span>
                <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
<span class="nx">Y</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Undefined module: &#39;</span> <span class="o">+</span> <span class="nx">mname</span> <span class="o">+</span> <span class="s1">&#39;, matched a pattern: &#39;</span> <span class="o">+</span>
    <span class="nx">pname</span><span class="p">,</span> <span class="s1">&#39;info&#39;</span><span class="p">,</span> <span class="s1">&#39;loader&#39;</span><span class="p">);</span>
                    <span class="c1">// ext true or false?</span>
                    <span class="nx">m</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">addModule</span><span class="p">(</span><span class="nx">Y</span><span class="p">.</span><span class="nx">merge</span><span class="p">(</span><span class="nx">found</span><span class="p">),</span> <span class="nx">mname</span><span class="p">);</span>
                    <span class="nx">m</span><span class="p">.</span><span class="nx">temp</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="nx">m</span><span class="p">;</span>
    <span class="p">},</span>

    <span class="c1">// impl in rollup submodule</span>
    <span class="nx">_rollup</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span> <span class="p">},</span>

    <span class="cm">/**</span>
<span class="cm">     * Remove superceded modules and loaded modules.  Called by</span>
<span class="cm">     * calculate() after we have the mega list of all dependencies</span>
<span class="cm">     * @method _reduce</span>
<span class="cm">     * @return {object} the reduced dependency hash.</span>
<span class="cm">     * @private</span>
<span class="cm">     */</span>
    <span class="nx">_reduce</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">r</span><span class="p">)</span> <span class="p">{</span>

        <span class="nx">r</span> <span class="o">=</span> <span class="nx">r</span> <span class="o">||</span> <span class="k">this</span><span class="p">.</span><span class="nx">required</span><span class="p">;</span>

        <span class="kd">var</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">j</span><span class="p">,</span> <span class="nx">s</span><span class="p">,</span> <span class="nx">m</span><span class="p">,</span> <span class="nx">type</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">loadType</span><span class="p">;</span>
        <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="k">in</span> <span class="nx">r</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">r</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">(</span><span class="nx">i</span><span class="p">))</span> <span class="p">{</span>
                <span class="nx">m</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">getModule</span><span class="p">(</span><span class="nx">i</span><span class="p">);</span>
                <span class="c1">// remove if already loaded</span>
                <span class="k">if</span> <span class="p">(((</span><span class="k">this</span><span class="p">.</span><span class="nx">loaded</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">||</span> <span class="nx">ON_PAGE</span><span class="p">[</span><span class="nx">i</span><span class="p">])</span> <span class="o">&amp;&amp;</span>
                        <span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">forceMap</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">ignoreRegistered</span><span class="p">)</span> <span class="o">||</span>
                        <span class="p">(</span><span class="nx">type</span> <span class="o">&amp;&amp;</span> <span class="nx">m</span> <span class="o">&amp;&amp;</span> <span class="nx">m</span><span class="p">.</span><span class="nx">type</span> <span class="o">!=</span> <span class="nx">type</span><span class="p">))</span> <span class="p">{</span>
                    <span class="k">delete</span> <span class="nx">r</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
                <span class="p">}</span>
                <span class="c1">// remove anything this module supersedes</span>
                <span class="nx">s</span> <span class="o">=</span> <span class="nx">m</span> <span class="o">&amp;&amp;</span> <span class="nx">m</span><span class="p">.</span><span class="nx">supersedes</span><span class="p">;</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">s</span><span class="p">)</span> <span class="p">{</span>
                    <span class="k">for</span> <span class="p">(</span><span class="nx">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">j</span> <span class="o">&lt;</span> <span class="nx">s</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
                        <span class="k">if</span> <span class="p">(</span><span class="nx">s</span><span class="p">[</span><span class="nx">j</span><span class="p">]</span> <span class="k">in</span> <span class="nx">r</span><span class="p">)</span> <span class="p">{</span>
                            <span class="k">delete</span> <span class="nx">r</span><span class="p">[</span><span class="nx">s</span><span class="p">[</span><span class="nx">j</span><span class="p">]];</span>
                        <span class="p">}</span>
                    <span class="p">}</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="c1">// Y.log(&#39;required now: &#39; + YObject.keys(r));</span>

        <span class="k">return</span> <span class="nx">r</span><span class="p">;</span>
    <span class="p">},</span>

    <span class="nx">_finish</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">msg</span><span class="p">,</span> <span class="nx">success</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">Y</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;loader finishing: &#39;</span> <span class="o">+</span> <span class="nx">msg</span> <span class="o">+</span> <span class="s1">&#39;, &#39;</span> <span class="o">+</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">id</span> <span class="o">+</span> <span class="s1">&#39;, &#39;</span> <span class="o">+</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">data</span><span class="p">,</span> <span class="s1">&#39;info&#39;</span><span class="p">,</span> <span class="s1">&#39;loader&#39;</span><span class="p">);</span>

        <span class="nx">_queue</span><span class="p">.</span><span class="nx">running</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>

        <span class="kd">var</span> <span class="nx">onEnd</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">onEnd</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">onEnd</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">onEnd</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">context</span><span class="p">,</span> <span class="p">{</span>
                <span class="nx">msg</span><span class="o">:</span> <span class="nx">msg</span><span class="p">,</span>
                <span class="nx">data</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">data</span><span class="p">,</span>
                <span class="nx">success</span><span class="o">:</span> <span class="nx">success</span>
            <span class="p">});</span>
        <span class="p">}</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">_continue</span><span class="p">();</span>
    <span class="p">},</span>

    <span class="nx">_onSuccess</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">self</span> <span class="o">=</span> <span class="k">this</span><span class="p">,</span> <span class="nx">skipped</span> <span class="o">=</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">merge</span><span class="p">(</span><span class="nx">self</span><span class="p">.</span><span class="nx">skipped</span><span class="p">),</span> <span class="nx">fn</span><span class="p">,</span>
            <span class="nx">failed</span> <span class="o">=</span> <span class="p">[],</span> <span class="nx">rreg</span> <span class="o">=</span> <span class="nx">self</span><span class="p">.</span><span class="nx">requireRegistration</span><span class="p">,</span>
            <span class="nx">success</span><span class="p">,</span> <span class="nx">msg</span><span class="p">;</span>

        <span class="nx">oeach</span><span class="p">(</span><span class="nx">skipped</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">k</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">delete</span> <span class="nx">self</span><span class="p">.</span><span class="nx">inserted</span><span class="p">[</span><span class="nx">k</span><span class="p">];</span>
        <span class="p">});</span>

        <span class="nx">self</span><span class="p">.</span><span class="nx">skipped</span> <span class="o">=</span> <span class="p">{};</span>

        <span class="nx">oeach</span><span class="p">(</span><span class="nx">self</span><span class="p">.</span><span class="nx">inserted</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">v</span><span class="p">,</span> <span class="nx">k</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">mod</span> <span class="o">=</span> <span class="nx">self</span><span class="p">.</span><span class="nx">getModule</span><span class="p">(</span><span class="nx">k</span><span class="p">);</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">mod</span> <span class="o">&amp;&amp;</span> <span class="nx">rreg</span> <span class="o">&amp;&amp;</span> <span class="nx">mod</span><span class="p">.</span><span class="nx">type</span> <span class="o">==</span> <span class="nx">JS</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="p">(</span><span class="nx">k</span> <span class="k">in</span> <span class="nx">YUI</span><span class="p">.</span><span class="nx">Env</span><span class="p">.</span><span class="nx">mods</span><span class="p">))</span> <span class="p">{</span>
                <span class="nx">failed</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">k</span><span class="p">);</span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                <span class="nx">Y</span><span class="p">.</span><span class="nx">mix</span><span class="p">(</span><span class="nx">self</span><span class="p">.</span><span class="nx">loaded</span><span class="p">,</span> <span class="nx">self</span><span class="p">.</span><span class="nx">getProvides</span><span class="p">(</span><span class="nx">k</span><span class="p">));</span>
            <span class="p">}</span>
        <span class="p">});</span>

        <span class="nx">fn</span> <span class="o">=</span> <span class="nx">self</span><span class="p">.</span><span class="nx">onSuccess</span><span class="p">;</span>
        <span class="nx">msg</span> <span class="o">=</span> <span class="p">(</span><span class="nx">failed</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="o">?</span> <span class="s1">&#39;notregistered&#39;</span> <span class="o">:</span> <span class="s1">&#39;success&#39;</span><span class="p">;</span>
        <span class="nx">success</span> <span class="o">=</span> <span class="o">!</span><span class="p">(</span><span class="nx">failed</span><span class="p">.</span><span class="nx">length</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">fn</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">fn</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">self</span><span class="p">.</span><span class="nx">context</span><span class="p">,</span> <span class="p">{</span>
                <span class="nx">msg</span><span class="o">:</span> <span class="nx">msg</span><span class="p">,</span>
                <span class="nx">data</span><span class="o">:</span> <span class="nx">self</span><span class="p">.</span><span class="nx">data</span><span class="p">,</span>
                <span class="nx">success</span><span class="o">:</span> <span class="nx">success</span><span class="p">,</span>
                <span class="nx">failed</span><span class="o">:</span> <span class="nx">failed</span><span class="p">,</span>
                <span class="nx">skipped</span><span class="o">:</span> <span class="nx">skipped</span>
            <span class="p">});</span>
        <span class="p">}</span>
        <span class="nx">self</span><span class="p">.</span><span class="nx">_finish</span><span class="p">(</span><span class="nx">msg</span><span class="p">,</span> <span class="nx">success</span><span class="p">);</span>
    <span class="p">},</span>
    <span class="nx">_onFailure</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">o</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">Y</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;load error: &#39;</span> <span class="o">+</span> <span class="nx">o</span><span class="p">.</span><span class="nx">msg</span> <span class="o">+</span> <span class="s1">&#39;, &#39;</span> <span class="o">+</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">id</span><span class="p">,</span> <span class="s1">&#39;error&#39;</span><span class="p">,</span> <span class="s1">&#39;loader&#39;</span><span class="p">);</span>
        <span class="kd">var</span> <span class="nx">f</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">onFailure</span><span class="p">,</span> <span class="nx">msg</span> <span class="o">=</span> <span class="s1">&#39;failure: &#39;</span> <span class="o">+</span> <span class="nx">o</span><span class="p">.</span><span class="nx">msg</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">f</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">f</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">context</span><span class="p">,</span> <span class="p">{</span>
                <span class="nx">msg</span><span class="o">:</span> <span class="nx">msg</span><span class="p">,</span>
                <span class="nx">data</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">data</span><span class="p">,</span>
                <span class="nx">success</span><span class="o">:</span> <span class="kc">false</span>
            <span class="p">});</span>
        <span class="p">}</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">_finish</span><span class="p">(</span><span class="nx">msg</span><span class="p">,</span> <span class="kc">false</span><span class="p">);</span>
    <span class="p">},</span>

    <span class="nx">_onTimeout</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">Y</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;loader timeout: &#39;</span> <span class="o">+</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">id</span><span class="p">,</span> <span class="s1">&#39;error&#39;</span><span class="p">,</span> <span class="s1">&#39;loader&#39;</span><span class="p">);</span>
        <span class="kd">var</span> <span class="nx">f</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">onTimeout</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">f</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">f</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">context</span><span class="p">,</span> <span class="p">{</span>
                <span class="nx">msg</span><span class="o">:</span> <span class="s1">&#39;timeout&#39;</span><span class="p">,</span>
                <span class="nx">data</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">data</span><span class="p">,</span>
                <span class="nx">success</span><span class="o">:</span> <span class="kc">false</span>
            <span class="p">});</span>
        <span class="p">}</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">_finish</span><span class="p">(</span><span class="s1">&#39;timeout&#39;</span><span class="p">,</span> <span class="kc">false</span><span class="p">);</span>
    <span class="p">},</span>

    <span class="cm">/**</span>
<span class="cm">     * Sorts the dependency tree.  The last step of calculate()</span>
<span class="cm">     * @method _sort</span>
<span class="cm">     * @private</span>
<span class="cm">     */</span>
    <span class="nx">_sort</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>

        <span class="c1">// create an indexed list</span>
        <span class="kd">var</span> <span class="nx">s</span> <span class="o">=</span> <span class="nx">YObject</span><span class="p">.</span><span class="nx">keys</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">required</span><span class="p">),</span>
            <span class="c1">// loaded = this.loaded,</span>
            <span class="nx">done</span> <span class="o">=</span> <span class="p">{},</span>
            <span class="nx">p</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">l</span><span class="p">,</span> <span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">,</span> <span class="nx">j</span><span class="p">,</span> <span class="nx">k</span><span class="p">,</span> <span class="nx">moved</span><span class="p">,</span> <span class="nx">doneKey</span><span class="p">;</span>


        <span class="c1">// keep going until we make a pass without moving anything</span>
        <span class="k">for</span> <span class="p">(;;)</span> <span class="p">{</span>

            <span class="nx">l</span> <span class="o">=</span> <span class="nx">s</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
            <span class="nx">moved</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>

            <span class="c1">// start the loop after items that are already sorted</span>
            <span class="k">for</span> <span class="p">(</span><span class="nx">j</span> <span class="o">=</span> <span class="nx">p</span><span class="p">;</span> <span class="nx">j</span> <span class="o">&lt;</span> <span class="nx">l</span><span class="p">;</span> <span class="nx">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>

                <span class="c1">// check the next module on the list to see if its</span>
                <span class="c1">// dependencies have been met</span>
                <span class="nx">a</span> <span class="o">=</span> <span class="nx">s</span><span class="p">[</span><span class="nx">j</span><span class="p">];</span>

                <span class="c1">// check everything below current item and move if we</span>
                <span class="c1">// find a requirement for the current item</span>
                <span class="k">for</span> <span class="p">(</span><span class="nx">k</span> <span class="o">=</span> <span class="nx">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span> <span class="nx">k</span> <span class="o">&lt;</span> <span class="nx">l</span><span class="p">;</span> <span class="nx">k</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">doneKey</span> <span class="o">=</span> <span class="nx">a</span> <span class="o">+</span> <span class="nx">s</span><span class="p">[</span><span class="nx">k</span><span class="p">];</span>

                    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">done</span><span class="p">[</span><span class="nx">doneKey</span><span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="k">this</span><span class="p">.</span><span class="nx">_requires</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">s</span><span class="p">[</span><span class="nx">k</span><span class="p">]))</span> <span class="p">{</span>

                        <span class="c1">// extract the dependency so we can move it up</span>
                        <span class="nx">b</span> <span class="o">=</span> <span class="nx">s</span><span class="p">.</span><span class="nx">splice</span><span class="p">(</span><span class="nx">k</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>

                        <span class="c1">// insert the dependency above the item that</span>
                        <span class="c1">// requires it</span>
                        <span class="nx">s</span><span class="p">.</span><span class="nx">splice</span><span class="p">(</span><span class="nx">j</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">b</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>

                        <span class="c1">// only swap two dependencies once to short circut</span>
                        <span class="c1">// circular dependencies</span>
                        <span class="nx">done</span><span class="p">[</span><span class="nx">doneKey</span><span class="p">]</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>

                        <span class="c1">// keep working</span>
                        <span class="nx">moved</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>

                        <span class="k">break</span><span class="p">;</span>
                    <span class="p">}</span>
                <span class="p">}</span>

                <span class="c1">// jump out of loop if we moved something</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">moved</span><span class="p">)</span> <span class="p">{</span>
                    <span class="k">break</span><span class="p">;</span>
                <span class="c1">// this item is sorted, move our pointer and keep going</span>
                <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                    <span class="nx">p</span><span class="o">++</span><span class="p">;</span>
                <span class="p">}</span>
            <span class="p">}</span>

            <span class="c1">// when we make it here and moved is false, we are</span>
            <span class="c1">// finished sorting</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">moved</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">break</span><span class="p">;</span>
            <span class="p">}</span>

        <span class="p">}</span>

        <span class="k">this</span><span class="p">.</span><span class="nx">sorted</span> <span class="o">=</span> <span class="nx">s</span><span class="p">;</span>

    <span class="p">},</span>

    <span class="nx">partial</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">partial</span><span class="p">,</span> <span class="nx">o</span><span class="p">,</span> <span class="nx">type</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">sorted</span> <span class="o">=</span> <span class="nx">partial</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">insert</span><span class="p">(</span><span class="nx">o</span><span class="p">,</span> <span class="nx">type</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
    <span class="p">},</span>

    <span class="nx">_insert</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">source</span><span class="p">,</span> <span class="nx">o</span><span class="p">,</span> <span class="nx">type</span><span class="p">,</span> <span class="nx">skipcalc</span><span class="p">)</span> <span class="p">{</span>

<span class="c1">// Y.log(&#39;private _insert() &#39; + (type || &#39;&#39;) + &#39;, &#39; + Y.id, &quot;info&quot;, &quot;loader&quot;);</span>

        <span class="c1">// restore the state at the time of the request</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">source</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">_config</span><span class="p">(</span><span class="nx">source</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="c1">// build the dependency list</span>
        <span class="c1">// don&#39;t include type so we can process CSS and script in</span>
        <span class="c1">// one pass when the type is not specified.</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">skipcalc</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">calculate</span><span class="p">(</span><span class="nx">o</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="k">this</span><span class="p">.</span><span class="nx">loadType</span> <span class="o">=</span> <span class="nx">type</span><span class="p">;</span>

        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">type</span><span class="p">)</span> <span class="p">{</span>

            <span class="kd">var</span> <span class="nx">self</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>

            <span class="c1">// Y.log(&quot;trying to load css first&quot;);</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">_internalCallback</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>

                <span class="kd">var</span> <span class="nx">f</span> <span class="o">=</span> <span class="nx">self</span><span class="p">.</span><span class="nx">onCSS</span><span class="p">,</span> <span class="nx">n</span><span class="p">,</span> <span class="nx">p</span><span class="p">,</span> <span class="nx">sib</span><span class="p">;</span>

                <span class="c1">// IE hack for style overrides that are not being applied</span>
                <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">insertBefore</span> <span class="o">&amp;&amp;</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">UA</span><span class="p">.</span><span class="nx">ie</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">n</span> <span class="o">=</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">config</span><span class="p">.</span><span class="nx">doc</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">insertBefore</span><span class="p">);</span>
                    <span class="nx">p</span> <span class="o">=</span> <span class="nx">n</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">;</span>
                    <span class="nx">sib</span> <span class="o">=</span> <span class="nx">n</span><span class="p">.</span><span class="nx">nextSibling</span><span class="p">;</span>
                    <span class="nx">p</span><span class="p">.</span><span class="nx">removeChild</span><span class="p">(</span><span class="nx">n</span><span class="p">);</span>
                    <span class="k">if</span> <span class="p">(</span><span class="nx">sib</span><span class="p">)</span> <span class="p">{</span>
                        <span class="nx">p</span><span class="p">.</span><span class="nx">insertBefore</span><span class="p">(</span><span class="nx">n</span><span class="p">,</span> <span class="nx">sib</span><span class="p">);</span>
                    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                        <span class="nx">p</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">n</span><span class="p">);</span>
                    <span class="p">}</span>
                <span class="p">}</span>

                <span class="k">if</span> <span class="p">(</span><span class="nx">f</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">f</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">self</span><span class="p">.</span><span class="nx">context</span><span class="p">,</span> <span class="nx">Y</span><span class="p">);</span>
                <span class="p">}</span>
                <span class="nx">self</span><span class="p">.</span><span class="nx">_internalCallback</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>

                <span class="nx">self</span><span class="p">.</span><span class="nx">_insert</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span> <span class="kc">null</span><span class="p">,</span> <span class="nx">JS</span><span class="p">);</span>
            <span class="p">};</span>

            <span class="k">this</span><span class="p">.</span><span class="nx">_insert</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span> <span class="kc">null</span><span class="p">,</span> <span class="nx">CSS</span><span class="p">);</span>

            <span class="k">return</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="c1">// set a flag to indicate the load has started</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">_loading</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>

        <span class="c1">// flag to indicate we are done with the combo service</span>
        <span class="c1">// and any additional files will need to be loaded</span>
        <span class="c1">// individually</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">_combineComplete</span> <span class="o">=</span> <span class="p">{};</span>

        <span class="c1">// start the load</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">loadNext</span><span class="p">();</span>

    <span class="p">},</span>

    <span class="c1">// Once a loader operation is completely finished, process</span>
    <span class="c1">// any additional queued items.</span>
    <span class="nx">_continue</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="nx">_queue</span><span class="p">.</span><span class="nx">running</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nx">_queue</span><span class="p">.</span><span class="nx">size</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">_queue</span><span class="p">.</span><span class="nx">running</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
            <span class="nx">_queue</span><span class="p">.</span><span class="nx">next</span><span class="p">()();</span>
        <span class="p">}</span>
    <span class="p">},</span>

    <span class="cm">/**</span>
<span class="cm">     * inserts the requested modules and their dependencies.</span>
<span class="cm">     * &lt;code&gt;type&lt;/code&gt; can be &quot;js&quot; or &quot;css&quot;.  Both script and</span>
<span class="cm">     * css are inserted if type is not provided.</span>
<span class="cm">     * @method insert</span>
<span class="cm">     * @param {object} o optional options object.</span>
<span class="cm">     * @param {string} type the type of dependency to insert.</span>
<span class="cm">     */</span>
    <span class="nx">insert</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">o</span><span class="p">,</span> <span class="nx">type</span><span class="p">,</span> <span class="nx">skipsort</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// Y.log(&#39;public insert() &#39; + (type || &#39;&#39;) + &#39;, &#39; +</span>
        <span class="c1">//  Y.Object.keys(this.required), &quot;info&quot;, &quot;loader&quot;);</span>
        <span class="kd">var</span> <span class="nx">self</span> <span class="o">=</span> <span class="k">this</span><span class="p">,</span> <span class="nx">copy</span> <span class="o">=</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">merge</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
        <span class="k">delete</span> <span class="nx">copy</span><span class="p">.</span><span class="nx">require</span><span class="p">;</span>
        <span class="k">delete</span> <span class="nx">copy</span><span class="p">.</span><span class="nx">dirty</span><span class="p">;</span>
        <span class="nx">_queue</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
            <span class="nx">self</span><span class="p">.</span><span class="nx">_insert</span><span class="p">(</span><span class="nx">copy</span><span class="p">,</span> <span class="nx">o</span><span class="p">,</span> <span class="nx">type</span><span class="p">,</span> <span class="nx">skipsort</span><span class="p">);</span>
        <span class="p">});</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">_continue</span><span class="p">();</span>
    <span class="p">},</span>

    <span class="cm">/**</span>
<span class="cm">     * Executed every time a module is loaded, and if we are in a load</span>
<span class="cm">     * cycle, we attempt to load the next script.  Public so that it</span>
<span class="cm">     * is possible to call this if using a method other than</span>
<span class="cm">     * Y.register to determine when scripts are fully loaded</span>
<span class="cm">     * @method loadNext</span>
<span class="cm">     * @param {string} mname optional the name of the module that has</span>
<span class="cm">     * been loaded (which is usually why it is time to load the next</span>
<span class="cm">     * one).</span>
<span class="cm">     */</span>
    <span class="nx">loadNext</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">mname</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// It is possible that this function is executed due to something</span>
        <span class="c1">// else one the page loading a YUI module.  Only react when we</span>
        <span class="c1">// are actively loading something</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">_loading</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="kd">var</span> <span class="nx">s</span><span class="p">,</span> <span class="nx">len</span><span class="p">,</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">m</span><span class="p">,</span> <span class="nx">url</span><span class="p">,</span> <span class="nx">fn</span><span class="p">,</span> <span class="nx">msg</span><span class="p">,</span> <span class="nx">attr</span><span class="p">,</span> <span class="nx">group</span><span class="p">,</span> <span class="nx">groupName</span><span class="p">,</span> <span class="nx">j</span><span class="p">,</span> <span class="nx">frag</span><span class="p">,</span>
            <span class="nx">comboSource</span><span class="p">,</span> <span class="nx">comboSources</span><span class="p">,</span> <span class="nx">mods</span><span class="p">,</span> <span class="nx">combining</span><span class="p">,</span> <span class="nx">urls</span><span class="p">,</span> <span class="nx">comboBase</span><span class="p">,</span>
            <span class="nx">self</span> <span class="o">=</span> <span class="k">this</span><span class="p">,</span>
            <span class="nx">type</span> <span class="o">=</span> <span class="nx">self</span><span class="p">.</span><span class="nx">loadType</span><span class="p">,</span>
            <span class="nx">handleSuccess</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">o</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">self</span><span class="p">.</span><span class="nx">loadNext</span><span class="p">(</span><span class="nx">o</span><span class="p">.</span><span class="nx">data</span><span class="p">);</span>
            <span class="p">},</span>
            <span class="nx">handleCombo</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">o</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">self</span><span class="p">.</span><span class="nx">_combineComplete</span><span class="p">[</span><span class="nx">type</span><span class="p">]</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
                <span class="kd">var</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">len</span> <span class="o">=</span> <span class="nx">combining</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>

                <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">len</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">self</span><span class="p">.</span><span class="nx">inserted</span><span class="p">[</span><span class="nx">combining</span><span class="p">[</span><span class="nx">i</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
                <span class="p">}</span>

                <span class="nx">handleSuccess</span><span class="p">(</span><span class="nx">o</span><span class="p">);</span>
            <span class="p">};</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">self</span><span class="p">.</span><span class="nx">combine</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="o">!</span><span class="nx">self</span><span class="p">.</span><span class="nx">_combineComplete</span><span class="p">[</span><span class="nx">type</span><span class="p">]))</span> <span class="p">{</span>

            <span class="nx">combining</span> <span class="o">=</span> <span class="p">[];</span>

            <span class="nx">self</span><span class="p">.</span><span class="nx">_combining</span> <span class="o">=</span> <span class="nx">combining</span><span class="p">;</span>
            <span class="nx">s</span> <span class="o">=</span> <span class="nx">self</span><span class="p">.</span><span class="nx">sorted</span><span class="p">;</span>
            <span class="nx">len</span> <span class="o">=</span> <span class="nx">s</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>

            <span class="c1">// the default combo base</span>
            <span class="nx">comboBase</span> <span class="o">=</span> <span class="nx">self</span><span class="p">.</span><span class="nx">comboBase</span><span class="p">;</span>

            <span class="nx">url</span> <span class="o">=</span> <span class="nx">comboBase</span><span class="p">;</span>
            <span class="nx">urls</span> <span class="o">=</span> <span class="p">[];</span>

            <span class="nx">comboSources</span> <span class="o">=</span> <span class="p">{};</span>

            <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">len</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">comboSource</span> <span class="o">=</span> <span class="nx">comboBase</span><span class="p">;</span>
                <span class="nx">m</span> <span class="o">=</span> <span class="nx">self</span><span class="p">.</span><span class="nx">getModule</span><span class="p">(</span><span class="nx">s</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span>
                <span class="nx">groupName</span> <span class="o">=</span> <span class="nx">m</span> <span class="o">&amp;&amp;</span> <span class="nx">m</span><span class="p">.</span><span class="nx">group</span><span class="p">;</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">groupName</span><span class="p">)</span> <span class="p">{</span>

                    <span class="nx">group</span> <span class="o">=</span> <span class="nx">self</span><span class="p">.</span><span class="nx">groups</span><span class="p">[</span><span class="nx">groupName</span><span class="p">];</span>

                    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">group</span><span class="p">.</span><span class="nx">combine</span><span class="p">)</span> <span class="p">{</span>
                        <span class="nx">m</span><span class="p">.</span><span class="nx">combine</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
                        <span class="k">continue</span><span class="p">;</span>
                    <span class="p">}</span>
                    <span class="nx">m</span><span class="p">.</span><span class="nx">combine</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
                    <span class="k">if</span> <span class="p">(</span><span class="nx">group</span><span class="p">.</span><span class="nx">comboBase</span><span class="p">)</span> <span class="p">{</span>
                        <span class="nx">comboSource</span> <span class="o">=</span> <span class="nx">group</span><span class="p">.</span><span class="nx">comboBase</span><span class="p">;</span>
                    <span class="p">}</span>

                    <span class="k">if</span> <span class="p">(</span><span class="nx">group</span><span class="p">.</span><span class="nx">root</span><span class="p">)</span> <span class="p">{</span>
                        <span class="nx">m</span><span class="p">.</span><span class="nx">root</span> <span class="o">=</span> <span class="nx">group</span><span class="p">.</span><span class="nx">root</span><span class="p">;</span>
                    <span class="p">}</span>

                <span class="p">}</span>

                <span class="nx">comboSources</span><span class="p">[</span><span class="nx">comboSource</span><span class="p">]</span> <span class="o">=</span> <span class="nx">comboSources</span><span class="p">[</span><span class="nx">comboSource</span><span class="p">]</span> <span class="o">||</span> <span class="p">[];</span>
                <span class="nx">comboSources</span><span class="p">[</span><span class="nx">comboSource</span><span class="p">].</span><span class="nx">push</span><span class="p">(</span><span class="nx">m</span><span class="p">);</span>
            <span class="p">}</span>

            <span class="k">for</span> <span class="p">(</span><span class="nx">j</span> <span class="k">in</span> <span class="nx">comboSources</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">comboSources</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">(</span><span class="nx">j</span><span class="p">))</span> <span class="p">{</span>
                    <span class="nx">url</span> <span class="o">=</span> <span class="nx">j</span><span class="p">;</span>
                    <span class="nx">mods</span> <span class="o">=</span> <span class="nx">comboSources</span><span class="p">[</span><span class="nx">j</span><span class="p">];</span>
                    <span class="nx">len</span> <span class="o">=</span> <span class="nx">mods</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>

                    <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">len</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
                        <span class="c1">// m = self.getModule(s[i]);</span>
                        <span class="nx">m</span> <span class="o">=</span> <span class="nx">mods</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>

                        <span class="c1">// Do not try to combine non-yui JS unless combo def</span>
                        <span class="c1">// is found</span>
                        <span class="k">if</span> <span class="p">(</span><span class="nx">m</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nx">m</span><span class="p">.</span><span class="nx">type</span> <span class="o">===</span> <span class="nx">type</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nx">m</span><span class="p">.</span><span class="nx">combine</span> <span class="o">||</span> <span class="o">!</span><span class="nx">m</span><span class="p">.</span><span class="nx">ext</span><span class="p">))</span> <span class="p">{</span>

                            <span class="nx">frag</span> <span class="o">=</span> <span class="p">(</span><span class="nx">m</span><span class="p">.</span><span class="nx">root</span> <span class="o">||</span> <span class="nx">self</span><span class="p">.</span><span class="nx">root</span><span class="p">)</span> <span class="o">+</span> <span class="nx">m</span><span class="p">.</span><span class="nx">path</span><span class="p">;</span>

                            <span class="k">if</span> <span class="p">((</span><span class="nx">url</span> <span class="o">!==</span> <span class="nx">j</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nx">i</span> <span class="o">&lt;</span> <span class="p">(</span><span class="nx">len</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span> <span class="o">&amp;&amp;</span>
                            <span class="p">((</span><span class="nx">frag</span><span class="p">.</span><span class="nx">length</span> <span class="o">+</span> <span class="nx">url</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="o">&gt;</span> <span class="nx">self</span><span class="p">.</span><span class="nx">maxURLLength</span><span class="p">))</span> <span class="p">{</span>
                                <span class="nx">urls</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">self</span><span class="p">.</span><span class="nx">_filter</span><span class="p">(</span><span class="nx">url</span><span class="p">));</span>
                                <span class="nx">url</span> <span class="o">=</span> <span class="nx">j</span><span class="p">;</span>
                            <span class="p">}</span>

                            <span class="nx">url</span> <span class="o">+=</span> <span class="nx">frag</span><span class="p">;</span>
                            <span class="k">if</span> <span class="p">(</span><span class="nx">i</span> <span class="o">&lt;</span> <span class="p">(</span><span class="nx">len</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span> <span class="p">{</span>
                                <span class="nx">url</span> <span class="o">+=</span> <span class="s1">&#39;&amp;&#39;</span><span class="p">;</span>
                            <span class="p">}</span>

                            <span class="nx">combining</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">m</span><span class="p">.</span><span class="nx">name</span><span class="p">);</span>
                        <span class="p">}</span>

                    <span class="p">}</span>

                    <span class="k">if</span> <span class="p">(</span><span class="nx">combining</span><span class="p">.</span><span class="nx">length</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nx">url</span> <span class="o">!=</span> <span class="nx">j</span><span class="p">))</span> <span class="p">{</span>
                        <span class="nx">urls</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">self</span><span class="p">.</span><span class="nx">_filter</span><span class="p">(</span><span class="nx">url</span><span class="p">));</span>
                    <span class="p">}</span>
                <span class="p">}</span>
            <span class="p">}</span>

            <span class="k">if</span> <span class="p">(</span><span class="nx">combining</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>

<span class="nx">Y</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Attempting to use combo: &#39;</span> <span class="o">+</span> <span class="nx">combining</span><span class="p">,</span> <span class="s1">&#39;info&#39;</span><span class="p">,</span> <span class="s1">&#39;loader&#39;</span><span class="p">);</span>

                <span class="c1">// if (m.type === CSS) {</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">type</span> <span class="o">===</span> <span class="nx">CSS</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">fn</span> <span class="o">=</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">Get</span><span class="p">.</span><span class="nx">css</span><span class="p">;</span>
                    <span class="nx">attr</span> <span class="o">=</span> <span class="nx">self</span><span class="p">.</span><span class="nx">cssAttributes</span><span class="p">;</span>
                <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                    <span class="nx">fn</span> <span class="o">=</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">Get</span><span class="p">.</span><span class="nx">script</span><span class="p">;</span>
                    <span class="nx">attr</span> <span class="o">=</span> <span class="nx">self</span><span class="p">.</span><span class="nx">jsAttributes</span><span class="p">;</span>
                <span class="p">}</span>

                <span class="nx">fn</span><span class="p">(</span><span class="nx">urls</span><span class="p">,</span> <span class="p">{</span>
                    <span class="nx">data</span><span class="o">:</span> <span class="nx">self</span><span class="p">.</span><span class="nx">_loading</span><span class="p">,</span>
                    <span class="nx">onSuccess</span><span class="o">:</span> <span class="nx">handleCombo</span><span class="p">,</span>
                    <span class="nx">onFailure</span><span class="o">:</span> <span class="nx">self</span><span class="p">.</span><span class="nx">_onFailure</span><span class="p">,</span>
                    <span class="nx">onTimeout</span><span class="o">:</span> <span class="nx">self</span><span class="p">.</span><span class="nx">_onTimeout</span><span class="p">,</span>
                    <span class="nx">insertBefore</span><span class="o">:</span> <span class="nx">self</span><span class="p">.</span><span class="nx">insertBefore</span><span class="p">,</span>
                    <span class="nx">charset</span><span class="o">:</span> <span class="nx">self</span><span class="p">.</span><span class="nx">charset</span><span class="p">,</span>
                    <span class="nx">attributes</span><span class="o">:</span> <span class="nx">attr</span><span class="p">,</span>
                    <span class="nx">timeout</span><span class="o">:</span> <span class="nx">self</span><span class="p">.</span><span class="nx">timeout</span><span class="p">,</span>
                    <span class="nx">autopurge</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
                    <span class="nx">context</span><span class="o">:</span> <span class="nx">self</span>
                <span class="p">});</span>

                <span class="k">return</span><span class="p">;</span>

            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                <span class="nx">self</span><span class="p">.</span><span class="nx">_combineComplete</span><span class="p">[</span><span class="nx">type</span><span class="p">]</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">mname</span><span class="p">)</span> <span class="p">{</span>

            <span class="c1">// if the module that was just loaded isn&#39;t what we were expecting,</span>
            <span class="c1">// continue to wait</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">mname</span> <span class="o">!==</span> <span class="nx">self</span><span class="p">.</span><span class="nx">_loading</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">return</span><span class="p">;</span>
            <span class="p">}</span>

<span class="c1">// Y.log(&quot;loadNext executing, just loaded &quot; + mname + &quot;, &quot; +</span>
<span class="c1">// Y.id, &quot;info&quot;, &quot;loader&quot;);</span>

            <span class="c1">// The global handler that is called when each module is loaded</span>
            <span class="c1">// will pass that module name to this function.  Storing this</span>
            <span class="c1">// data to avoid loading the same module multiple times</span>
            <span class="c1">// centralize this in the callback</span>
            <span class="nx">self</span><span class="p">.</span><span class="nx">inserted</span><span class="p">[</span><span class="nx">mname</span><span class="p">]</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
            <span class="c1">// self.loaded[mname] = true;</span>

            <span class="c1">// provided = self.getProvides(mname);</span>
            <span class="c1">// Y.mix(self.loaded, provided);</span>
            <span class="c1">// Y.mix(self.inserted, provided);</span>

            <span class="k">if</span> <span class="p">(</span><span class="nx">self</span><span class="p">.</span><span class="nx">onProgress</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">self</span><span class="p">.</span><span class="nx">onProgress</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">self</span><span class="p">.</span><span class="nx">context</span><span class="p">,</span> <span class="p">{</span>
                        <span class="nx">name</span><span class="o">:</span> <span class="nx">mname</span><span class="p">,</span>
                        <span class="nx">data</span><span class="o">:</span> <span class="nx">self</span><span class="p">.</span><span class="nx">data</span>
                    <span class="p">});</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="nx">s</span> <span class="o">=</span> <span class="nx">self</span><span class="p">.</span><span class="nx">sorted</span><span class="p">;</span>
        <span class="nx">len</span> <span class="o">=</span> <span class="nx">s</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>

        <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">len</span><span class="p">;</span> <span class="nx">i</span> <span class="o">=</span> <span class="nx">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
            <span class="c1">// this.inserted keeps track of what the loader has loaded.</span>
            <span class="c1">// move on if this item is done.</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">s</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="k">in</span> <span class="nx">self</span><span class="p">.</span><span class="nx">inserted</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">continue</span><span class="p">;</span>
            <span class="p">}</span>

            <span class="c1">// Because rollups will cause multiple load notifications</span>
            <span class="c1">// from Y, loadNext may be called multiple times for</span>
            <span class="c1">// the same module when loading a rollup.  We can safely</span>
            <span class="c1">// skip the subsequent requests</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">s</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">===</span> <span class="nx">self</span><span class="p">.</span><span class="nx">_loading</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">Y</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;still loading &#39;</span> <span class="o">+</span> <span class="nx">s</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;, waiting&#39;</span><span class="p">,</span> <span class="s1">&#39;info&#39;</span><span class="p">,</span> <span class="s1">&#39;loader&#39;</span><span class="p">);</span>
                <span class="k">return</span><span class="p">;</span>
            <span class="p">}</span>

            <span class="c1">// log(&quot;inserting &quot; + s[i]);</span>
            <span class="nx">m</span> <span class="o">=</span> <span class="nx">self</span><span class="p">.</span><span class="nx">getModule</span><span class="p">(</span><span class="nx">s</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span>

            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">m</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">self</span><span class="p">.</span><span class="nx">skipped</span><span class="p">[</span><span class="nx">s</span><span class="p">[</span><span class="nx">i</span><span class="p">]])</span> <span class="p">{</span>
                    <span class="nx">msg</span> <span class="o">=</span> <span class="s1">&#39;Undefined module &#39;</span> <span class="o">+</span> <span class="nx">s</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39; skipped&#39;</span><span class="p">;</span>
                    <span class="nx">Y</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">msg</span><span class="p">,</span> <span class="s1">&#39;warn&#39;</span><span class="p">,</span> <span class="s1">&#39;loader&#39;</span><span class="p">);</span>
                    <span class="c1">// self.inserted[s[i]] = true;</span>
                    <span class="nx">self</span><span class="p">.</span><span class="nx">skipped</span><span class="p">[</span><span class="nx">s</span><span class="p">[</span><span class="nx">i</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
                <span class="p">}</span>
                <span class="k">continue</span><span class="p">;</span>

            <span class="p">}</span>

            <span class="nx">group</span> <span class="o">=</span> <span class="p">(</span><span class="nx">m</span><span class="p">.</span><span class="nx">group</span> <span class="o">&amp;&amp;</span> <span class="nx">self</span><span class="p">.</span><span class="nx">groups</span><span class="p">[</span><span class="nx">m</span><span class="p">.</span><span class="nx">group</span><span class="p">])</span> <span class="o">||</span> <span class="nx">NOT_FOUND</span><span class="p">;</span>

            <span class="c1">// The load type is stored to offer the possibility to load</span>
            <span class="c1">// the css separately from the script.</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">type</span> <span class="o">||</span> <span class="nx">type</span> <span class="o">===</span> <span class="nx">m</span><span class="p">.</span><span class="nx">type</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">self</span><span class="p">.</span><span class="nx">_loading</span> <span class="o">=</span> <span class="nx">s</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
<span class="nx">Y</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;attempting to load &#39;</span> <span class="o">+</span> <span class="nx">s</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;, &#39;</span> <span class="o">+</span> <span class="nx">self</span><span class="p">.</span><span class="nx">base</span><span class="p">,</span> <span class="s1">&#39;info&#39;</span><span class="p">,</span> <span class="s1">&#39;loader&#39;</span><span class="p">);</span>

                <span class="k">if</span> <span class="p">(</span><span class="nx">m</span><span class="p">.</span><span class="nx">type</span> <span class="o">===</span> <span class="nx">CSS</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">fn</span> <span class="o">=</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">Get</span><span class="p">.</span><span class="nx">css</span><span class="p">;</span>
                    <span class="nx">attr</span> <span class="o">=</span> <span class="nx">self</span><span class="p">.</span><span class="nx">cssAttributes</span><span class="p">;</span>
                <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                    <span class="nx">fn</span> <span class="o">=</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">Get</span><span class="p">.</span><span class="nx">script</span><span class="p">;</span>
                    <span class="nx">attr</span> <span class="o">=</span> <span class="nx">self</span><span class="p">.</span><span class="nx">jsAttributes</span><span class="p">;</span>
                <span class="p">}</span>

                <span class="nx">url</span> <span class="o">=</span> <span class="p">(</span><span class="nx">m</span><span class="p">.</span><span class="nx">fullpath</span><span class="p">)</span> <span class="o">?</span> <span class="nx">self</span><span class="p">.</span><span class="nx">_filter</span><span class="p">(</span><span class="nx">m</span><span class="p">.</span><span class="nx">fullpath</span><span class="p">,</span> <span class="nx">s</span><span class="p">[</span><span class="nx">i</span><span class="p">])</span> <span class="o">:</span>
                      <span class="nx">self</span><span class="p">.</span><span class="nx">_url</span><span class="p">(</span><span class="nx">m</span><span class="p">.</span><span class="nx">path</span><span class="p">,</span> <span class="nx">s</span><span class="p">[</span><span class="nx">i</span><span class="p">],</span> <span class="nx">group</span><span class="p">.</span><span class="nx">base</span> <span class="o">||</span> <span class="nx">m</span><span class="p">.</span><span class="nx">base</span><span class="p">);</span>

                <span class="nx">fn</span><span class="p">(</span><span class="nx">url</span><span class="p">,</span> <span class="p">{</span>
                    <span class="nx">data</span><span class="o">:</span> <span class="nx">s</span><span class="p">[</span><span class="nx">i</span><span class="p">],</span>
                    <span class="nx">onSuccess</span><span class="o">:</span> <span class="nx">handleSuccess</span><span class="p">,</span>
                    <span class="nx">insertBefore</span><span class="o">:</span> <span class="nx">self</span><span class="p">.</span><span class="nx">insertBefore</span><span class="p">,</span>
                    <span class="nx">charset</span><span class="o">:</span> <span class="nx">self</span><span class="p">.</span><span class="nx">charset</span><span class="p">,</span>
                    <span class="nx">attributes</span><span class="o">:</span> <span class="nx">attr</span><span class="p">,</span>
                    <span class="nx">onFailure</span><span class="o">:</span> <span class="nx">self</span><span class="p">.</span><span class="nx">_onFailure</span><span class="p">,</span>
                    <span class="nx">onTimeout</span><span class="o">:</span> <span class="nx">self</span><span class="p">.</span><span class="nx">_onTimeout</span><span class="p">,</span>
                    <span class="nx">timeout</span><span class="o">:</span> <span class="nx">self</span><span class="p">.</span><span class="nx">timeout</span><span class="p">,</span>
                    <span class="nx">autopurge</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
                    <span class="nx">context</span><span class="o">:</span> <span class="nx">self</span>
                <span class="p">});</span>

                <span class="k">return</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="c1">// we are finished</span>
        <span class="nx">self</span><span class="p">.</span><span class="nx">_loading</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>

        <span class="nx">fn</span> <span class="o">=</span> <span class="nx">self</span><span class="p">.</span><span class="nx">_internalCallback</span><span class="p">;</span>

        <span class="c1">// internal callback for loading css first</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">fn</span><span class="p">)</span> <span class="p">{</span>
            <span class="c1">// Y.log(&#39;loader internal&#39;);</span>
            <span class="nx">self</span><span class="p">.</span><span class="nx">_internalCallback</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
            <span class="nx">fn</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">self</span><span class="p">);</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="c1">// Y.log(&#39;loader complete&#39;);</span>
            <span class="nx">self</span><span class="p">.</span><span class="nx">_onSuccess</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">},</span>

    <span class="cm">/**</span>
<span class="cm">     * Apply filter defined for this instance to a url/path</span>
<span class="cm">     * method _filter</span>
<span class="cm">     * @param {string} u the string to filter.</span>
<span class="cm">     * @param {string} name the name of the module, if we are processing</span>
<span class="cm">     * a single module as opposed to a combined url.</span>
<span class="cm">     * @return {string} the filtered string.</span>
<span class="cm">     * @private</span>
<span class="cm">     */</span>
    <span class="nx">_filter</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">u</span><span class="p">,</span> <span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">f</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">filter</span><span class="p">,</span>
            <span class="nx">hasFilter</span> <span class="o">=</span> <span class="nx">name</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nx">name</span> <span class="k">in</span> <span class="k">this</span><span class="p">.</span><span class="nx">filters</span><span class="p">),</span>
            <span class="nx">modFilter</span> <span class="o">=</span> <span class="nx">hasFilter</span> <span class="o">&amp;&amp;</span> <span class="k">this</span><span class="p">.</span><span class="nx">filters</span><span class="p">[</span><span class="nx">name</span><span class="p">];</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">u</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">hasFilter</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">f</span> <span class="o">=</span> <span class="p">(</span><span class="nx">L</span><span class="p">.</span><span class="nx">isString</span><span class="p">(</span><span class="nx">modFilter</span><span class="p">))</span> <span class="o">?</span>
                    <span class="k">this</span><span class="p">.</span><span class="nx">FILTER_DEFS</span><span class="p">[</span><span class="nx">modFilter</span><span class="p">.</span><span class="nx">toUpperCase</span><span class="p">()]</span> <span class="o">||</span> <span class="kc">null</span> <span class="o">:</span>
                    <span class="nx">modFilter</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">f</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">u</span> <span class="o">=</span> <span class="nx">u</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="k">new</span> <span class="nb">RegExp</span><span class="p">(</span><span class="nx">f</span><span class="p">.</span><span class="nx">searchExp</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">),</span> <span class="nx">f</span><span class="p">.</span><span class="nx">replaceStr</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="nx">u</span><span class="p">;</span>
    <span class="p">},</span>

    <span class="cm">/**</span>
<span class="cm">     * Generates the full url for a module</span>
<span class="cm">     * method _url</span>
<span class="cm">     * @param {string} path the path fragment.</span>
<span class="cm">     * @return {string} the full url.</span>
<span class="cm">     * @private</span>
<span class="cm">     */</span>
    <span class="nx">_url</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">path</span><span class="p">,</span> <span class="nx">name</span><span class="p">,</span> <span class="nx">base</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">_filter</span><span class="p">((</span><span class="nx">base</span> <span class="o">||</span> <span class="k">this</span><span class="p">.</span><span class="nx">base</span> <span class="o">||</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="nx">path</span><span class="p">,</span> <span class="nx">name</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">};</span>




<span class="p">},</span> <span class="s1">&#39;3.3.0&#39;</span> <span class="p">,{</span><span class="nx">requires</span><span class="o">:</span><span class="p">[</span><span class="s1">&#39;get&#39;</span><span class="p">]});</span>

<span class="nx">YUI</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="s1">&#39;loader-rollup&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">Y</span><span class="p">)</span> <span class="p">{</span>

<span class="cm">/**</span>
<span class="cm"> * Optional automatic rollup logic for reducing http connections</span>
<span class="cm"> * when not using a combo service.</span>
<span class="cm"> * @module loader</span>
<span class="cm"> * @submodule rollup</span>
<span class="cm"> */</span>

<span class="cm">/**</span>
<span class="cm"> * Look for rollup packages to determine if all of the modules a</span>
<span class="cm"> * rollup supersedes are required.  If so, include the rollup to</span>
<span class="cm"> * help reduce the total number of connections required.  Called</span>
<span class="cm"> * by calculate().  This is an optional feature, and requires the</span>
<span class="cm"> * appropriate submodule to function.</span>
<span class="cm"> * @method _rollup</span>
<span class="cm"> * @for Loader</span>
<span class="cm"> * @private</span>
<span class="cm"> */</span>
<span class="nx">Y</span><span class="p">.</span><span class="nx">Loader</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">_rollup</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">j</span><span class="p">,</span> <span class="nx">m</span><span class="p">,</span> <span class="nx">s</span><span class="p">,</span> <span class="nx">r</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">required</span><span class="p">,</span> <span class="nx">roll</span><span class="p">,</span>
        <span class="nx">info</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">moduleInfo</span><span class="p">,</span> <span class="nx">rolled</span><span class="p">,</span> <span class="nx">c</span><span class="p">,</span> <span class="nx">smod</span><span class="p">;</span>

    <span class="c1">// find and cache rollup modules</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">dirty</span> <span class="o">||</span> <span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">rollups</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">rollups</span> <span class="o">=</span> <span class="p">{};</span>
        <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="k">in</span> <span class="nx">info</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">info</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">(</span><span class="nx">i</span><span class="p">))</span> <span class="p">{</span>
                <span class="nx">m</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">getModule</span><span class="p">(</span><span class="nx">i</span><span class="p">);</span>
                <span class="c1">// if (m &amp;&amp; m.rollup &amp;&amp; m.supersedes) {</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">m</span> <span class="o">&amp;&amp;</span> <span class="nx">m</span><span class="p">.</span><span class="nx">rollup</span><span class="p">)</span> <span class="p">{</span>
                    <span class="k">this</span><span class="p">.</span><span class="nx">rollups</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="nx">m</span><span class="p">;</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="k">this</span><span class="p">.</span><span class="nx">forceMap</span> <span class="o">=</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">force</span><span class="p">)</span> <span class="o">?</span> <span class="nx">Y</span><span class="p">.</span><span class="nb">Array</span><span class="p">.</span><span class="nx">hash</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">force</span><span class="p">)</span> <span class="o">:</span> <span class="p">{};</span>
    <span class="p">}</span>

    <span class="c1">// make as many passes as needed to pick up rollup rollups</span>
    <span class="k">for</span> <span class="p">(;;)</span> <span class="p">{</span>
        <span class="nx">rolled</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>

        <span class="c1">// go through the rollup candidates</span>
        <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="k">in</span> <span class="k">this</span><span class="p">.</span><span class="nx">rollups</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">rollups</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">(</span><span class="nx">i</span><span class="p">))</span> <span class="p">{</span>
                <span class="c1">// there can be only one, unless forced</span>
                <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">r</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="p">((</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">loaded</span><span class="p">[</span><span class="nx">i</span><span class="p">])</span> <span class="o">||</span> <span class="k">this</span><span class="p">.</span><span class="nx">forceMap</span><span class="p">[</span><span class="nx">i</span><span class="p">]))</span> <span class="p">{</span>
                    <span class="nx">m</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">getModule</span><span class="p">(</span><span class="nx">i</span><span class="p">);</span>
                    <span class="nx">s</span> <span class="o">=</span> <span class="nx">m</span><span class="p">.</span><span class="nx">supersedes</span> <span class="o">||</span> <span class="p">[];</span>
                    <span class="nx">roll</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>

                    <span class="c1">// @TODO remove continue</span>
                    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">m</span><span class="p">.</span><span class="nx">rollup</span><span class="p">)</span> <span class="p">{</span>
                        <span class="k">continue</span><span class="p">;</span>
                    <span class="p">}</span>

                    <span class="nx">c</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

                    <span class="c1">// check the threshold</span>
                    <span class="k">for</span> <span class="p">(</span><span class="nx">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">j</span> <span class="o">&lt;</span> <span class="nx">s</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
                        <span class="nx">smod</span> <span class="o">=</span> <span class="nx">info</span><span class="p">[</span><span class="nx">s</span><span class="p">[</span><span class="nx">j</span><span class="p">]];</span>

                        <span class="c1">// if the superseded module is loaded, we can&#39;t</span>
                        <span class="c1">// load the rollup unless it has been forced.</span>
                        <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">loaded</span><span class="p">[</span><span class="nx">s</span><span class="p">[</span><span class="nx">j</span><span class="p">]]</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">forceMap</span><span class="p">[</span><span class="nx">s</span><span class="p">[</span><span class="nx">j</span><span class="p">]])</span> <span class="p">{</span>
                            <span class="nx">roll</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
                            <span class="k">break</span><span class="p">;</span>
                        <span class="c1">// increment the counter if this module is required.</span>
                        <span class="c1">// if we are beyond the rollup threshold, we will</span>
                        <span class="c1">// use the rollup module</span>
                        <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">r</span><span class="p">[</span><span class="nx">s</span><span class="p">[</span><span class="nx">j</span><span class="p">]]</span> <span class="o">&amp;&amp;</span> <span class="nx">m</span><span class="p">.</span><span class="nx">type</span> <span class="o">==</span> <span class="nx">smod</span><span class="p">.</span><span class="nx">type</span><span class="p">)</span> <span class="p">{</span>
                            <span class="nx">c</span><span class="o">++</span><span class="p">;</span>
                            <span class="c1">// Y.log(&quot;adding to thresh: &quot; + c + &quot;, &quot; + s[j]);</span>
                            <span class="nx">roll</span> <span class="o">=</span> <span class="p">(</span><span class="nx">c</span> <span class="o">&gt;=</span> <span class="nx">m</span><span class="p">.</span><span class="nx">rollup</span><span class="p">);</span>
                            <span class="k">if</span> <span class="p">(</span><span class="nx">roll</span><span class="p">)</span> <span class="p">{</span>
                                <span class="c1">// Y.log(&quot;over thresh &quot; + c + &quot;, &quot; + s[j]);</span>
                                <span class="k">break</span><span class="p">;</span>
                            <span class="p">}</span>
                        <span class="p">}</span>
                    <span class="p">}</span>

                    <span class="k">if</span> <span class="p">(</span><span class="nx">roll</span><span class="p">)</span> <span class="p">{</span>
                        <span class="c1">// Y.log(&quot;adding rollup: &quot; +  i);</span>
                        <span class="c1">// add the rollup</span>
                        <span class="nx">r</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
                        <span class="nx">rolled</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>

                        <span class="c1">// expand the rollup&#39;s dependencies</span>
                        <span class="k">this</span><span class="p">.</span><span class="nx">getRequires</span><span class="p">(</span><span class="nx">m</span><span class="p">);</span>
                    <span class="p">}</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="c1">// if we made it here w/o rolling up something, we are done</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">rolled</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">break</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">};</span>



<span class="p">},</span> <span class="s1">&#39;3.3.0&#39;</span> <span class="p">,{</span><span class="nx">requires</span><span class="o">:</span><span class="p">[</span><span class="s1">&#39;loader-base&#39;</span><span class="p">]});</span>

<span class="nx">YUI</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="s1">&#39;loader-yui3&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">Y</span><span class="p">)</span> <span class="p">{</span>

<span class="cm">/* This file is auto-generated by src/loader/meta_join.py */</span>

<span class="cm">/**</span>
<span class="cm"> * YUI 3 module metadata</span>
<span class="cm"> * @module loader</span>
<span class="cm"> * @submodule yui3</span>
<span class="cm"> */</span>
<span class="nx">YUI</span><span class="p">.</span><span class="nx">Env</span><span class="p">[</span><span class="nx">Y</span><span class="p">.</span><span class="nx">version</span><span class="p">].</span><span class="nx">modules</span> <span class="o">=</span> <span class="nx">YUI</span><span class="p">.</span><span class="nx">Env</span><span class="p">[</span><span class="nx">Y</span><span class="p">.</span><span class="nx">version</span><span class="p">].</span><span class="nx">modules</span> <span class="o">||</span> <span class="p">{</span>
    <span class="s2">&quot;anim&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;submodules&quot;</span><span class="o">:</span> <span class="p">{</span>
            <span class="s2">&quot;anim-base&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;base-base&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;node-style&quot;</span>
                <span class="p">]</span>
            <span class="p">},</span> 
            <span class="s2">&quot;anim-color&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;anim-base&quot;</span>
                <span class="p">]</span>
            <span class="p">},</span> 
            <span class="s2">&quot;anim-curve&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;anim-xy&quot;</span>
                <span class="p">]</span>
            <span class="p">},</span> 
            <span class="s2">&quot;anim-easing&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;anim-base&quot;</span>
                <span class="p">]</span>
            <span class="p">},</span> 
            <span class="s2">&quot;anim-node-plugin&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;node-pluginhost&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;anim-base&quot;</span>
                <span class="p">]</span>
            <span class="p">},</span> 
            <span class="s2">&quot;anim-scroll&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;anim-base&quot;</span>
                <span class="p">]</span>
            <span class="p">},</span> 
            <span class="s2">&quot;anim-xy&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;anim-base&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;node-screen&quot;</span>
                <span class="p">]</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">},</span> 
    <span class="s2">&quot;arraysort&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
            <span class="s2">&quot;yui-base&quot;</span>
        <span class="p">]</span>
    <span class="p">},</span> 
    <span class="s2">&quot;async-queue&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
            <span class="s2">&quot;event-custom&quot;</span>
        <span class="p">]</span>
    <span class="p">},</span> 
    <span class="s2">&quot;attribute&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;submodules&quot;</span><span class="o">:</span> <span class="p">{</span>
            <span class="s2">&quot;attribute-base&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;event-custom&quot;</span>
                <span class="p">]</span>
            <span class="p">},</span> 
            <span class="s2">&quot;attribute-complex&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;attribute-base&quot;</span>
                <span class="p">]</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">},</span> 
    <span class="s2">&quot;autocomplete&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;submodules&quot;</span><span class="o">:</span> <span class="p">{</span>
            <span class="s2">&quot;autocomplete-base&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;optional&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;autocomplete-sources&quot;</span>
                <span class="p">],</span> 
                <span class="s2">&quot;plugins&quot;</span><span class="o">:</span> <span class="p">{</span>
                    <span class="s2">&quot;autocomplete-filters&quot;</span><span class="o">:</span> <span class="p">{</span>
                        <span class="s2">&quot;path&quot;</span><span class="o">:</span> <span class="s2">&quot;autocomplete/autocomplete-filters-min.js&quot;</span><span class="p">,</span> 
                        <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                            <span class="s2">&quot;array-extras&quot;</span><span class="p">,</span> 
                            <span class="s2">&quot;text-wordbreak&quot;</span>
                        <span class="p">]</span>
                    <span class="p">},</span> 
                    <span class="s2">&quot;autocomplete-filters-accentfold&quot;</span><span class="o">:</span> <span class="p">{</span>
                        <span class="s2">&quot;path&quot;</span><span class="o">:</span> <span class="s2">&quot;autocomplete/autocomplete-filters-accentfold-min.js&quot;</span><span class="p">,</span> 
                        <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                            <span class="s2">&quot;array-extras&quot;</span><span class="p">,</span> 
                            <span class="s2">&quot;text-accentfold&quot;</span><span class="p">,</span> 
                            <span class="s2">&quot;text-wordbreak&quot;</span>
                        <span class="p">]</span>
                    <span class="p">},</span> 
                    <span class="s2">&quot;autocomplete-highlighters&quot;</span><span class="o">:</span> <span class="p">{</span>
                        <span class="s2">&quot;path&quot;</span><span class="o">:</span> <span class="s2">&quot;autocomplete/autocomplete-highlighters-min.js&quot;</span><span class="p">,</span> 
                        <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                            <span class="s2">&quot;array-extras&quot;</span><span class="p">,</span> 
                            <span class="s2">&quot;highlight-base&quot;</span>
                        <span class="p">]</span>
                    <span class="p">},</span> 
                    <span class="s2">&quot;autocomplete-highlighters-accentfold&quot;</span><span class="o">:</span> <span class="p">{</span>
                        <span class="s2">&quot;path&quot;</span><span class="o">:</span> <span class="s2">&quot;autocomplete/autocomplete-highlighters-accentfold-min.js&quot;</span><span class="p">,</span> 
                        <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                            <span class="s2">&quot;array-extras&quot;</span><span class="p">,</span> 
                            <span class="s2">&quot;highlight-accentfold&quot;</span>
                        <span class="p">]</span>
                    <span class="p">}</span>
                <span class="p">},</span> 
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;array-extras&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;base-build&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;escape&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;event-valuechange&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;node-base&quot;</span>
                <span class="p">]</span>
            <span class="p">},</span> 
            <span class="s2">&quot;autocomplete-list&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;after&quot;</span><span class="o">:</span> <span class="s2">&quot;autocomplete-sources&quot;</span><span class="p">,</span> 
                <span class="s2">&quot;lang&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;en&quot;</span>
                <span class="p">],</span> 
                <span class="s2">&quot;plugins&quot;</span><span class="o">:</span> <span class="p">{</span>
                    <span class="s2">&quot;autocomplete-list-keys&quot;</span><span class="o">:</span> <span class="p">{</span>
                        <span class="s2">&quot;condition&quot;</span><span class="o">:</span> <span class="p">{</span>
                            <span class="s2">&quot;test&quot;</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">Y</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// Only add keyboard support to autocomplete-list if this doesn&#39;t appear to</span>
    <span class="c1">// be an iOS or Android-based mobile device.</span>
    <span class="c1">//</span>
    <span class="c1">// There&#39;s currently no feasible way to actually detect whether a device has</span>
    <span class="c1">// a hardware keyboard, so this sniff will have to do. It can easily be</span>
    <span class="c1">// overridden by manually loading the autocomplete-list-keys module.</span>
    <span class="c1">//</span>
    <span class="c1">// Worth noting: even though iOS supports bluetooth keyboards, Mobile Safari</span>
    <span class="c1">// doesn&#39;t fire the keyboard events used by AutoCompleteList, so there&#39;s</span>
    <span class="c1">// no point loading the -keys module even when a bluetooth keyboard may be</span>
    <span class="c1">// available.</span>
    <span class="k">return</span> <span class="o">!</span><span class="p">(</span><span class="nx">Y</span><span class="p">.</span><span class="nx">UA</span><span class="p">.</span><span class="nx">ios</span> <span class="o">||</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">UA</span><span class="p">.</span><span class="nx">android</span><span class="p">);</span>
<span class="p">},</span> 
                            <span class="s2">&quot;trigger&quot;</span><span class="o">:</span> <span class="s2">&quot;autocomplete-list&quot;</span>
                        <span class="p">},</span> 
                        <span class="s2">&quot;path&quot;</span><span class="o">:</span> <span class="s2">&quot;autocomplete/autocomplete-list-keys-min.js&quot;</span><span class="p">,</span> 
                        <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                            <span class="s2">&quot;autocomplete-list&quot;</span><span class="p">,</span> 
                            <span class="s2">&quot;base-build&quot;</span>
                        <span class="p">]</span>
                    <span class="p">},</span> 
                    <span class="s2">&quot;autocomplete-plugin&quot;</span><span class="o">:</span> <span class="p">{</span>
                        <span class="s2">&quot;path&quot;</span><span class="o">:</span> <span class="s2">&quot;autocomplete/autocomplete-plugin-min.js&quot;</span><span class="p">,</span> 
                        <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                            <span class="s2">&quot;autocomplete-list&quot;</span><span class="p">,</span> 
                            <span class="s2">&quot;node-pluginhost&quot;</span>
                        <span class="p">]</span>
                    <span class="p">}</span>
                <span class="p">},</span> 
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;autocomplete-base&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;selector-css3&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;widget&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;widget-position&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;widget-position-align&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;widget-stack&quot;</span>
                <span class="p">],</span> 
                <span class="s2">&quot;skinnable&quot;</span><span class="o">:</span> <span class="kc">true</span>
            <span class="p">},</span> 
            <span class="s2">&quot;autocomplete-sources&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;optional&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;io-base&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;json-parse&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;jsonp&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;yql&quot;</span>
                <span class="p">],</span> 
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;autocomplete-base&quot;</span>
                <span class="p">]</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">},</span> 
    <span class="s2">&quot;base&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;submodules&quot;</span><span class="o">:</span> <span class="p">{</span>
            <span class="s2">&quot;base-base&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;after&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;attribute-complex&quot;</span>
                <span class="p">],</span> 
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;attribute-base&quot;</span>
                <span class="p">]</span>
            <span class="p">},</span> 
            <span class="s2">&quot;base-build&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;base-base&quot;</span>
                <span class="p">]</span>
            <span class="p">},</span> 
            <span class="s2">&quot;base-pluginhost&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;base-base&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;pluginhost&quot;</span>
                <span class="p">]</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">},</span> 
    <span class="s2">&quot;cache&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;submodules&quot;</span><span class="o">:</span> <span class="p">{</span>
            <span class="s2">&quot;cache-base&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;base&quot;</span>
                <span class="p">]</span>
            <span class="p">},</span> 
            <span class="s2">&quot;cache-offline&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;cache-base&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;json&quot;</span>
                <span class="p">]</span>
            <span class="p">},</span> 
            <span class="s2">&quot;cache-plugin&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;plugin&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;cache-base&quot;</span>
                <span class="p">]</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">},</span> 
    <span class="s2">&quot;charts&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
            <span class="s2">&quot;dom&quot;</span><span class="p">,</span> 
            <span class="s2">&quot;datatype&quot;</span><span class="p">,</span> 
            <span class="s2">&quot;event-custom&quot;</span><span class="p">,</span> 
            <span class="s2">&quot;event-mouseenter&quot;</span><span class="p">,</span> 
            <span class="s2">&quot;widget&quot;</span><span class="p">,</span> 
            <span class="s2">&quot;widget-position&quot;</span><span class="p">,</span> 
            <span class="s2">&quot;widget-stack&quot;</span>
        <span class="p">]</span>
    <span class="p">},</span> 
    <span class="s2">&quot;classnamemanager&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
            <span class="s2">&quot;yui-base&quot;</span>
        <span class="p">]</span>
    <span class="p">},</span> 
    <span class="s2">&quot;collection&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;submodules&quot;</span><span class="o">:</span> <span class="p">{</span>
            <span class="s2">&quot;array-extras&quot;</span><span class="o">:</span> <span class="p">{},</span> 
            <span class="s2">&quot;array-invoke&quot;</span><span class="o">:</span> <span class="p">{},</span> 
            <span class="s2">&quot;arraylist&quot;</span><span class="o">:</span> <span class="p">{},</span> 
            <span class="s2">&quot;arraylist-add&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;arraylist&quot;</span>
                <span class="p">]</span>
            <span class="p">},</span> 
            <span class="s2">&quot;arraylist-filter&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;arraylist&quot;</span>
                <span class="p">]</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">},</span> 
    <span class="s2">&quot;compat&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
            <span class="s2">&quot;event-base&quot;</span><span class="p">,</span> 
            <span class="s2">&quot;dom&quot;</span><span class="p">,</span> 
            <span class="s2">&quot;dump&quot;</span><span class="p">,</span> 
            <span class="s2">&quot;substitute&quot;</span>
        <span class="p">]</span>
    <span class="p">},</span> 
    <span class="s2">&quot;console&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;lang&quot;</span><span class="o">:</span> <span class="p">[</span>
            <span class="s2">&quot;en&quot;</span><span class="p">,</span> 
            <span class="s2">&quot;es&quot;</span>
        <span class="p">],</span> 
        <span class="s2">&quot;plugins&quot;</span><span class="o">:</span> <span class="p">{</span>
            <span class="s2">&quot;console-filters&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;plugin&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;console&quot;</span>
                <span class="p">],</span> 
                <span class="s2">&quot;skinnable&quot;</span><span class="o">:</span> <span class="kc">true</span>
            <span class="p">}</span>
        <span class="p">},</span> 
        <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
            <span class="s2">&quot;yui-log&quot;</span><span class="p">,</span> 
            <span class="s2">&quot;widget&quot;</span><span class="p">,</span> 
            <span class="s2">&quot;substitute&quot;</span>
        <span class="p">],</span> 
        <span class="s2">&quot;skinnable&quot;</span><span class="o">:</span> <span class="kc">true</span>
    <span class="p">},</span> 
    <span class="s2">&quot;cookie&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
            <span class="s2">&quot;yui-base&quot;</span>
        <span class="p">]</span>
    <span class="p">},</span> 
    <span class="s2">&quot;cssbase&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;after&quot;</span><span class="o">:</span> <span class="p">[</span>
            <span class="s2">&quot;cssreset&quot;</span><span class="p">,</span> 
            <span class="s2">&quot;cssfonts&quot;</span><span class="p">,</span> 
            <span class="s2">&quot;cssgrids&quot;</span><span class="p">,</span> 
            <span class="s2">&quot;cssreset-context&quot;</span><span class="p">,</span> 
            <span class="s2">&quot;cssfonts-context&quot;</span><span class="p">,</span> 
            <span class="s2">&quot;cssgrids-context&quot;</span>
        <span class="p">],</span> 
        <span class="s2">&quot;path&quot;</span><span class="o">:</span> <span class="s2">&quot;cssbase/base-min.css&quot;</span><span class="p">,</span> 
        <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;css&quot;</span>
    <span class="p">},</span> 
    <span class="s2">&quot;cssbase-context&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;after&quot;</span><span class="o">:</span> <span class="p">[</span>
            <span class="s2">&quot;cssreset&quot;</span><span class="p">,</span> 
            <span class="s2">&quot;cssfonts&quot;</span><span class="p">,</span> 
            <span class="s2">&quot;cssgrids&quot;</span><span class="p">,</span> 
            <span class="s2">&quot;cssreset-context&quot;</span><span class="p">,</span> 
            <span class="s2">&quot;cssfonts-context&quot;</span><span class="p">,</span> 
            <span class="s2">&quot;cssgrids-context&quot;</span>
        <span class="p">],</span> 
        <span class="s2">&quot;path&quot;</span><span class="o">:</span> <span class="s2">&quot;cssbase/base-context-min.css&quot;</span><span class="p">,</span> 
        <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;css&quot;</span>
    <span class="p">},</span> 
    <span class="s2">&quot;cssfonts&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;path&quot;</span><span class="o">:</span> <span class="s2">&quot;cssfonts/fonts-min.css&quot;</span><span class="p">,</span> 
        <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;css&quot;</span>
    <span class="p">},</span> 
    <span class="s2">&quot;cssfonts-context&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;path&quot;</span><span class="o">:</span> <span class="s2">&quot;cssfonts/fonts-context-min.css&quot;</span><span class="p">,</span> 
        <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;css&quot;</span>
    <span class="p">},</span> 
    <span class="s2">&quot;cssgrids&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;optional&quot;</span><span class="o">:</span> <span class="p">[</span>
            <span class="s2">&quot;cssreset&quot;</span><span class="p">,</span> 
            <span class="s2">&quot;cssfonts&quot;</span>
        <span class="p">],</span> 
        <span class="s2">&quot;path&quot;</span><span class="o">:</span> <span class="s2">&quot;cssgrids/grids-min.css&quot;</span><span class="p">,</span> 
        <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;css&quot;</span>
    <span class="p">},</span> 
    <span class="s2">&quot;cssgrids-context-deprecated&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;optional&quot;</span><span class="o">:</span> <span class="p">[</span>
            <span class="s2">&quot;cssreset-context&quot;</span>
        <span class="p">],</span> 
        <span class="s2">&quot;path&quot;</span><span class="o">:</span> <span class="s2">&quot;cssgrids-deprecated/grids-context-min.css&quot;</span><span class="p">,</span> 
        <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
            <span class="s2">&quot;cssfonts-context&quot;</span>
        <span class="p">],</span> 
        <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;css&quot;</span>
    <span class="p">},</span> 
    <span class="s2">&quot;cssgrids-deprecated&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;optional&quot;</span><span class="o">:</span> <span class="p">[</span>
            <span class="s2">&quot;cssreset&quot;</span>
        <span class="p">],</span> 
        <span class="s2">&quot;path&quot;</span><span class="o">:</span> <span class="s2">&quot;cssgrids-deprecated/grids-min.css&quot;</span><span class="p">,</span> 
        <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
            <span class="s2">&quot;cssfonts&quot;</span>
        <span class="p">],</span> 
        <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;css&quot;</span>
    <span class="p">},</span> 
    <span class="s2">&quot;cssreset&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;path&quot;</span><span class="o">:</span> <span class="s2">&quot;cssreset/reset-min.css&quot;</span><span class="p">,</span> 
        <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;css&quot;</span>
    <span class="p">},</span> 
    <span class="s2">&quot;cssreset-context&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;path&quot;</span><span class="o">:</span> <span class="s2">&quot;cssreset/reset-context-min.css&quot;</span><span class="p">,</span> 
        <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;css&quot;</span>
    <span class="p">},</span> 
    <span class="s2">&quot;dataschema&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;submodules&quot;</span><span class="o">:</span> <span class="p">{</span>
            <span class="s2">&quot;dataschema-array&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;dataschema-base&quot;</span>
                <span class="p">]</span>
            <span class="p">},</span> 
            <span class="s2">&quot;dataschema-base&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;base&quot;</span>
                <span class="p">]</span>
            <span class="p">},</span> 
            <span class="s2">&quot;dataschema-json&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;dataschema-base&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;json&quot;</span>
                <span class="p">]</span>
            <span class="p">},</span> 
            <span class="s2">&quot;dataschema-text&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;dataschema-base&quot;</span>
                <span class="p">]</span>
            <span class="p">},</span> 
            <span class="s2">&quot;dataschema-xml&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;dataschema-base&quot;</span>
                <span class="p">]</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">},</span> 
    <span class="s2">&quot;datasource&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;submodules&quot;</span><span class="o">:</span> <span class="p">{</span>
            <span class="s2">&quot;datasource-arrayschema&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;datasource-local&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;plugin&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;dataschema-array&quot;</span>
                <span class="p">]</span>
            <span class="p">},</span> 
            <span class="s2">&quot;datasource-cache&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;datasource-local&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;cache-base&quot;</span>
                <span class="p">]</span>
            <span class="p">},</span> 
            <span class="s2">&quot;datasource-function&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;datasource-local&quot;</span>
                <span class="p">]</span>
            <span class="p">},</span> 
            <span class="s2">&quot;datasource-get&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;datasource-local&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;get&quot;</span>
                <span class="p">]</span>
            <span class="p">},</span> 
            <span class="s2">&quot;datasource-io&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;datasource-local&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;io-base&quot;</span>
                <span class="p">]</span>
            <span class="p">},</span> 
            <span class="s2">&quot;datasource-jsonschema&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;datasource-local&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;plugin&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;dataschema-json&quot;</span>
                <span class="p">]</span>
            <span class="p">},</span> 
            <span class="s2">&quot;datasource-local&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;base&quot;</span>
                <span class="p">]</span>
            <span class="p">},</span> 
            <span class="s2">&quot;datasource-polling&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;datasource-local&quot;</span>
                <span class="p">]</span>
            <span class="p">},</span> 
            <span class="s2">&quot;datasource-textschema&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;datasource-local&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;plugin&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;dataschema-text&quot;</span>
                <span class="p">]</span>
            <span class="p">},</span> 
            <span class="s2">&quot;datasource-xmlschema&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;datasource-local&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;plugin&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;dataschema-xml&quot;</span>
                <span class="p">]</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">},</span> 
    <span class="s2">&quot;datatable&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;submodules&quot;</span><span class="o">:</span> <span class="p">{</span>
            <span class="s2">&quot;datatable-base&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;recordset-base&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;widget&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;substitute&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;event-mouseenter&quot;</span>
                <span class="p">],</span> 
                <span class="s2">&quot;skinnable&quot;</span><span class="o">:</span> <span class="kc">true</span>
            <span class="p">},</span> 
            <span class="s2">&quot;datatable-datasource&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;datatable-base&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;plugin&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;datasource-local&quot;</span>
                <span class="p">]</span>
            <span class="p">},</span> 
            <span class="s2">&quot;datatable-scroll&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;datatable-base&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;plugin&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;stylesheet&quot;</span>
                <span class="p">]</span>
            <span class="p">},</span> 
            <span class="s2">&quot;datatable-sort&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;lang&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;en&quot;</span>
                <span class="p">],</span> 
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;datatable-base&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;plugin&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;recordset-sort&quot;</span>
                <span class="p">]</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">},</span> 
    <span class="s2">&quot;datatype&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;submodules&quot;</span><span class="o">:</span> <span class="p">{</span>
            <span class="s2">&quot;datatype-date&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;lang&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;ar&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;ar-JO&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;ca&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;ca-ES&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;da&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;da-DK&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;de&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;de-AT&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;de-DE&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;el&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;el-GR&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;en&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;en-AU&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;en-CA&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;en-GB&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;en-IE&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;en-IN&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;en-JO&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;en-MY&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;en-NZ&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;en-PH&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;en-SG&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;en-US&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;es&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;es-AR&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;es-BO&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;es-CL&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;es-CO&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;es-EC&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;es-ES&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;es-MX&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;es-PE&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;es-PY&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;es-US&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;es-UY&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;es-VE&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;fi&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;fi-FI&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;fr&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;fr-BE&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;fr-CA&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;fr-FR&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;hi&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;hi-IN&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;id&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;id-ID&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;it&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;it-IT&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;ja&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;ja-JP&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;ko&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;ko-KR&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;ms&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;ms-MY&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;nb&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;nb-NO&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;nl&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;nl-BE&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;nl-NL&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;pl&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;pl-PL&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;pt&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;pt-BR&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;ro&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;ro-RO&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;ru&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;ru-RU&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;sv&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;sv-SE&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;th&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;th-TH&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;tr&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;tr-TR&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;vi&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;vi-VN&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;zh-Hans&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;zh-Hans-CN&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;zh-Hant&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;zh-Hant-HK&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;zh-Hant-TW&quot;</span>
                <span class="p">],</span> 
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;yui-base&quot;</span>
                <span class="p">],</span> 
                <span class="s2">&quot;supersedes&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;datatype-date-format&quot;</span>
                <span class="p">]</span>
            <span class="p">},</span> 
            <span class="s2">&quot;datatype-number&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;yui-base&quot;</span>
                <span class="p">]</span>
            <span class="p">},</span> 
            <span class="s2">&quot;datatype-xml&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;yui-base&quot;</span>
                <span class="p">]</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">},</span> 
    <span class="s2">&quot;datatype-date-format&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;path&quot;</span><span class="o">:</span> <span class="s2">&quot;datatype/datatype-date-format-min.js&quot;</span>
    <span class="p">},</span> 
    <span class="s2">&quot;dd&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;plugins&quot;</span><span class="o">:</span> <span class="p">{</span>
            <span class="s2">&quot;dd-drop-plugin&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;dd-drop&quot;</span>
                <span class="p">]</span>
            <span class="p">},</span> 
            <span class="s2">&quot;dd-gestures&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;condition&quot;</span><span class="o">:</span> <span class="p">{</span>
                    <span class="s2">&quot;test&quot;</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">Y</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">(</span><span class="nx">Y</span><span class="p">.</span><span class="nx">config</span><span class="p">.</span><span class="nx">win</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="s1">&#39;ontouchstart&#39;</span> <span class="k">in</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">config</span><span class="p">.</span><span class="nx">win</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">Y</span><span class="p">.</span><span class="nx">UA</span><span class="p">.</span><span class="nx">chrome</span><span class="p">));</span>
<span class="p">},</span> 
                    <span class="s2">&quot;trigger&quot;</span><span class="o">:</span> <span class="s2">&quot;dd-drag&quot;</span>
                <span class="p">},</span> 
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;dd-drag&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;event-move&quot;</span>
                <span class="p">]</span>
            <span class="p">},</span> 
            <span class="s2">&quot;dd-plugin&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;optional&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;dd-constrain&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;dd-proxy&quot;</span>
                <span class="p">],</span> 
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;dd-drag&quot;</span>
                <span class="p">]</span>
            <span class="p">}</span>
        <span class="p">},</span> 
        <span class="s2">&quot;submodules&quot;</span><span class="o">:</span> <span class="p">{</span>
            <span class="s2">&quot;dd-constrain&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;dd-drag&quot;</span>
                <span class="p">]</span>
            <span class="p">},</span> 
            <span class="s2">&quot;dd-ddm&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;dd-ddm-base&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;event-resize&quot;</span>
                <span class="p">]</span>
            <span class="p">},</span> 
            <span class="s2">&quot;dd-ddm-base&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;node&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;base&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;yui-throttle&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;classnamemanager&quot;</span>
                <span class="p">]</span>
            <span class="p">},</span> 
            <span class="s2">&quot;dd-ddm-drop&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;dd-ddm&quot;</span>
                <span class="p">]</span>
            <span class="p">},</span> 
            <span class="s2">&quot;dd-delegate&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;dd-drag&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;dd-drop-plugin&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;event-mouseenter&quot;</span>
                <span class="p">]</span>
            <span class="p">},</span> 
            <span class="s2">&quot;dd-drag&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;dd-ddm-base&quot;</span>
                <span class="p">]</span>
            <span class="p">},</span> 
            <span class="s2">&quot;dd-drop&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;dd-ddm-drop&quot;</span>
                <span class="p">]</span>
            <span class="p">},</span> 
            <span class="s2">&quot;dd-proxy&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;dd-drag&quot;</span>
                <span class="p">]</span>
            <span class="p">},</span> 
            <span class="s2">&quot;dd-scroll&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;dd-drag&quot;</span>
                <span class="p">]</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">},</span> 
    <span class="s2">&quot;dial&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;lang&quot;</span><span class="o">:</span> <span class="p">[</span>
            <span class="s2">&quot;en&quot;</span><span class="p">,</span> 
            <span class="s2">&quot;es&quot;</span>
        <span class="p">],</span> 
        <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
            <span class="s2">&quot;widget&quot;</span><span class="p">,</span> 
            <span class="s2">&quot;dd-drag&quot;</span><span class="p">,</span> 
            <span class="s2">&quot;substitute&quot;</span><span class="p">,</span> 
            <span class="s2">&quot;event-mouseenter&quot;</span><span class="p">,</span> 
            <span class="s2">&quot;transition&quot;</span><span class="p">,</span> 
            <span class="s2">&quot;intl&quot;</span>
        <span class="p">],</span> 
        <span class="s2">&quot;skinnable&quot;</span><span class="o">:</span> <span class="kc">true</span>
    <span class="p">},</span> 
    <span class="s2">&quot;dom&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;plugins&quot;</span><span class="o">:</span> <span class="p">{</span>
            <span class="s2">&quot;dom-deprecated&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;dom-base&quot;</span>
                <span class="p">]</span>
            <span class="p">},</span> 
            <span class="s2">&quot;dom-style-ie&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;condition&quot;</span><span class="o">:</span> <span class="p">{</span>
                    <span class="s2">&quot;test&quot;</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">Y</span><span class="p">)</span> <span class="p">{</span>

    <span class="kd">var</span> <span class="nx">testFeature</span> <span class="o">=</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">Features</span><span class="p">.</span><span class="nx">test</span><span class="p">,</span>
        <span class="nx">addFeature</span> <span class="o">=</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">Features</span><span class="p">.</span><span class="nx">add</span><span class="p">,</span>
        <span class="nx">WINDOW</span> <span class="o">=</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">config</span><span class="p">.</span><span class="nx">win</span><span class="p">,</span>
        <span class="nx">DOCUMENT</span> <span class="o">=</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">config</span><span class="p">.</span><span class="nx">doc</span><span class="p">,</span>
        <span class="nx">DOCUMENT_ELEMENT</span> <span class="o">=</span> <span class="s1">&#39;documentElement&#39;</span><span class="p">,</span>
        <span class="nx">ret</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>

    <span class="nx">addFeature</span><span class="p">(</span><span class="s1">&#39;style&#39;</span><span class="p">,</span> <span class="s1">&#39;computedStyle&#39;</span><span class="p">,</span> <span class="p">{</span>
        <span class="nx">test</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">WINDOW</span> <span class="o">&amp;&amp;</span> <span class="s1">&#39;getComputedStyle&#39;</span> <span class="k">in</span> <span class="nx">WINDOW</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">});</span>

    <span class="nx">addFeature</span><span class="p">(</span><span class="s1">&#39;style&#39;</span><span class="p">,</span> <span class="s1">&#39;opacity&#39;</span><span class="p">,</span> <span class="p">{</span>
        <span class="nx">test</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">DOCUMENT</span> <span class="o">&amp;&amp;</span> <span class="s1">&#39;opacity&#39;</span> <span class="k">in</span> <span class="nx">DOCUMENT</span><span class="p">[</span><span class="nx">DOCUMENT_ELEMENT</span><span class="p">].</span><span class="nx">style</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">});</span>

    <span class="nx">ret</span> <span class="o">=</span>  <span class="p">(</span><span class="o">!</span><span class="nx">testFeature</span><span class="p">(</span><span class="s1">&#39;style&#39;</span><span class="p">,</span> <span class="s1">&#39;opacity&#39;</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
            <span class="o">!</span><span class="nx">testFeature</span><span class="p">(</span><span class="s1">&#39;style&#39;</span><span class="p">,</span> <span class="s1">&#39;computedStyle&#39;</span><span class="p">));</span>

    <span class="k">return</span> <span class="nx">ret</span><span class="p">;</span>
<span class="p">},</span> 
                    <span class="s2">&quot;trigger&quot;</span><span class="o">:</span> <span class="s2">&quot;dom-style&quot;</span>
                <span class="p">},</span> 
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;dom-style&quot;</span>
                <span class="p">]</span>
            <span class="p">},</span> 
            <span class="s2">&quot;selector-css3&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;selector-css2&quot;</span>
                <span class="p">]</span>
            <span class="p">}</span>
        <span class="p">},</span> 
        <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
            <span class="s2">&quot;oop&quot;</span>
        <span class="p">],</span> 
        <span class="s2">&quot;submodules&quot;</span><span class="o">:</span> <span class="p">{</span>
            <span class="s2">&quot;dom-base&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;oop&quot;</span>
                <span class="p">]</span>
            <span class="p">},</span> 
            <span class="s2">&quot;dom-screen&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;dom-base&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;dom-style&quot;</span>
                <span class="p">]</span>
            <span class="p">},</span> 
            <span class="s2">&quot;dom-style&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;dom-base&quot;</span>
                <span class="p">]</span>
            <span class="p">},</span> 
            <span class="s2">&quot;selector&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;dom-base&quot;</span>
                <span class="p">]</span>
            <span class="p">},</span> 
            <span class="s2">&quot;selector-css2&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;selector-native&quot;</span>
                <span class="p">]</span>
            <span class="p">},</span> 
            <span class="s2">&quot;selector-native&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;dom-base&quot;</span>
                <span class="p">]</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">},</span> 
    <span class="s2">&quot;dump&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
            <span class="s2">&quot;yui-base&quot;</span>
        <span class="p">]</span>
    <span class="p">},</span> 
    <span class="s2">&quot;editor&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;submodules&quot;</span><span class="o">:</span> <span class="p">{</span>
            <span class="s2">&quot;createlink-base&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;editor-base&quot;</span>
                <span class="p">]</span>
            <span class="p">},</span> 
            <span class="s2">&quot;editor-base&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;base&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;frame&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;node&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;exec-command&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;selection&quot;</span>
                <span class="p">]</span>
            <span class="p">},</span> 
            <span class="s2">&quot;editor-bidi&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;editor-base&quot;</span>
                <span class="p">]</span>
            <span class="p">},</span> 
            <span class="s2">&quot;editor-br&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;node&quot;</span>
                <span class="p">]</span>
            <span class="p">},</span> 
            <span class="s2">&quot;editor-lists&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;editor-base&quot;</span>
                <span class="p">]</span>
            <span class="p">},</span> 
            <span class="s2">&quot;editor-para&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;node&quot;</span>
                <span class="p">]</span>
            <span class="p">},</span> 
            <span class="s2">&quot;exec-command&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;frame&quot;</span>
                <span class="p">]</span>
            <span class="p">},</span> 
            <span class="s2">&quot;frame&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;base&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;node&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;selector-css3&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;substitute&quot;</span>
                <span class="p">]</span>
            <span class="p">},</span> 
            <span class="s2">&quot;selection&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;node&quot;</span>
                <span class="p">]</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">},</span> 
    <span class="s2">&quot;escape&quot;</span><span class="o">:</span> <span class="p">{},</span> 
    <span class="s2">&quot;event&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;after&quot;</span><span class="o">:</span> <span class="s2">&quot;node-base&quot;</span><span class="p">,</span> 
        <span class="s2">&quot;plugins&quot;</span><span class="o">:</span> <span class="p">{</span>
            <span class="s2">&quot;event-base-ie&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;after&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;event-base&quot;</span>
                <span class="p">],</span> 
                <span class="s2">&quot;condition&quot;</span><span class="o">:</span> <span class="p">{</span>
                    <span class="s2">&quot;test&quot;</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">Y</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">imp</span> <span class="o">=</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">config</span><span class="p">.</span><span class="nx">doc</span> <span class="o">&amp;&amp;</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">config</span><span class="p">.</span><span class="nx">doc</span><span class="p">.</span><span class="nx">implementation</span><span class="p">;</span>
    <span class="k">return</span> <span class="p">(</span><span class="nx">imp</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="o">!</span><span class="nx">imp</span><span class="p">.</span><span class="nx">hasFeature</span><span class="p">(</span><span class="s1">&#39;Events&#39;</span><span class="p">,</span> <span class="s1">&#39;2.0&#39;</span><span class="p">)));</span>
<span class="p">},</span> 
                    <span class="s2">&quot;trigger&quot;</span><span class="o">:</span> <span class="s2">&quot;node-base&quot;</span>
                <span class="p">},</span> 
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;node-base&quot;</span>
                <span class="p">]</span>
            <span class="p">},</span> 
            <span class="s2">&quot;event-touch&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;node-base&quot;</span>
                <span class="p">]</span>
            <span class="p">}</span>
        <span class="p">},</span> 
        <span class="s2">&quot;submodules&quot;</span><span class="o">:</span> <span class="p">{</span>
            <span class="s2">&quot;event-base&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;after&quot;</span><span class="o">:</span> <span class="s2">&quot;node-base&quot;</span><span class="p">,</span> 
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;event-custom-base&quot;</span>
                <span class="p">]</span>
            <span class="p">},</span> 
            <span class="s2">&quot;event-delegate&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;node-base&quot;</span>
                <span class="p">]</span>
            <span class="p">},</span> 
            <span class="s2">&quot;event-focus&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;event-synthetic&quot;</span>
                <span class="p">]</span>
            <span class="p">},</span> 
            <span class="s2">&quot;event-hover&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;event-synthetic&quot;</span>
                <span class="p">]</span>
            <span class="p">},</span> 
            <span class="s2">&quot;event-key&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;event-synthetic&quot;</span>
                <span class="p">]</span>
            <span class="p">},</span> 
            <span class="s2">&quot;event-mouseenter&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;event-synthetic&quot;</span>
                <span class="p">]</span>
            <span class="p">},</span> 
            <span class="s2">&quot;event-mousewheel&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;event-synthetic&quot;</span>
                <span class="p">]</span>
            <span class="p">},</span> 
            <span class="s2">&quot;event-resize&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;event-synthetic&quot;</span>
                <span class="p">]</span>
            <span class="p">},</span> 
            <span class="s2">&quot;event-synthetic&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;node-base&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;event-custom-complex&quot;</span>
                <span class="p">]</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">},</span> 
    <span class="s2">&quot;event-custom&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;submodules&quot;</span><span class="o">:</span> <span class="p">{</span>
            <span class="s2">&quot;event-custom-base&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;oop&quot;</span>
                <span class="p">]</span>
            <span class="p">},</span> 
            <span class="s2">&quot;event-custom-complex&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;event-custom-base&quot;</span>
                <span class="p">]</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">},</span> 
    <span class="s2">&quot;event-gestures&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;submodules&quot;</span><span class="o">:</span> <span class="p">{</span>
            <span class="s2">&quot;event-flick&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;node-base&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;event-touch&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;event-synthetic&quot;</span>
                <span class="p">]</span>
            <span class="p">},</span> 
            <span class="s2">&quot;event-move&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;node-base&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;event-touch&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;event-synthetic&quot;</span>
                <span class="p">]</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">},</span> 
    <span class="s2">&quot;event-simulate&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
            <span class="s2">&quot;event-base&quot;</span>
        <span class="p">]</span>
    <span class="p">},</span> 
    <span class="s2">&quot;event-valuechange&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
            <span class="s2">&quot;event-focus&quot;</span><span class="p">,</span> 
            <span class="s2">&quot;event-synthetic&quot;</span>
        <span class="p">]</span>
    <span class="p">},</span> 
    <span class="s2">&quot;highlight&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;submodules&quot;</span><span class="o">:</span> <span class="p">{</span>
            <span class="s2">&quot;highlight-accentfold&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;highlight-base&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;text-accentfold&quot;</span>
                <span class="p">]</span>
            <span class="p">},</span> 
            <span class="s2">&quot;highlight-base&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;array-extras&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;escape&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;text-wordbreak&quot;</span>
                <span class="p">]</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">},</span> 
    <span class="s2">&quot;history&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;plugins&quot;</span><span class="o">:</span> <span class="p">{</span>
            <span class="s2">&quot;history-hash-ie&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;condition&quot;</span><span class="o">:</span> <span class="p">{</span>
                    <span class="s2">&quot;test&quot;</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">Y</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">docMode</span> <span class="o">=</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">config</span><span class="p">.</span><span class="nx">doc</span><span class="p">.</span><span class="nx">documentMode</span><span class="p">;</span>

    <span class="k">return</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">UA</span><span class="p">.</span><span class="nx">ie</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="s1">&#39;onhashchange&#39;</span> <span class="k">in</span> <span class="nx">Y</span><span class="p">.</span><span class="nx">config</span><span class="p">.</span><span class="nx">win</span><span class="p">)</span> <span class="o">||</span>
            <span class="o">!</span><span class="nx">docMode</span> <span class="o">||</span> <span class="nx">docMode</span> <span class="o">&lt;</span> <span class="mi">8</span><span class="p">);</span>
<span class="p">},</span> 
                    <span class="s2">&quot;trigger&quot;</span><span class="o">:</span> <span class="s2">&quot;history-hash&quot;</span>
                <span class="p">},</span> 
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;history-hash&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;node-base&quot;</span>
                <span class="p">]</span>
            <span class="p">}</span>
        <span class="p">},</span> 
        <span class="s2">&quot;submodules&quot;</span><span class="o">:</span> <span class="p">{</span>
            <span class="s2">&quot;history-base&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;after&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;history-deprecated&quot;</span>
                <span class="p">],</span> 
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;event-custom-complex&quot;</span>
                <span class="p">]</span>
            <span class="p">},</span> 
            <span class="s2">&quot;history-hash&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;after&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;history-html5&quot;</span>
                <span class="p">],</span> 
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;event-synthetic&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;history-base&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;yui-later&quot;</span>
                <span class="p">]</span>
            <span class="p">},</span> 
            <span class="s2">&quot;history-html5&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;optional&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;json&quot;</span>
                <span class="p">],</span> 
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;event-base&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;history-base&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;node-base&quot;</span>
                <span class="p">]</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">},</span> 
    <span class="s2">&quot;history-deprecated&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
            <span class="s2">&quot;node&quot;</span>
        <span class="p">]</span>
    <span class="p">},</span> 
    <span class="s2">&quot;imageloader&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
            <span class="s2">&quot;base-base&quot;</span><span class="p">,</span> 
            <span class="s2">&quot;node-style&quot;</span><span class="p">,</span> 
            <span class="s2">&quot;node-screen&quot;</span>
        <span class="p">]</span>
    <span class="p">},</span> 
    <span class="s2">&quot;intl&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
            <span class="s2">&quot;intl-base&quot;</span><span class="p">,</span> 
            <span class="s2">&quot;event-custom&quot;</span>
        <span class="p">]</span>
    <span class="p">},</span> 
    <span class="s2">&quot;io&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;submodules&quot;</span><span class="o">:</span> <span class="p">{</span>
            <span class="s2">&quot;io-base&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;optional&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;querystring-stringify-simple&quot;</span>
                <span class="p">],</span> 
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;event-custom-base&quot;</span>
                <span class="p">]</span>
            <span class="p">},</span> 
            <span class="s2">&quot;io-form&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;io-base&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;node-base&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;node-style&quot;</span>
                <span class="p">]</span>
            <span class="p">},</span> 
            <span class="s2">&quot;io-queue&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;io-base&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;queue-promote&quot;</span>
                <span class="p">]</span>
            <span class="p">},</span> 
            <span class="s2">&quot;io-upload-iframe&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;io-base&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;node-base&quot;</span>
                <span class="p">]</span>
            <span class="p">},</span> 
            <span class="s2">&quot;io-xdr&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;io-base&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;datatype-xml&quot;</span>
                <span class="p">]</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">},</span> 
    <span class="s2">&quot;json&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;submodules&quot;</span><span class="o">:</span> <span class="p">{</span>
            <span class="s2">&quot;json-parse&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;yui-base&quot;</span>
                <span class="p">]</span>
            <span class="p">},</span> 
            <span class="s2">&quot;json-stringify&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;yui-base&quot;</span>
                <span class="p">]</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">},</span> 
    <span class="s2">&quot;jsonp&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;plugins&quot;</span><span class="o">:</span> <span class="p">{</span>
            <span class="s2">&quot;jsonp-url&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;jsonp&quot;</span>
                <span class="p">]</span>
            <span class="p">}</span>
        <span class="p">},</span> 
        <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
            <span class="s2">&quot;get&quot;</span><span class="p">,</span> 
            <span class="s2">&quot;oop&quot;</span>
        <span class="p">]</span>
    <span class="p">},</span> 
    <span class="s2">&quot;loader&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;submodules&quot;</span><span class="o">:</span> <span class="p">{</span>
            <span class="s2">&quot;loader-base&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;get&quot;</span>
                <span class="p">]</span>
            <span class="p">},</span> 
            <span class="s2">&quot;loader-rollup&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;loader-base&quot;</span>
                <span class="p">]</span>
            <span class="p">},</span> 
            <span class="s2">&quot;loader-yui3&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;loader-base&quot;</span>
                <span class="p">]</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">},</span> 
    <span class="s2">&quot;node&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;plugins&quot;</span><span class="o">:</span> <span class="p">{</span>
            <span class="s2">&quot;align-plugin&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;node-screen&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;node-pluginhost&quot;</span>
                <span class="p">]</span>
            <span class="p">},</span> 
            <span class="s2">&quot;node-deprecated&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;node-base&quot;</span>
                <span class="p">]</span>
            <span class="p">},</span> 
            <span class="s2">&quot;node-event-simulate&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;node-base&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;event-simulate&quot;</span>
                <span class="p">]</span>
            <span class="p">},</span> 
            <span class="s2">&quot;node-load&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;node-base&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;io-base&quot;</span>
                <span class="p">]</span>
            <span class="p">},</span> 
            <span class="s2">&quot;shim-plugin&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;node-style&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;node-pluginhost&quot;</span>
                <span class="p">]</span>
            <span class="p">},</span> 
            <span class="s2">&quot;transition&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;transition-native&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;node-style&quot;</span>
                <span class="p">]</span>
            <span class="p">},</span> 
            <span class="s2">&quot;transition-native&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;node-base&quot;</span>
                <span class="p">]</span>
            <span class="p">}</span>
        <span class="p">},</span> 
        <span class="s2">&quot;submodules&quot;</span><span class="o">:</span> <span class="p">{</span>
            <span class="s2">&quot;node-base&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;dom-base&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;selector-css2&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;event-base&quot;</span>
                <span class="p">]</span>
            <span class="p">},</span> 
            <span class="s2">&quot;node-event-delegate&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;node-base&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;event-delegate&quot;</span>
                <span class="p">]</span>
            <span class="p">},</span> 
            <span class="s2">&quot;node-pluginhost&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;node-base&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;pluginhost&quot;</span>
                <span class="p">]</span>
            <span class="p">},</span> 
            <span class="s2">&quot;node-screen&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;dom-screen&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;node-base&quot;</span>
                <span class="p">]</span>
            <span class="p">},</span> 
            <span class="s2">&quot;node-style&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;dom-style&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;node-base&quot;</span>
                <span class="p">]</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">},</span> 
    <span class="s2">&quot;node-flick&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
            <span class="s2">&quot;classnamemanager&quot;</span><span class="p">,</span> 
            <span class="s2">&quot;transition&quot;</span><span class="p">,</span> 
            <span class="s2">&quot;event-flick&quot;</span><span class="p">,</span> 
            <span class="s2">&quot;plugin&quot;</span>
        <span class="p">],</span> 
        <span class="s2">&quot;skinnable&quot;</span><span class="o">:</span> <span class="kc">true</span>
    <span class="p">},</span> 
    <span class="s2">&quot;node-focusmanager&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
            <span class="s2">&quot;attribute&quot;</span><span class="p">,</span> 
            <span class="s2">&quot;node&quot;</span><span class="p">,</span> 
            <span class="s2">&quot;plugin&quot;</span><span class="p">,</span> 
            <span class="s2">&quot;node-event-simulate&quot;</span><span class="p">,</span> 
            <span class="s2">&quot;event-key&quot;</span><span class="p">,</span> 
            <span class="s2">&quot;event-focus&quot;</span>
        <span class="p">]</span>
    <span class="p">},</span> 
    <span class="s2">&quot;node-menunav&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
            <span class="s2">&quot;node&quot;</span><span class="p">,</span> 
            <span class="s2">&quot;classnamemanager&quot;</span><span class="p">,</span> 
            <span class="s2">&quot;plugin&quot;</span><span class="p">,</span> 
            <span class="s2">&quot;node-focusmanager&quot;</span>
        <span class="p">],</span> 
        <span class="s2">&quot;skinnable&quot;</span><span class="o">:</span> <span class="kc">true</span>
    <span class="p">},</span> 
    <span class="s2">&quot;oop&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
            <span class="s2">&quot;yui-base&quot;</span>
        <span class="p">]</span>
    <span class="p">},</span> 
    <span class="s2">&quot;overlay&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
            <span class="s2">&quot;widget&quot;</span><span class="p">,</span> 
            <span class="s2">&quot;widget-stdmod&quot;</span><span class="p">,</span> 
            <span class="s2">&quot;widget-position&quot;</span><span class="p">,</span> 
            <span class="s2">&quot;widget-position-align&quot;</span><span class="p">,</span> 
            <span class="s2">&quot;widget-stack&quot;</span><span class="p">,</span> 
            <span class="s2">&quot;widget-position-constrain&quot;</span>
        <span class="p">],</span> 
        <span class="s2">&quot;skinnable&quot;</span><span class="o">:</span> <span class="kc">true</span>
    <span class="p">},</span> 
    <span class="s2">&quot;plugin&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
            <span class="s2">&quot;base-base&quot;</span>
        <span class="p">]</span>
    <span class="p">},</span> 
    <span class="s2">&quot;pluginhost&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;submodules&quot;</span><span class="o">:</span> <span class="p">{</span>
            <span class="s2">&quot;pluginhost-base&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;yui-base&quot;</span>
                <span class="p">]</span>
            <span class="p">},</span> 
            <span class="s2">&quot;pluginhost-config&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;pluginhost-base&quot;</span>
                <span class="p">]</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">},</span> 
    <span class="s2">&quot;profiler&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
            <span class="s2">&quot;yui-base&quot;</span>
        <span class="p">]</span>
    <span class="p">},</span> 
    <span class="s2">&quot;querystring&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;submodules&quot;</span><span class="o">:</span> <span class="p">{</span>
            <span class="s2">&quot;querystring-parse&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;yui-base&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;array-extras&quot;</span>
                <span class="p">]</span>
            <span class="p">},</span> 
            <span class="s2">&quot;querystring-stringify&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;yui-base&quot;</span>
                <span class="p">]</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">},</span> 
    <span class="s2">&quot;querystring-parse-simple&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;path&quot;</span><span class="o">:</span> <span class="s2">&quot;querystring/querystring-parse-simple-min.js&quot;</span><span class="p">,</span> 
        <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
            <span class="s2">&quot;yui-base&quot;</span>
        <span class="p">]</span>
    <span class="p">},</span> 
    <span class="s2">&quot;querystring-stringify-simple&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;path&quot;</span><span class="o">:</span> <span class="s2">&quot;querystring/querystring-stringify-simple-min.js&quot;</span><span class="p">,</span> 
        <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
            <span class="s2">&quot;yui-base&quot;</span>
        <span class="p">]</span>
    <span class="p">},</span> 
    <span class="s2">&quot;queue-promote&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
            <span class="s2">&quot;yui-base&quot;</span>
        <span class="p">]</span>
    <span class="p">},</span> 
    <span class="s2">&quot;queue-run&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;path&quot;</span><span class="o">:</span> <span class="s2">&quot;async-queue/async-queue-min.js&quot;</span><span class="p">,</span> 
        <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
            <span class="s2">&quot;event-custom&quot;</span>
        <span class="p">]</span>
    <span class="p">},</span> 
    <span class="s2">&quot;recordset&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;submodules&quot;</span><span class="o">:</span> <span class="p">{</span>
            <span class="s2">&quot;recordset-base&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;base&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;arraylist&quot;</span>
                <span class="p">]</span>
            <span class="p">},</span> 
            <span class="s2">&quot;recordset-filter&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;recordset-base&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;array-extras&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;plugin&quot;</span>
                <span class="p">]</span>
            <span class="p">},</span> 
            <span class="s2">&quot;recordset-indexer&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;recordset-base&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;plugin&quot;</span>
                <span class="p">]</span>
            <span class="p">},</span> 
            <span class="s2">&quot;recordset-sort&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;arraysort&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;recordset-base&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;plugin&quot;</span>
                <span class="p">]</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">},</span> 
    <span class="s2">&quot;resize&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;submodules&quot;</span><span class="o">:</span> <span class="p">{</span>
            <span class="s2">&quot;resize-base&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;widget&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;substitute&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;event&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;oop&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;dd-drag&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;dd-delegate&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;dd-drop&quot;</span>
                <span class="p">],</span> 
                <span class="s2">&quot;skinnable&quot;</span><span class="o">:</span> <span class="kc">true</span>
            <span class="p">},</span> 
            <span class="s2">&quot;resize-constrain&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;plugin&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;resize-base&quot;</span>
                <span class="p">]</span>
            <span class="p">},</span> 
            <span class="s2">&quot;resize-proxy&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;plugin&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;resize-base&quot;</span>
                <span class="p">]</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">},</span> 
    <span class="s2">&quot;scrollview&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;plugins&quot;</span><span class="o">:</span> <span class="p">{</span>
            <span class="s2">&quot;scrollview-base&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;path&quot;</span><span class="o">:</span> <span class="s2">&quot;scrollview/scrollview-base-min.js&quot;</span><span class="p">,</span> 
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;widget&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;event-gestures&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;transition&quot;</span>
                <span class="p">],</span> 
                <span class="s2">&quot;skinnable&quot;</span><span class="o">:</span> <span class="kc">true</span>
            <span class="p">},</span> 
            <span class="s2">&quot;scrollview-base-ie&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;condition&quot;</span><span class="o">:</span> <span class="p">{</span>
                    <span class="s2">&quot;trigger&quot;</span><span class="o">:</span> <span class="s2">&quot;scrollview-base&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;ua&quot;</span><span class="o">:</span> <span class="s2">&quot;ie&quot;</span>
                <span class="p">},</span> 
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;scrollview-base&quot;</span>
                <span class="p">]</span>
            <span class="p">},</span> 
            <span class="s2">&quot;scrollview-paginator&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;path&quot;</span><span class="o">:</span> <span class="s2">&quot;scrollview/scrollview-paginator-min.js&quot;</span><span class="p">,</span> 
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;plugin&quot;</span>
                <span class="p">]</span>
            <span class="p">},</span> 
            <span class="s2">&quot;scrollview-scrollbars&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;path&quot;</span><span class="o">:</span> <span class="s2">&quot;scrollview/scrollview-scrollbars-min.js&quot;</span><span class="p">,</span> 
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;plugin&quot;</span>
                <span class="p">],</span> 
                <span class="s2">&quot;skinnable&quot;</span><span class="o">:</span> <span class="kc">true</span>
            <span class="p">}</span>
        <span class="p">},</span> 
        <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
            <span class="s2">&quot;scrollview-base&quot;</span><span class="p">,</span> 
            <span class="s2">&quot;scrollview-scrollbars&quot;</span>
        <span class="p">]</span>
    <span class="p">},</span> 
    <span class="s2">&quot;slider&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;submodules&quot;</span><span class="o">:</span> <span class="p">{</span>
            <span class="s2">&quot;clickable-rail&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;slider-base&quot;</span>
                <span class="p">]</span>
            <span class="p">},</span> 
            <span class="s2">&quot;range-slider&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;slider-base&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;slider-value-range&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;clickable-rail&quot;</span>
                <span class="p">]</span>
            <span class="p">},</span> 
            <span class="s2">&quot;slider-base&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;widget&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;dd-constrain&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;substitute&quot;</span>
                <span class="p">],</span> 
                <span class="s2">&quot;skinnable&quot;</span><span class="o">:</span> <span class="kc">true</span>
            <span class="p">},</span> 
            <span class="s2">&quot;slider-value-range&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;slider-base&quot;</span>
                <span class="p">]</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">},</span> 
    <span class="s2">&quot;sortable&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;plugins&quot;</span><span class="o">:</span> <span class="p">{</span>
            <span class="s2">&quot;sortable-scroll&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;dd-scroll&quot;</span>
                <span class="p">]</span>
            <span class="p">}</span>
        <span class="p">},</span> 
        <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
            <span class="s2">&quot;dd-delegate&quot;</span><span class="p">,</span> 
            <span class="s2">&quot;dd-drop-plugin&quot;</span><span class="p">,</span> 
            <span class="s2">&quot;dd-proxy&quot;</span>
        <span class="p">]</span>
    <span class="p">},</span> 
    <span class="s2">&quot;stylesheet&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
            <span class="s2">&quot;yui-base&quot;</span>
        <span class="p">]</span>
    <span class="p">},</span> 
    <span class="s2">&quot;substitute&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;optional&quot;</span><span class="o">:</span> <span class="p">[</span>
            <span class="s2">&quot;dump&quot;</span>
        <span class="p">]</span>
    <span class="p">},</span> 
    <span class="s2">&quot;swf&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
            <span class="s2">&quot;event-custom&quot;</span><span class="p">,</span> 
            <span class="s2">&quot;node&quot;</span><span class="p">,</span> 
            <span class="s2">&quot;swfdetect&quot;</span>
        <span class="p">]</span>
    <span class="p">},</span> 
    <span class="s2">&quot;swfdetect&quot;</span><span class="o">:</span> <span class="p">{},</span> 
    <span class="s2">&quot;tabview&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;plugins&quot;</span><span class="o">:</span> <span class="p">{</span>
            <span class="s2">&quot;tabview-base&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;node-event-delegate&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;classnamemanager&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;skin-sam-tabview&quot;</span>
                <span class="p">]</span>
            <span class="p">},</span> 
            <span class="s2">&quot;tabview-plugin&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;tabview-base&quot;</span>
                <span class="p">]</span>
            <span class="p">}</span>
        <span class="p">},</span> 
        <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
            <span class="s2">&quot;widget&quot;</span><span class="p">,</span> 
            <span class="s2">&quot;widget-parent&quot;</span><span class="p">,</span> 
            <span class="s2">&quot;widget-child&quot;</span><span class="p">,</span> 
            <span class="s2">&quot;tabview-base&quot;</span><span class="p">,</span> 
            <span class="s2">&quot;node-pluginhost&quot;</span><span class="p">,</span> 
            <span class="s2">&quot;node-focusmanager&quot;</span>
        <span class="p">],</span> 
        <span class="s2">&quot;skinnable&quot;</span><span class="o">:</span> <span class="kc">true</span>
    <span class="p">},</span> 
    <span class="s2">&quot;test&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
            <span class="s2">&quot;substitute&quot;</span><span class="p">,</span> 
            <span class="s2">&quot;node&quot;</span><span class="p">,</span> 
            <span class="s2">&quot;json&quot;</span><span class="p">,</span> 
            <span class="s2">&quot;event-simulate&quot;</span>
        <span class="p">],</span> 
        <span class="s2">&quot;skinnable&quot;</span><span class="o">:</span> <span class="kc">true</span>
    <span class="p">},</span> 
    <span class="s2">&quot;text&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;submodules&quot;</span><span class="o">:</span> <span class="p">{</span>
            <span class="s2">&quot;text-accentfold&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;array-extras&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;text-data-accentfold&quot;</span>
                <span class="p">]</span>
            <span class="p">},</span> 
            <span class="s2">&quot;text-data-accentfold&quot;</span><span class="o">:</span> <span class="p">{},</span> 
            <span class="s2">&quot;text-data-wordbreak&quot;</span><span class="o">:</span> <span class="p">{},</span> 
            <span class="s2">&quot;text-wordbreak&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;array-extras&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;text-data-wordbreak&quot;</span>
                <span class="p">]</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">},</span> 
    <span class="s2">&quot;transition&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;submodules&quot;</span><span class="o">:</span> <span class="p">{</span>
            <span class="s2">&quot;transition-native&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;node-base&quot;</span>
                <span class="p">]</span>
            <span class="p">},</span> 
            <span class="s2">&quot;transition-timer&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;transition-native&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;node-style&quot;</span>
                <span class="p">]</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">},</span> 
    <span class="s2">&quot;uploader&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
            <span class="s2">&quot;event-custom&quot;</span><span class="p">,</span> 
            <span class="s2">&quot;node&quot;</span><span class="p">,</span> 
            <span class="s2">&quot;base&quot;</span><span class="p">,</span> 
            <span class="s2">&quot;swf&quot;</span>
        <span class="p">]</span>
    <span class="p">},</span> 
    <span class="s2">&quot;widget&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;plugins&quot;</span><span class="o">:</span> <span class="p">{</span>
            <span class="s2">&quot;widget-base-ie&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;condition&quot;</span><span class="o">:</span> <span class="p">{</span>
                    <span class="s2">&quot;trigger&quot;</span><span class="o">:</span> <span class="s2">&quot;widget-base&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;ua&quot;</span><span class="o">:</span> <span class="s2">&quot;ie&quot;</span>
                <span class="p">},</span> 
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;widget-base&quot;</span>
                <span class="p">]</span>
            <span class="p">},</span> 
            <span class="s2">&quot;widget-child&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;base-build&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;widget&quot;</span>
                <span class="p">]</span>
            <span class="p">},</span> 
            <span class="s2">&quot;widget-parent&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;base-build&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;arraylist&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;widget&quot;</span>
                <span class="p">]</span>
            <span class="p">},</span> 
            <span class="s2">&quot;widget-position&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;base-build&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;node-screen&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;widget&quot;</span>
                <span class="p">]</span>
            <span class="p">},</span> 
            <span class="s2">&quot;widget-position-align&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;widget-position&quot;</span>
                <span class="p">]</span>
            <span class="p">},</span> 
            <span class="s2">&quot;widget-position-constrain&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;widget-position&quot;</span>
                <span class="p">]</span>
            <span class="p">},</span> 
            <span class="s2">&quot;widget-stack&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;base-build&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;widget&quot;</span>
                <span class="p">],</span> 
                <span class="s2">&quot;skinnable&quot;</span><span class="o">:</span> <span class="kc">true</span>
            <span class="p">},</span> 
            <span class="s2">&quot;widget-stdmod&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;base-build&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;widget&quot;</span>
                <span class="p">]</span>
            <span class="p">}</span>
        <span class="p">},</span> 
        <span class="s2">&quot;skinnable&quot;</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span> 
        <span class="s2">&quot;submodules&quot;</span><span class="o">:</span> <span class="p">{</span>
            <span class="s2">&quot;widget-base&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;attribute&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;event-focus&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;base-base&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;base-pluginhost&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;node-base&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;node-style&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;classnamemanager&quot;</span>
                <span class="p">]</span>
            <span class="p">},</span> 
            <span class="s2">&quot;widget-htmlparser&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;widget-base&quot;</span>
                <span class="p">]</span>
            <span class="p">},</span> 
            <span class="s2">&quot;widget-skin&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;widget-base&quot;</span>
                <span class="p">]</span>
            <span class="p">},</span> 
            <span class="s2">&quot;widget-uievents&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;widget-base&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;node-event-delegate&quot;</span>
                <span class="p">]</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">},</span> 
    <span class="s2">&quot;widget-anim&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
            <span class="s2">&quot;plugin&quot;</span><span class="p">,</span> 
            <span class="s2">&quot;anim-base&quot;</span><span class="p">,</span> 
            <span class="s2">&quot;widget&quot;</span>
        <span class="p">]</span>
    <span class="p">},</span> 
    <span class="s2">&quot;widget-locale&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;path&quot;</span><span class="o">:</span> <span class="s2">&quot;widget/widget-locale-min.js&quot;</span><span class="p">,</span> 
        <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
            <span class="s2">&quot;widget-base&quot;</span>
        <span class="p">]</span>
    <span class="p">},</span> 
    <span class="s2">&quot;yql&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
            <span class="s2">&quot;jsonp&quot;</span><span class="p">,</span> 
            <span class="s2">&quot;jsonp-url&quot;</span>
        <span class="p">]</span>
    <span class="p">},</span> 
    <span class="s2">&quot;yui&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;submodules&quot;</span><span class="o">:</span> <span class="p">{</span>
            <span class="s2">&quot;features&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;yui-base&quot;</span>
                <span class="p">]</span>
            <span class="p">},</span> 
            <span class="s2">&quot;get&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;yui-base&quot;</span>
                <span class="p">]</span>
            <span class="p">},</span> 
            <span class="s2">&quot;intl-base&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;yui-base&quot;</span>
                <span class="p">]</span>
            <span class="p">},</span> 
            <span class="s2">&quot;rls&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;get&quot;</span><span class="p">,</span> 
                    <span class="s2">&quot;features&quot;</span>
                <span class="p">]</span>
            <span class="p">},</span> 
            <span class="s2">&quot;yui-base&quot;</span><span class="o">:</span> <span class="p">{},</span> 
            <span class="s2">&quot;yui-later&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;yui-base&quot;</span>
                <span class="p">]</span>
            <span class="p">},</span> 
            <span class="s2">&quot;yui-log&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;yui-base&quot;</span>
                <span class="p">]</span>
            <span class="p">},</span> 
            <span class="s2">&quot;yui-throttle&quot;</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">&quot;requires&quot;</span><span class="o">:</span> <span class="p">[</span>
                    <span class="s2">&quot;yui-base&quot;</span>
                <span class="p">]</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">};</span>
<span class="nx">YUI</span><span class="p">.</span><span class="nx">Env</span><span class="p">[</span><span class="nx">Y</span><span class="p">.</span><span class="nx">version</span><span class="p">].</span><span class="nx">md5</span> <span class="o">=</span> <span class="s1">&#39;faf08d27c01d7ab5575789a63b1e36fc&#39;</span><span class="p">;</span>



<span class="p">},</span> <span class="s1">&#39;3.3.0&#39;</span> <span class="p">,{</span><span class="nx">requires</span><span class="o">:</span><span class="p">[</span><span class="s1">&#39;loader-base&#39;</span><span class="p">]});</span>



<span class="nx">YUI</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="s1">&#39;loader&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">Y</span><span class="p">){},</span> <span class="s1">&#39;3.3.0&#39;</span> <span class="p">,{</span><span class="nx">use</span><span class="o">:</span><span class="p">[</span><span class="s1">&#39;loader-base&#39;</span><span class="p">,</span> <span class="s1">&#39;loader-rollup&#39;</span><span class="p">,</span> <span class="s1">&#39;loader-yui3&#39;</span> <span class="p">]});</span>
</pre></div>

							</div>
						<!-- /End/Start -->
					</div>
				</div>
			</div>
		</div>
	</div>

	<div class="yui3-aui-footer">
		Copyright &copy; 2011 Yahoo! Inc. All rights reserved.
	</div>
</div>

<script type="text/javascript">

    var ALL_YUI_PROPS = [{"url": "Loader.html#method_addGroup", "access": "", "host": "Loader", "type": "method", "name": "addGroup"}, {"url": "Loader.html#method_addModule", "access": "", "host": "Loader", "type": "method", "name": "addModule"}, {"url": "Loader.html#property_allowRollup", "access": "", "host": "Loader", "type": "property", "name": "allowRollup"}, {"url": "Loader.html#property_base", "access": "", "host": "Loader", "type": "property", "name": "base"}, {"url": "Loader.html#method_calculate", "access": "", "host": "Loader", "type": "method", "name": "calculate"}, {"url": "Loader.html#property_charset", "access": "", "host": "Loader", "type": "property", "name": "charset"}, {"url": "Loader.html#property_combine", "access": "", "host": "Loader", "type": "property", "name": "combine"}, {"url": "Loader.html#property_comboBase", "access": "", "host": "Loader", "type": "property", "name": "comboBase"}, {"url": "Loader.html#property_context", "access": "", "host": "Loader", "type": "property", "name": "context"}, {"url": "Loader.html#property_cssAttributes", "access": "", "host": "Loader", "type": "property", "name": "cssAttributes"}, {"url": "Loader.html#property_data", "access": "", "host": "Loader", "type": "property", "name": "data"}, {"url": "Loader.html#property_dirty", "access": "", "host": "Loader", "type": "property", "name": "dirty"}, {"url": "Loader.html#property_filter", "access": "", "host": "Loader", "type": "property", "name": "filter"}, {"url": "Loader.html#property_filters", "access": "", "host": "Loader", "type": "property", "name": "filters"}, {"url": "Loader.html#property_force", "access": "", "host": "Loader", "type": "property", "name": "force"}, {"url": "Loader.html#method_formatSkin", "access": "", "host": "Loader", "type": "method", "name": "formatSkin"}, {"url": "Loader.html#method_getLangPackName", "access": "", "host": "Loader", "type": "method", "name": "getLangPackName"}, {"url": "Loader.html#method_getProvides", "access": "", "host": "Loader", "type": "method", "name": "getProvides"}, {"url": "Loader.html#method_getRequires", "access": "", "host": "Loader", "type": "method", "name": "getRequires"}, {"url": "Loader.html#property_ignore", "access": "", "host": "Loader", "type": "property", "name": "ignore"}, {"url": "Loader.html#property_ignoreRegistered", "access": "", "host": "Loader", "type": "property", "name": "ignoreRegistered"}, {"url": "Loader.html#method_insert", "access": "", "host": "Loader", "type": "method", "name": "insert"}, {"url": "Loader.html#property_insertBefore", "access": "", "host": "Loader", "type": "property", "name": "insertBefore"}, {"url": "Loader.html#property_inserted", "access": "", "host": "Loader", "type": "property", "name": "inserted"}, {"url": "Loader.html#property_jsAttributes", "access": "", "host": "Loader", "type": "property", "name": "jsAttributes"}, {"url": "Loader.html#property_loaded", "access": "", "host": "Loader", "type": "property", "name": "loaded"}, {"url": "Loader.html#method_loadNext", "access": "", "host": "Loader", "type": "method", "name": "loadNext"}, {"url": "Loader.html#property_loadOptional", "access": "", "host": "Loader", "type": "property", "name": "loadOptional"}, {"url": "Loader.html#property_maxURLLength", "access": "", "host": "Loader", "type": "property", "name": "maxURLLength"}, {"url": "Loader.html#property_moduleInfo", "access": "", "host": "Loader", "type": "property", "name": "moduleInfo"}, {"url": "Loader.html#method_onCSS", "access": "", "host": "Loader", "type": "method", "name": "onCSS"}, {"url": "Loader.html#method_onFailure", "access": "", "host": "Loader", "type": "method", "name": "onFailure"}, {"url": "Loader.html#method_onProgress", "access": "", "host": "Loader", "type": "method", "name": "onProgress"}, {"url": "Loader.html#method_onSuccess", "access": "", "host": "Loader", "type": "method", "name": "onSuccess"}, {"url": "Loader.html#method_onTimeout", "access": "", "host": "Loader", "type": "method", "name": "onTimeout"}, {"url": "Loader.html#property_patterns", "access": "", "host": "Loader", "type": "property", "name": "patterns"}, {"url": "Loader.html#method_require", "access": "", "host": "Loader", "type": "method", "name": "require"}, {"url": "Loader.html#property_required", "access": "", "host": "Loader", "type": "property", "name": "required"}, {"url": "Loader.html#property_rollups", "access": "", "host": "Loader", "type": "property", "name": "rollups"}, {"url": "Loader.html#property_root", "access": "", "host": "Loader", "type": "property", "name": "root"}, {"url": "Loader.html#property_skin", "access": "", "host": "Loader", "type": "property", "name": "skin"}, {"url": "Loader.html#property_skipped", "access": "", "host": "Loader", "type": "property", "name": "skipped"}, {"url": "Loader.html#property_sorted", "access": "", "host": "Loader", "type": "property", "name": "sorted"}, {"url": "Loader.html#property_timeout", "access": "", "host": "Loader", "type": "property", "name": "timeout"}];
</script>
</body>
</html>
