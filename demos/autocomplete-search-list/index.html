<!DOCTYPE html>

<html>
<head>
	<script src="../../build/aui/aui.js" type="text/javascript"></script>

	<link rel="stylesheet" href="../../build/aui-skin-classic/css/aui-skin-classic-all-min.css" type="text/css" media="screen" />

	<style type="text/css" media="screen">
		body {
			font-size: 12px;
			margin: 10px;
		}

		#demo {
			margin: 10px 0;
		}

		#wrapper {
			padding: 10px;
		}

		#tags-selected {
			border-radius: 0px 0px 0px 0px;
			height: 20px;
			width: 400px;
		}
	</style>
</head>

<body class ="yui3-skin-sam">

<div id="wrapper">
	<h1>Alloy - AutocompleteSearchList - Tags Selector Demo</h1>

	<div id="tags-div" style="width: 719px;">
		<input id="tags-selected" class="aui-field-input aui-field-input-text" type="text"/>
	</div>

	<div id="demo"></div>
</div>

<script type="text/javascript" charset="utf-8">
AUI().ready('aui-aria', 'aui-autocomplete-search-list', 'aui-dialog', 'aui-overlay-manager', 'aui-template', 'autocomplete-base', 'dd-constrain', function(A) {
	var CSS_NO_MATCHES = 'no-matches';
	var NO_RESULTS_MESSAGE = 'No results found.'
	var STR_BLANK = '';

	var template = new A.Template(
		'<fieldset class="{[(!values.results || !values.results.length) ? "', CSS_NO_MATCHES, '" : "', STR_BLANK ,'" ]}">',
			'<tpl for="results">',
				'<label title="{text}"><input {[values.checked ? "checked" : ""]} type="checkbox" value="{text}" />{text}</label>',
			'</tpl>',
			'<div class="no-matches-message">{[(!values.results || !values.results.length) ? "', NO_RESULTS_MESSAGE ,'" : ""]}</div>',
		'</fieldset>'
	);

	var toolItemConfig = {
		activeState: null,
		render: '#demo'
	};

	var buttonItems = ['add', 'select', 'suggest'];

	var i = buttonItems.length;

	for (var i = 0; i < buttonItems.length; i++) {
		var buttonText = buttonItems[i];

		toolItemConfig.label = buttonText;
		toolItemConfig.id = buttonText;
		toolItemConfig.title = buttonText;

		new A.ButtonItem(toolItemConfig);
	}

	var source = [
		{
			text: "Tag 1"
		},
		{
			text: "Tag 2"
		},
		{
			text: "Tag 3"
		}
	];

	var popup;

	var select = A.one('#select');

	select.on(
		'click',
		function() {
			if (!popup) {
				popup = new A.Dialog(
					{
						constrain2view: true,
						draggable: true,
						height: 300,
						title: 'Autocomplete Search List',
						width: 265,
						xy: [200, 50]
					}
				);

				popup.plug(
					A.AutocompleteSearchList,
					{
						inputSelector: '#tags-selected',
						noResultsMessage: NO_RESULTS_MESSAGE,
						resultHighlighter: 'phraseMatch',
						resultTextLocator: 'text',
						template: template,
						// templateType: 'asset-tags-selector',
						searchInitially: true,
						source: source
					}
				);

				popup.render();
			}
			else {
				popup.show();
			}
		}
	);
});
</script>

</body>
</html>