AUI.add("aui-scheduler-base",function(ak){var W=ak.Lang,aI=W.isString,G=W.isObject,b=W.isArray,f=W.isDate,P=W.isNumber,O=function(A){return(A instanceof ak.Scheduler);},x=function(A){return(A instanceof ak.SchedulerView);},ah=function(A){return(A instanceof ak.SchedulerEvent);},z=function(A){return(ak.SchedulerCalendar&&(A instanceof ak.SchedulerCalendar));},k=ak.DataType.DateMath,ad=ak.WidgetStdMod,aG="-",ab=".",s="",t=" ",v="scheduler-base",aq="data-view-name",M="activeView",r="boundingBox",aH="clearfix",L="controls",at="controlsNode",aw="current",aj="currentDate",af="currentDateNode",ar="date",ai="dateFormat",aC="day",ap="endDate",aJ="events",I="firstDayOfWeek",aO="hd",aF="headerNode",p="helper",Z="icon",m="iconNextNode",aB="iconPrevNode",aM="locale",h="month",o="name",X="nav",T="navNode",q="next",e="nextDate",aE="prev",au="prevDate",aN="rendered",S="scheduler",ax="srcNode",aL="startDate",J="strings",az="template",g="today",al="todayNode",B="triggerNode",E="view",aP="views",ae="viewsNode",V="week",w="year",aA="navigationDateFormat",U="eventRecorder",F=ak.getClassName,am=F(p,aH),l=F(Z),ay=F(v,L),aa=F(v,aw,ar),j=F(v,aO),ac=F(v,Z,q),H=F(v,Z,aE),aK=F(v,X),D=F(v,g),ag=F(v,E),u=F(v,aP),i=F(v,E,s),y=F(v,E,aC),a=F(v,E,h),c=F(v,E,V),ao=F(v,E,w),K=F(S,E,s),av='<div class="'+ay+'"></div>',C='<div class="'+aa+'"></div>',d='<div class="'+j+'"></div>',aQ='<a href="#" class="'+[l,ac].join(t)+'">Next</a>',an='<a href="#" class="'+[l,H].join(t)+'">Prev</a>',n='<div class="'+aK+'"></div>',Y='<a href="#" class="'+D+'">{today}</a>',aD='<a href="#" class="'+[ag,i].join(t)+'{name}" data-view-name="{name}">{label}</a>',Q='<div class="'+u+'"></div>';var R=function(){};R.ATTRS={events:{value:[],setter:"_setEvents",validator:b}};ak.mix(R.prototype,{addEvent:function(aR){var A=this;var aS=A.get(aJ);if(ak.Array.indexOf(aS,aR)>-1){ak.Array.removeItem(aS,aR);}aS.push(aR);A.set(aJ,aS);},addEvents:function(aR){var A=this;ak.Array.each(A._normalizeEvents(aR),ak.bind(A.addEvent,A));},eachEvent:function(aS){var A=this;var aR=A.get(aJ);ak.Array.each(aR,aS,A);},removeEvent:function(aR){var A=this;var aS=A.get(aJ);ak.Array.removeItem(aS,aR);A.set(aJ,aS);},removeEvents:function(aR){var A=this;ak.Array.each(A._normalizeEvents(aR),ak.bind(A.removeEvent,A));},_normalizeEvents:function(aS){var A=this;var aR=[];aS=ak.Array(aS);ak.Array.each(aS,function(aT,aU){if(ah(aT)){aR.push(aT);}else{if(z(aT)){aR=aR.concat(A._normalizeEvents(aT.get(aJ)));}else{aT=new ak.SchedulerEvent(aT);aR.push(aT);}}if(O(A)){aT.set(S,A);}});return aR;},_setEvents:function(aR){var A=this;return A._normalizeEvents(aR);}});ak.SchedulerEventSupport=R;var N=ak.Component.create({NAME:v,ATTRS:{activeView:{validator:x},eventRecorder:{setter:"_setEventRecorder"},strings:{value:{day:"Day",month:"Month",today:"Today",week:"Week",year:"Year"}},navigationDateFormat:{getter:function(aS){var A=this;var aR=A.get(M);if(aR){return aR.get(aA);}return aS;},value:"%A - %d %b %Y",validator:aI},views:{setter:"_setViews",value:[]},currentDate:{valueFn:function(){return new Date();},validator:f},firstDayOfWeek:{value:0,validator:P},controlsNode:{valueFn:function(){return ak.Node.create(av);}},currentDateNode:{valueFn:function(){return ak.Node.create(C);}},headerNode:{valueFn:function(){return ak.Node.create(d);}},iconNextNode:{valueFn:function(){return ak.Node.create(aQ);}},iconPrevNode:{valueFn:function(){return ak.Node.create(an);}},navNode:{valueFn:function(){return ak.Node.create(n);}},todayNode:{valueFn:function(){return ak.Node.create(this._processTemplate(Y));}},viewsNode:{valueFn:function(){return ak.Node.create(Q);}}},HTML_PARSER:{controlsNode:ab+ay,currentDateNode:ab+aa,headerNode:ab+j,iconNextNode:ab+ac,iconPrevNode:ab+H,navNode:ab+aK,todayNode:ab+D,viewsNode:ab+u},UI_ATTRS:[aj],AUGMENTS:[ak.SchedulerEventSupport,ak.WidgetStdMod],prototype:{viewStack:null,initializer:function(){var A=this;A.viewStack={};A.controlsNode=A.get(at);A.currentDateNode=A.get(af);A.iconNextNode=A.get(m);A.iconPrevNode=A.get(aB);A.navNode=A.get(T);A.schedulerHeaderNode=A.get(aF);A.todayNode=A.get(al);A.viewsNode=A.get(ae);A.after({render:A._afterRender,activeViewChange:A._afterActiveViewChange});},bindUI:function(){var A=this;A._bindDelegate();},syncUI:function(){var A=this;A.syncStdContent();},flushEvents:function(){var A=this;ak.Array.each(A.get(aJ),function(aR,aS){aR.eachRepeatedEvent(function(aU,aT){delete aU._filtered;});delete aR._filtered;});},getEventsByDay:function(aR){var A=this;aR=k.safeClearTime(aR);return A._getEvents(aR,function(aS){return k.compare(aS.getClearStartDate(),aR);});},getIntersectEvents:function(aR){var A=this;aR=k.safeClearTime(aR);return A._getEvents(aR,function(aT){var aS=aT.getClearStartDate();var aU=aT.getClearEndDate();return(k.compare(aR,aS)||k.compare(aR,aU)||k.between(aR,aS,aU));});},sortEventsByDateAsc:function(aR){var A=this;aR.sort(function(aV,aT){var aU=aV.get(ap);var aS=aT.get(ap);var aX=aV.get(aL);var aW=aT.get(aL);if(k.after(aX,aW)||k.compare(aX,aW)&&k.before(aU,aS)){return 1;}else{return -1;}});},getViewByName:function(aR){var A=this;return A.viewStack[aR];},getStrings:function(){var A=this;return A.get(J);},getString:function(aR){var A=this;return A.getStrings()[aR];},renderView:function(aR){var A=this;if(aR){aR.show();if(!aR.get(aN)){var aS=aR.get(o);if(!A.bodyNode){A.setStdModContent(ad.BODY,s);}aR.render(A.bodyNode);}}},plotViewEvents:function(aR){var A=this;aR.plotEvents(A.get(aJ));},syncEventsUI:function(){var A=this;A.plotViewEvents(A.get(M));},_afterActiveViewChange:function(aT){var aR=this;if(aR.get(aN)){var aS=aT.newVal;var A=aT.prevVal;if(A){A.hide();}aR.renderView(aS);}},_afterRender:function(aR){var A=this;A.renderView(A.get(M));},_bindDelegate:function(){var A=this;A.viewsNode.delegate("click",A._onClickViewTrigger,ab+ag,A);A.controlsNode.delegate("click",A._onClickPrevIcon,ab+H,A);A.controlsNode.delegate("click",A._onClickNextIcon,ab+ac,A);A.controlsNode.delegate("click",A._onClickToday,ab+D,A);},_createViewTriggerNode:function(aR){var A=this;
if(!aR.get(B)){var aS=aR.get(o);aR.set(B,ak.Node.create(W.sub(aD,{name:aS,label:(A.getString(aS)||aS)})));}return aR.get(B);},_getEvents:function(aR,aT){var A=this;var aS=A.get(aJ);var aU=[];ak.Array.each(aS,function(aV,aW){if(aT.apply(A,[aV])){aU.push(aV);}else{if(aV.isRepeatableDate(aR)){var aX=aV.repeatByDate(aR);aU.push(aX);}}});A.sortEventsByDateAsc(aU);return aU;},_onClickToday:function(aR){var A=this;A.set(aj,A.get(M).getToday());aR.preventDefault();},_onClickNextIcon:function(aR){var A=this;A.set(aj,A.get(M).get(e));aR.preventDefault();},_onClickPrevIcon:function(aR){var A=this;A.set(aj,A.get(M).get(au));aR.preventDefault();},_onClickViewTrigger:function(aS){var A=this;var aT=aS.currentTarget;var aU=aT.attr(aq);var aR=A.getViewByName(aU);A.set(M,aR);aS.preventDefault();},_processTemplate:function(aR){var A=this;return W.sub(aR,A.getStrings());},_setEventRecorder:function(aR){var A=this;if(aR){aR.set(S,A);}},_setViews:function(aS){var A=this;var aR=[];ak.Array.each(aS,function(aT){if(x(aT)&&!aT.get(aN)){aT.set(S,A);aR.push(aT);A.viewStack[aT.get(o)]=aT;}});if(!A.get(M)){A.set(M,aS[0]);}return aR;},syncStdContent:function(){var A=this;var aR=A.get(aP);A.navNode.append(A.iconPrevNode);A.navNode.append(A.iconNextNode);A.controlsNode.append(A.todayNode);A.controlsNode.append(A.navNode);A.controlsNode.append(A.currentDateNode);ak.Array.each(aR,function(aS){A.viewsNode.append(A._createViewTriggerNode(aS));});A.schedulerHeaderNode.append(A.controlsNode);A.schedulerHeaderNode.append(A.viewsNode);A.schedulerHeaderNode.addClass(am);A.setStdModContent(ad.HEADER,A.schedulerHeaderNode.getDOM());},_uiSetCurrentDate:function(aV){var aS=this;var aR=aS.get(aA);var A=aS.get(aM);var aU=ak.DataType.Date.format(aV,{format:aR,locale:A});aS.currentDateNode.html(aU);if(aS.get(aN)){var aT=aS.get(M);if(aT){aT._uiSetCurrentDate(aV);}aS.syncEventsUI();}}}});ak.Scheduler=N;},"@VERSION@",{skinnable:true,requires:["aui-scheduler-view","datasource"]});AUI.add("aui-scheduler-view",function(b6){var cn=b6.Lang,cE=cn.isObject,bV=cn.isString,aU=cn.isBoolean,aG=cn.isNumber,be=function(A){return A==0?0:(A<0?-1:1);},aK=function(A,cI){return Math.max(Math.abs(A),cI)*be(A);},bI=function(A){return parseFloat(A)||0;},bK=function(cI,A){return Math.round(cI/A)*A;},aq=b6.DataType.DateMath,b2=b6.WidgetStdMod,aL=aq.WEEK_LENGTH,bM="scheduler-view",aF="scheduler-view-day",ca="scheduler-view-week",cx="scheduler-view-month",bH="activeView",a6="am",u="borderLeftWidth",ce="borderRightWidth",aQ="boundingBox",q="children",bx="childNodes",ag="col",I="colblank",y="coldata",aI="colday",a="colgrid",bs="colmonth",W="colspan",m="coltime",cs="columnNode",ax="colDaysNode",b8="colHeaderDaysNode",aO="container",aM="content",cu="contentBox",av="createDocumentFragment",bb="currentDate",by="data",ba="dateFormat",ck="day",U="days",E="delegateConfig",bF="disabled",X="div",bk="division",ab="down",cc="dragNode",bU="duration",aA="endDate",a2="event",b0="events",cG="eventRecorder",s="eventWidth",aH="first",cb="firstDayOfWeek",a8="grid",cF="hd",b4="header",a9="headerDateFormat",cB="headerTableNode",bP="height",aP="host",aE="hourHeight",v="icon",ak="isoTime",bf="labelAM",aC="labelPM",aR="left",ay="locale",ac="marker",a4="markercell",aX="markercellsNode",bN="markercellNode",L="markers",bD="month",a7="monthContainerNode",bB="navigationDateFormat",aN="next",bL="nextDate",cH="node",aj="nomonth",ar="noscroll",b3="offsetHeight",K="offsetTop",b5="offsetWidth",cj="ownerDocument",b7="pad",cp="parentEvent",R="parentNode",an="pm",aa="prevDate",br="proxy",ah="px",aS="rendered",b1="repeated",aY="right",bp="row",r="scheduler",aD="scheduler-event",Y="scrollable",T="shim",b9="startDate",aT="table",cv="tableColNode",j="tableDataNode",D="tableGridNode",bv="tableNode",bW="tableTimeNode",bt="tbody",e="td",bm="time",ai="timesNode",g="title",al="today",bq="top",cC="tr",z="trigger",cq="week",bz="width",bJ="-",k="a",bO=".",bG="",bA="%",V=" ",F=b6.getClassName,bl=F(bM,ar),ad=F(bM,Y);var aW=b6.Component.create({NAME:bM,AUGMENTS:[b6.WidgetStdMod],ATTRS:{bodyContent:{value:bG},height:{value:600},isoTime:{value:false,validator:aU},name:{value:bG,validator:bV},navigationDateFormat:{value:"%A - %d %b %Y",validator:bV},nextDate:{getter:"getNextDate",readOnly:true},prevDate:{getter:"getPrevDate",readOnly:true},scheduler:{lazyAdd:false,setter:"_setScheduler"},scrollable:{value:true,validator:aU},triggerNode:{setter:b6.one},visible:{value:false}},BIND_UI_ATTRS:[Y],prototype:{initializer:function(){var A=this;A.after("render",A._afterRender);},syncUI:function(){var A=this;A.syncStdContent();},adjustCurrentDate:function(){var A=this;var cJ=A.get(r);var cI=cJ.get(bb);cJ.set(bb,cI);},flushViewCache:function(){},getNextDate:function(){},getPrevDate:function(){},getToday:function(){return aq.clearTime(new Date());},limitDate:function(cI,cJ){var A=this;if(aq.after(cI,cJ)){cI=aq.clone(cJ);}return cI;},plotEvents:function(A){},syncStdContent:function(){},syncEventUI:function(A){},_uiSetCurrentDate:function(A){},_afterRender:function(cJ){var A=this;var cI=A.get(r);A.adjustCurrentDate();A._uiSetScrollable(A.get(Y));},_setScheduler:function(cJ){var A=this;var cI=A.get(r);if(cI){A.removeTarget(cI);}if(cJ){A.addTarget(cJ);cJ.after("eventsChange",b6.bind(A.flushViewCache,A));}return cJ;},_uiSetScrollable:function(cJ){var A=this;var cI=A.bodyNode;if(cI){cI.toggleClass(ad,cJ);cI.toggleClass(bl,!cJ);}},_uiSetVisible:function(cI){var A=this;aW.superclass._uiSetVisible.apply(this,arguments);if(cI&&A.get(aS)){A.adjustCurrentDate();}}}});b6.SchedulerView=aW;var cn=b6.Lang,bE=cn.sub;var O=function(A,cI){return function(cK){var cJ=cK.all(A);return(cJ.size()>=cI)?cJ:null;};},aJ=F(aD),bh=F(aD,bF),bR=F(aD,br),B=F(bM,y),c=F(bM,a),Q=F(r,al),ap=F(r,al,cF),cf=F(bM,a8),cg=F(bM,a8,aO),ci=F(bM,a4),M=F(bM,L),bj=F(bM,ac,bk),bw=F(bM,aT),cm=F(bM,ck,b4,aT),t=F(bM,ck,b4,ck),bi=F(bM,ck,b4,ck,b7,aY),bT=F(bM,ck,b4,ck,aH),a1=F(bM,ck,b4,ag),cz=F(bM,aT,ag),aB=F(bM,aT,ag,T),P=F(bM,aT,I),H=F(bM,aT,aI),n=F(bM,aT,aI,b4),cr=F(bM,aT,m),bo=F(bM,aT,bm),ae='<div class="'+ci+'">'+'<div class="'+bj+'"></div>'+"</div>",au='<table class="'+bw+'">'+"<tbody>"+'<tr class="'+c+'" height="1">'+'<td height="0" class="'+[cz,P].join(V)+'"></td>'+'<td class="'+cg+'" colspan="1">'+'<div class="'+cf+'">'+'<div class="'+M+'"></div>'+"</div>"+"</td>"+"</tr>"+'<tr class="'+B+'">'+'<td class="'+[cz,cr].join(V)+'"></td>'+"</tr>"+"</tbody>"+"</table>",bd='<td class="'+[cz,H].join(V)+'">'+'<div class="'+aB+'"></div>'+"</td>",i='<div class="'+bo+'">{hour}</div>',aw='<table class="'+cm+'">'+"<tbody>"+'<tr class="'+a1+'"></tr>'+"</tbody>"+"</table>",bg='<th class="'+t+'"><a href="#">&nbsp;</a></th>',at='<td class="'+[t,bT].join(V)+'"></td>',w='<th class="'+[t,bi].join(V)+'">&nbsp;</th>';
var cA=b6.Component.create({NAME:aF,ATTRS:{bodyContent:{value:bG},days:{value:1,validator:aG},delegateConfig:{value:{},setter:function(cI){var A=this;return b6.merge({bubbleTargets:A,container:A.get(aQ),nodes:bO+aJ,invalid:"input, select, button, a, textarea, "+bO+bh},cI||{});},validator:cE},headerDateFormat:{value:"%a %d/%m",validator:bV},name:{value:ck},hourHeight:{value:52,validator:aG},eventWidth:{value:95,validator:aG},headerTableNode:{valueFn:function(){return b6.Node.create(aw);}},tableNode:{valueFn:function(){return b6.Node.create(au);}},colDaysNode:{valueFn:"_valueColDaysNode"},colHeaderDaysNode:{valueFn:"_valueColHeaderDaysNode"},markercellsNode:{valueFn:"_valueMarkercellsNode"},timesNode:{valueFn:"_valueTimesNode"}},HTML_PARSER:{colHeaderDaysNode:O(bO+t,2),colDaysNode:O(bO+H,1),markercellsNode:O(bO+ci,24),timesNode:O(bO+bo,24),headerTableNode:bO+cm,tableNode:bO+bw},EXTENDS:b6.SchedulerView,prototype:{initializer:function(){var A=this;A.colDaysNode=A.get(ax);A.colHeaderDaysNode=A.get(b8);A.headerTableNode=A.get(cB);A.markercellsNode=A.get(aX);A.tableNode=A.get(bv);A.timesNode=A.get(ai);A.colShimNodes=A.colDaysNode.all(bO+aB);A.colDataNode=A.tableNode.one(bO+B);A.colTimeNode=A.tableNode.one(bO+cr);A.dayHeaderColNode=A.headerTableNode.one(bO+a1);A.gridContainer=A.tableNode.one(bO+cg);A.markersNode=A.tableNode.one(bO+M);},renderUI:function(){var A=this;A.colTimeNode.setContent(A.timesNode);A.markersNode.setContent(A.markercellsNode);A.colDaysNode.appendTo(A.colDataNode);A.colHeaderDaysNode.appendTo(A.dayHeaderColNode);},bindUI:function(){var A=this;A.headerTableNode.delegate("click",b6.bind(A._onClickDaysHeader,A),bO+t);A.colDataNode.delegate("mousedown",b6.bind(A._onMouseDownTableCol,A),bO+cz);A.colDataNode.delegate("mouseup",b6.bind(A._onMouseUpTableCol,A),bO+cz);A.colDataNode.delegate("mousemove",b6.bind(A._onMouseMoveTableCol,A),bO+cz);A.on("drag:end",A._onEventDragEnd);A.on("drag:start",A._onEventDragStart);A.on("drag:align",A._dragAlign);A.on("drag:tickAlignX",A._dragTickAlignX);A.on("drag:tickAlignY",A._dragTickAlignY);},syncUI:function(){var A=this;cA.superclass.syncUI.apply(this,arguments);A.gridContainer.attr(W,A.get(U));A._setupDragDrop();},syncStdContent:function(){var A=this;A.setStdModContent(b2.BODY,A.tableNode.getDOM());A.setStdModContent(b2.HEADER,A.headerTableNode.getDOM());},calculateTopByDate:function(cK){var cI=this;var A=cI.get(aE);var cJ=cK.getHours();var cL=cK.getMinutes();var cM=cK.getSeconds();return((cJ*60)+cL+(cM/60))*(A/60);},calculateHoursByTop:function(cL){var cI=this;var A=cI.get(aE);var cN=bI((cL/A).toFixed(2));var cM=0;var cK=Math.floor((cN*100)%100*0.6);var cJ=Math.floor(cN);return[cJ,cK,cM];},getNextDate:function(){var A=this;var cJ=A.get(r);var cI=cJ.get(bb);return aq.add(cI,aq.DAY,1);},getPrevDate:function(){var A=this;var cJ=A.get(r);var cI=cJ.get(bb);return aq.subtract(cI,aq.DAY,1);},getColumnByDate:function(cJ){var A=this;var cK=A.get(r);var cI=aq.safeClearTime(cK.get(bb));var cL=aq.getDayOffset(aq.safeClearTime(cJ),cI);return A.colDaysNode.item(cL);},getDateByColumn:function(cJ){var A=this;var cK=A.get(r);var cI=aq.safeClearTime(cK.get(bb));return aq.add(cI,aq.DAY,cJ);},plotEvents:function(cJ){var A=this;var cI=A.get(r);A.colShimNodes.each(function(cN,cM){var cL=A.getDateByColumn(cM);var cK=cI.getEventsByDay(cL);cN.empty();b6.Array.each(cK,function(cO,cP){if(!cO.isDayOverlapEvent()){cN.append(cO.get(cH));cO.set(cs,cN.get(R));A.syncEventTopUI(cO);A.syncEventHeightUI(cO);}});A.syncEventsIntersectionUI(cK);});},syncColumnsUI:function(){var A=this;A.colDaysNode.each(function(cK,cJ){var cI=A.getDateByColumn(cJ);cK.toggleClass(Q,aq.isToday(cI));});},syncDaysHeaderUI:function(){var cJ=this;var cL=cJ.get(r);var cK=cL.get(bb);var cI=cJ.get(a9);var A=cJ.get(ay);cJ.colHeaderDaysNode.all(k).each(function(cO,cN){var cM=aq.add(cK,aq.DAY,cN);var cP=b6.DataType.Date.format(cM,{format:cI,locale:A});cO.toggleClass(ap,aq.isToday(cM));cO.html(cP);});},syncEventsIntersectionUI:function(cI){var A=this;var cJ=A.get(r);var cK=A.get(s);cJ.flushEvents();b6.Array.each(cI,function(cM,cN){var cP=A.findEventIntersections(cM,cI);var cO=cP.length;var cL=(cK/cO);b6.Array.each(cP,function(cR,cS){var cQ=cR.get(cH);var cU=cL*cS;var cT=cL*1.7;if(cS==(cO-1)){cT=cK-cU;}cQ.setStyle(bz,cT+bA);cQ.setStyle(aR,cU+bA);var cV=cQ.get(R);if(cV){cV.insert(cQ,cS);}cR._filtered=true;});});},syncEventHeightUI:function(cJ){var cI=this;var A=cI.get(aE);var cL=cI.calculateTopByDate(cJ.get(b9));var cK=cI.calculateTopByDate(cJ.get(aA));cJ.get(cH).set(b3,Math.max(cK-cL,A/2));},syncEventRecorderUI:function(cK){var A=this;var cJ=A.get(r);var cL=cJ.get(cG);var cI=cL.get(cH);if(cK&&!cI.inDoc()){cK.append(cI);}A.syncEventTopUI(cL);A.syncEventHeightUI(cL);},syncEventTopUI:function(cJ){var cI=this;var A=cJ.get(cH);var cK=cI.calculateTopByDate(cJ.get(b9));A.setStyle(bq,cK+ah);},findEventIntersections:function(cI,cJ){var A=this;var cK=[];b6.Array.each(cJ,function(cM,cL){if(!cI._filtered&&!cM.isDayOverlapEvent()&&cI.intersectHours(cM)){cK.push(cM);}});return cK;},_createEvents:function(){var A=this;var cI=function(cJ,cK){A.publish(cJ,{defaultFn:cK,queuable:false,emitFacade:true,bubbles:true});};},_dragTickAlignX:function(cI){var cR=this;var cS=cI.target.get(aP);var cT=cR._getColumnRefWidth();var cL=cS.get(cH);var cO=cR.proxyEvt;var cP=cL.getData(aD);var cQ=(cS.actXY[0]-cR.bodyNode.getX()-cR.colTimeNode.get(b5));var cJ=Math.floor(cQ/cT);var cN=cR.colDaysNode.item(cJ);var cM=cR.getDateByColumn(cJ);var A=aq.clone(cM);var cK=aq.clone(cM);aq.copyHours(cK,cO.get(aA));aq.copyHours(A,cO.get(b9));cO.set(aA,cK);cO.set(b9,A);},_dragTickAlignY:function(cJ){var cO=this;var cP=cJ.target.get(aP);var cL=cP.get(cH);var cM=cO.proxyEvt;var cN=cL.getData(aD);var cI=aq.clone(cM.get(b9));var A=cO.calculateHoursByTop(bI(cP.get(cc).getComputedStyle(bq)));cO._setTickedHours(cI,A);var cK=aq.clone(cI);cM.set(aA,aq.add(cK,aq.MINUTES,cO._currentEvtDuration));cM.set(b9,cI);cM.syncNodeTitleUI();},_getXYDelta:function(cI){var A=this;var cK=cI.currentTarget;
var cJ=cK.getXY(),cL=[cI.pageX,cI.pageY];return b6.Array.map(cJ,function(cN,cM){return(cL[cM]-cN);});},_getTickY:function(){var A=this;return bK(Math.ceil(A.get(aE)/2),10);},_getColumnRefWidth:function(){var A=this;var cI=A.colDaysNode.item(0);return bI(cI.getStyle(bz))-bI(cI.getStyle(ce))-bI(cI.getStyle(u));},_setupDragDrop:function(){var cJ=this;var cK=cJ.get(aQ);if(!cJ.proxyEvt){var cL=cJ.get(r);cJ.proxyEvt=new b6.SchedulerEvent({scheduler:cL});cJ.proxyEvt.removeTarget(cL);cJ.proxyEvt.get(cH).addClass(bR);}if(!cJ.delegate){cJ.delegate=new b6.DD.Delegate(cJ.get(E));}var cI=cJ.delegate.dd;var cM=cJ.proxyEvt;var cN=cJ.get(aE)/2;var A=cJ._getColumnRefWidth();cI.unplug(b6.Plugin.DDConstrained);cI.unplug(b6.Plugin.DDNodeScroll);cI.plug(b6.Plugin.DDConstrained,{bubbleTargets:cJ,constrain:cJ.bodyNode,tickX:A,tickY:cN});cI.plug(b6.Plugin.DDNodeScroll,{node:cJ.bodyNode,scrollDelay:150});},_uiSetCurrentDate:function(cI){var A=this;A.syncColumnsUI();A.syncDaysHeaderUI();},_onClickDaysHeader:function(cK){var A=this;var cJ=A.get(r);if(cK.target.test(k)){var cL=cJ.getViewByName(ck);var cI=A.colHeaderDaysNode.indexOf(cK.currentTarget)-1;if(cL){cJ.set(bb,A.getDateByColumn(cI));cJ.set(bH,cL);}}cK.preventDefault();},_onEventDragEnd:function(A){var cO=this;var cL=cO.get(r);var cK=cO.get(aQ);var cP=cO.delegate.dd;var cJ=cP.get(cH);var cM=cO.proxyEvt;var cI=cM.get(cH);var cN=cJ.getData(aD);cJ.show();cI.hide();cK.selectable();cN.copyDates(cM);cL.syncEventsUI();},_onEventDragStart:function(A){var cO=this;var cL=cO.get(aQ);var cP=cO.delegate.dd;var cK=cP.get(cH);var cM=cO.proxyEvt;var cN=cK.getData(aD);var cJ=bI(cK.getComputedStyle(aR));if(cJ){cP.deltaXY[0]=(cJ+bI(cP.deltaXY[0]));}if(cN){var cQ=cN.get(cs);var cI=cM.get(cH);cP.set(cc,cI);cQ.append(cI);cM.copyPropagateAttrValues(cN);cO.syncEventTopUI(cM);cO.syncEventHeightUI(cM);cI.show();cO._currentEvtDuration=cN.getMinutesDuration();}cK.hide();cL.unselectable();},_onMouseDownTableCol:function(cK){var A=this;var cJ=A.get(r);var cL=cJ.get(cG);if(cL&&!cJ.get(bF)){cL.hideOverlay();if(cK.target.test(bO+aB)){var cI=A.colDaysNode.indexOf(cK.currentTarget);A.dragXY=A.startXY=A._getXYDelta(cK);A.ddStartDate=A.getDateByColumn(cI);A.ddEndDate=aq.clone(A.ddStartDate);A._setTickedHours(A.ddStartDate,A.calculateHoursByTop(A.startXY[1]));A.ddMaxDate=aq.clone(A.ddStartDate);A.ddMaxDate.setHours(23,59,59);cL.set(b9,A.ddStartDate);cL.set(aA,A.limitDate(cL.get(aA),A.ddMaxDate));cK.halt();}}},_onMouseMoveTableCol:function(cL){var A=this;var cK=A.get(r);var cO=cK.get(cG);var cM=A.ddStartDate;if(cM){A.dragXY=A._getXYDelta(cL);A._setTickedHours(A.ddEndDate,A.calculateHoursByTop(A.dragXY[1]));var cN=aq.getMinutesOffset(A.ddEndDate,cM);if((A.dragXY[1]-A.startXY[1])>0){cN=aK(cN,cO.get(bU));}var cI=A.limitDate(aq.add(cM,aq.MINUTES,cN),A.ddMaxDate);if(cN>0){cO.set(aA,cI);}else{var cJ=cO.get(aA);cO.set(b9,cI);cO.set(aA,cJ);}A.syncEventRecorderUI(cL.currentTarget);}},_onMouseUpTableCol:function(cJ){var A=this;var cI=A.get(r);var cK=cI.get(cG);if(cK&&!cI.get(bF)){if(A.ddStartDate){A.syncEventRecorderUI(cJ.currentTarget);cK.showOverlay();}A.ddEndDate=null;A.ddStartDate=null;}},_setTickedHours:function(cI,cJ){var A=this;cI.setHours(cJ[0],bK(cJ[1],A._getTickY()),cJ[2]);},_valueColDaysNode:function(){var A=this;var cJ=A.get(U);var cI=[];while(cJ--){cI.push(bd);}return b6.NodeList.create(cI.join(bG));},_valueColHeaderDaysNode:function(){var A=this;var cJ=A.get(U);var cI=[];cI.push(at);while(cJ--){cI.push(bg);}cI.push(w);return b6.NodeList.create(cI.join(bG));},_valueMarkercellsNode:function(){var A=this;var cI=[];for(var cJ=0;cJ<=23;cJ++){cI.push(ae);}return b6.NodeList.create(cI.join(bG));},_valueTimesNode:function(){var A=this;var cK=A.get(ak);var cJ=[];for(var cI=0;cI<=23;cI++){cJ.push(bE(i,{hour:cK?aq.toIsoTimeString(cI):aq.toUsTimeString(cI,false,true)}));}return b6.NodeList.create(cJ.join(bG));}}});b6.SchedulerDayView=cA;var am=b6.Component.create({NAME:ca,ATTRS:{bodyContent:{value:bG},days:{value:7},name:{value:cq}},EXTENDS:b6.SchedulerDayView,prototype:{adjustCurrentDate:function(){var A=this;var cK=A.get(r);var cI=cK.get(bb);var cJ=cK.get(cb);cK.set(bb,aq.getFirstDayOfWeek(cI,cJ));},getNextDate:function(){var A=this;var cJ=A.get(r);var cI=cJ.get(bb);var cK=A._firstDayOfWeek(cI);return aq.add(cK,aq.WEEK,1);},getPrevDate:function(){var A=this;var cJ=A.get(r);var cI=cJ.get(bb);var cK=A._firstDayOfWeek(cI);return aq.subtract(cK,aq.WEEK,1);},getToday:function(){var A=this;var cI=am.superclass.getToday.apply(this,arguments);return A._firstDayOfWeek(cI);},_firstDayOfWeek:function(cJ){var A=this;var cK=A.get(r);var cI=cK.get(cb);return aq.getFirstDayOfWeek(cJ,cI);}}});b6.SchedulerWeekView=am;var h=F(bM,bD,aO),a3=F(bM,bD,b4,ag),x=F(bM,bD,b4,ck),cw=F(bM,bD,b4,aT),bY=F(bM,bD,bp),ao=F(bM,bD,bp,aO),f=F(v),l=F(v,"arrowstop-1-l"),ct=F(v,"arrowstop-1-r"),bZ=F(bM,bD,a),b=F(bM,bD,a,al),o=F(bM,bD,a,aH),bC=F(bM,bD,aT,by),aZ=F(bM,bD,aT,by,aH),bX=F(bM,bD,aT,by,ag),cd=F(bM,bD,aT,by,ag,aH),a0=F(bM,bD,aT,by,ag,aj),aV=F(bM,bD,aT,by,ag,g),S=F(bM,bD,aT,by,ag,g,al),af=F(bM,bD,aT,by,ag,g,aH),C=F(bM,bD,aT,by,ag,g,aN),cy=F(bM,bD,aT,by,ag,g,ab),bn=F(bM,bD,aT,by,a2),d=F(bM,bD,aT,by,a2,aR),bQ=F(bM,bD,aT,by,a2,aY),p=F(bM,bD,aT,by,a2,b1),bc=F(bM,bD,aT,a8),co=F(bM,bD,aT,a8,aH),cD=F(bM,aT,bs,b4),G='<table class="'+cw+'">'+"<tbody>"+'<tr class="'+a3+'"></tr>'+"</tbody>"+"</table>",N='<th class="'+x+'"><div>&nbsp;</div></th>',cl='<div class="'+h+'">'+'<div class="'+ao+'">'+'<div class="'+bY+'" style="top: 0; height: 16.6667%;"></div>'+'<div class="'+bY+'" style="top: 16.6667%; height: 16.6667%;"></div>'+'<div class="'+bY+'" style="top: 33.3333%; height: 16.6667%;"></div>'+'<div class="'+bY+'" style="top: 50%; height: 16.6667%;"></div>'+'<div class="'+bY+'" style="top: 66.6667%; height: 16.6667%;"></div>'+'<div class="'+bY+'" style="top: 83.3333%; height: 16.6667%;"></div>'+"</div>"+"</div>",bu='<table cellspacing="0" cellpadding="0" class="'+bc+'">'+"<tbody>"+"<tr>"+'<td class="'+[bZ,o].join(V)+'">&nbsp;</td>'+'<td class="'+bZ+'">&nbsp;</td>'+'<td class="'+bZ+'">&nbsp;</td>'+'<td class="'+bZ+'">&nbsp;</td>'+'<td class="'+bZ+'">&nbsp;</td>'+'<td class="'+bZ+'">&nbsp;</td>'+'<td class="'+bZ+'">&nbsp;</td>'+"</tr>"+"</tbody>"+"</table>",bS='<table cellspacing="0" cellpadding="0" class="'+bC+'">'+"<tbody></tbody>"+"</table>",ch="<tr></tr>",a5='<td class="'+bX+'"><div></div></td>',Z='<span class="'+[f,l].join(V)+'"></span>',J='<span class="'+[f,ct].join(V)+'"></span>';
var az=b6.Component.create({NAME:cx,ATTRS:{bodyContent:{value:bG},name:{value:bD},headerDateFormat:{value:"%a"},navigationDateFormat:{value:"%b %Y"},scrollable:{value:false},monthContainerNode:{valueFn:function(){return b6.Node.create(cl);}},headerTableNode:{valueFn:function(){return b6.Node.create(G);}},colHeaderDaysNode:{valueFn:"_valueColHeaderDaysNode"},tableGridNode:{valueFn:"_valueTableGridNode"}},HTML_PARSER:{tableGridNode:O(bO+bc,7),colHeaderDaysNode:O(bO+x,7),monthContainerNode:bO+h,headerTableNode:bO+cw},EXTENDS:b6.SchedulerView,prototype:{evtDateStack:null,evtDataTableStack:null,initializer:function(){var A=this;var cI=A.get(r);A.evtDateStack={};A.evtDataTableStack={};A.colHeaderDaysNode=A.get(b8);A.headerTableNode=A.get(cB);A.monthContainerNode=A.get(a7);A.tableGridNode=A.get(D);A.dayHeaderColNode=A.headerTableNode.one(bO+a3);A.monthRows=A.monthContainerNode.all(bO+bY);A.tableGridCols=A.tableGridNode.all(e);},renderUI:function(){var A=this;A.colHeaderDaysNode.appendTo(A.dayHeaderColNode);A.monthRows.each(function(cK,cJ){var cI=A.tableGridNode.item(cJ);cK.append(cI.toggleClass(co,(cJ==0)));});},buildEventsTable:function(cI,cN){var cT=this;var cQ=5;var cK=aq.clearTime(cT._findCurrentMonthEnd());var cS=aq.clearTime(cT._findCurrentMonthStart());var cP=String(cS.getTime()).concat(cI.getTime()).concat(cN.getTime());var cO=cT.evtDataTableStack[cP];if(!cO){cO=b6.Node.create(bS);var cR=cO.one(bt);var cL=b6.Node.create(ch);cT.loopDates(cI,cN,function(cV,cU){var cW=b6.Node.create(a5);cW.addClass(aV).toggleClass(af,(cU==0)).toggleClass(S,aq.isToday(cV)).toggleClass(C,aq.isToday(aq.subtract(cV,aq.DAY,1))).toggleClass(cy,aq.isToday(aq.subtract(cV,aq.WEEK,1)));if(aq.before(cV,cS)||aq.after(cV,cK)){cW.addClass(a0);}cL.append(cW.setContent(cV.getDate()));});cR.append(cL);for(var A=0;A<cQ;A++){var cM=0;var cJ=b6.Node.create(ch);cT.loopDates(cI,cN,function(cZ,cX){if(cM<=cX){var cY=cT.getIntersectEvents(cZ),cV=cY[A];var c0=b6.Node.create(a5);if(cV){var cU=c0.one(X);var cW=cT._getEvtSplitInfo(cV,cI,cN);c0.attr(W,cW.colspan);cU.addClass(bn).setContent(cT._getEvtLabel(cV));if(cW.left){cU.addClass(d).prepend(Z);}if(cW.right){cU.addClass(bQ).append(J);}if(cV.get(cp)){cU.addClass(p);}cM+=cW.colspan;}else{cM++;}cJ.append(c0);}});cR.append(cJ);}cT.evtDataTableStack[cP]=cO;}return cO;},flushViewCache:function(){var A=this;A.evtDateStack={};A.evtDataTableStack={};},getIntersectEvents:function(cI){var A=this;var cK=A.get(r);var cJ=String(cI.getTime());if(!A.evtDateStack[cJ]){A.evtDateStack[cJ]=cK.getIntersectEvents(cI);}return A.evtDateStack[cJ];},loopDates:function(A,cK,cN,cO,cM){var cP=this;var cI=aq.clone(A);var cJ=cK.getTime();for(var cL=0;cI.getTime()<=cJ;cL++){cN.apply(cP,[cI,cL]);cI=aq.add(cI,(cO||aq.DAY),(cM||1));}},plotEvents:function(){var cI=this;var cJ=cI._findCurrentMonthStart();var A=aq.safeClearTime(cI._findFirstDayOfWeek(cJ));cI.bodyNode.all(bO+bC).remove();cI.monthRows.each(function(cN,cL){var cK=aq.add(A,aq.WEEK,cL);var cO=aq.add(cK,aq.DAY,aL-1);var cM=cI.buildEventsTable(cK,cO);if(cL==0){cM.addClass(aZ);}cN.append(cM);});},syncStdContent:function(){var A=this;A.setStdModContent(b2.BODY,A.monthContainerNode.getDOM());A.setStdModContent(b2.HEADER,A.headerTableNode.getDOM());},syncGridUI:function(){var cP=this;var cJ=cP.getToday();var cI=cP.get(r);cP.tableGridCols.removeClass(b);if(aq.isSameMonth(cJ,cI.get(bb))){var A=cI.get(cb);var cJ=cP.getToday();var cL=cP._findCurrentMonthStart();var cN=cP._findFirstDayOfWeek(cJ);var cK=aq.getWeekNumber(cJ,A)-aq.getWeekNumber(cL,A);var cO=(cJ.getDate()-cN.getDate());var cM=cP.tableGridNode.item(cK).all(e).item(cO);if(cM){cM.addClass(b);}}},adjustCurrentDate:function(){var A=this;var cI=A.get(r);cI.set(bb,A._findCurrentMonthStart());},getNextDate:function(){var A=this;var cJ=A.get(r);var cI=cJ.get(bb);return aq.add(cI,aq.MONTH,1);},getPrevDate:function(){var A=this;var cJ=A.get(r);var cI=cJ.get(bb);return aq.subtract(cI,aq.MONTH,1);},syncDaysHeaderUI:function(){var cJ=this;var cM=cJ.get(r);var cK=cM.get(bb);var cI=cJ.get(a9);var A=cJ.get(ay);var cL=cJ._findFirstDayOfWeek(cK);cJ.colHeaderDaysNode.all(X).each(function(cP,cO){var cN=aq.add(cL,aq.DAY,cO);var cQ=b6.DataType.Date.format(cN,{format:cI,locale:A});cP.html(cQ);});},_findCurrentMonthEnd:function(){var A=this;var cJ=A.get(r);var cI=cJ.get(bb);return aq.findMonthEnd(cI);},_findCurrentMonthStart:function(){var A=this;var cJ=A.get(r);var cI=cJ.get(bb);return aq.findMonthStart(cI);},_findFirstDayOfWeek:function(cJ){var A=this;var cK=A.get(r);var cI=cK.get(cb);return aq.getFirstDayOfWeek(cJ,cI);},_getEvtLabel:function(cJ){var cI=this;var cK=cJ.get(aA);var A=cJ.get(b9);return[A.getHours(),bJ,cK.getHours(),V,cJ.get(aM)].join(bG);},_getEvtSplitInfo:function(cO,A,cM){var cP=this;var cI=cO.getClearStartDate();var cN=cO.getClearEndDate();var cL=cO.getDaysDuration();var cK={};var cJ=1;if(aq.after(cI,A)){cJ=Math.min(cL,Math.abs(aq.getDayOffset(cM,cI))+1);if(cJ>1){cK.right=true;}}else{cJ=Math.abs(aq.getDayOffset(cN,A)+1);if(cJ>1){cK.left=true;}}cK.colspan=Math.min(cJ,aL);if(cJ>=aL){cK.right=true;cK.left=true;}return cK;},_uiSetCurrentDate:function(cI){var A=this;A.syncDaysHeaderUI();A.syncGridUI();},_valueColHeaderDaysNode:function(){var A=this;return A._valueNodeList(aL,N);},_valueTableGridNode:function(){var A=this;return A._valueNodeList(aL,bu);},_valueNodeList:function(cK,cJ){var A=this;var cI=[];while(cK--){cI.push(cJ);}return b6.NodeList.create(cI.join(bG));}}});b6.SchedulerMonthView=az;},"@VERSION@",{skinnable:true,requires:["aui-scheduler-event","aui-calendar","aui-button-item","dd-drag","dd-delegate","dd-drop","dd-constrain"]});AUI.add("aui-scheduler-event",function(aF){var am=aF.Lang,bh=am.isString,h=am.isDate,a5=am.isFunction,P=am.isObject,a8=am.isBoolean,aa=am.isNumber,aW=aF.ColorUtil,n=aF.DataType.DateMath,a2=aF.cached(function(A){return A.substring(0,1).toUpperCase()+A.substring(1);}),bd="-",z="&ndash;",av=".",u="",v=" ",r="_",aJ="_propagateSet",U="activeView",aD="borderStyle",bp="borderWidth",Q="Change",a1="color",aS="colorBrightnessFactor",bb="colorSaturationFactor",aB="content",ag="contentNode",B="disabled",aZ="duration",aM="endDate",bi="events",aq="hidden",ap="icon",Y="icons",a0="id",aU="isoTime",bo="locale",s="node",k="overlay",aH="parentEvent",bs="recorder",aK="repeat",bg="repeated",a6="repeater",T="repeatedEvents",af="scheduler",at="scheduler-event",au="scheduler-event-recorder",bk="startDate",a4="template",aR="title",g="titleDateFormat",N="titleNode",an="visible",f="%H:%M",a3="%I:%M",L=aF.getClassName,o=L(ap),w=L(at),aN=L(at,aB),G=L(at,aq),bf=L(at,B),ao=L(at,bs),ax=L(at,bg),al=L(at,a6),I=L(at,aR),bn=L(at,Y);
CSS_SCHEDULER_EVENT_ICON_DISABLED=L(at,ap,B),CSS_SCHEDULER_EVENT_ICON_REPEATED=L(at,ap,bg),CSS_SCHEDULER_EVENT_ICON_REPEATER=L(at,ap,a6);var V=aF.Component.create({NAME:at,ATTRS:{borderStyle:{value:"solid",validator:bh},borderWidth:{value:"1px",validator:bh},colorBrightnessFactor:{value:0.75,validator:aa},colorSaturationFactor:{value:1.5,validator:aa},content:{value:"(no title)",validator:bh},color:{lazyAdd:false,setter:"_setColor",value:"#D96666",validator:bh},titleDateFormat:{getter:"_getTitleDateFormat",validator:bh},endDate:{valueFn:function(){var A=n.clone(this.get(bk));A.setHours(A.getHours()+1);return A;},validator:h},columnNode:{setter:aF.one},disabled:{value:false,validator:a8},node:{valueFn:function(){return aF.Node.create(this.EVENT_NODE_TEMPLATE).setData(at,this);},setter:aF.one},parentEvent:{},repeat:{setter:"_setRepeat"},scheduler:{lazyAdd:false,setter:"_setScheduler"},startDate:{valueFn:function(){return new Date();},validator:h},visible:{value:true,validator:a8}},EXTENDS:aF.Base,PROPAGATE_ATTRS:[bk,aM,aB,a1,aS,bb,aD,bp,g,an,B],prototype:{EVENT_NODE_TEMPLATE:'<div class="'+w+'">'+'<div class="'+I+'"></div>'+'<div class="'+aN+'"></div>'+'<div class="'+bn+'">'+'<span class="'+[o,CSS_SCHEDULER_EVENT_ICON_REPEATED].join(v)+'"></span>'+'<span class="'+[o,CSS_SCHEDULER_EVENT_ICON_REPEATER].join(v)+'"></span>'+'<span class="'+[o,CSS_SCHEDULER_EVENT_ICON_DISABLED].join(v)+'"></span>'+"</div>"+"</div>",eventStack:null,initializer:function(){var A=this;var bu=A.get(s);A.eventStack={};A.nodeStack={};aF.Array.each(aF.SchedulerEvent.PROPAGATE_ATTRS,function(bv){A.after(bv+Q,A._propagateAttrChange);});A._bindUIAttrs();A.contentNode=bu.one(av+aN);A.titleNode=bu.one(av+I);A.syncNodeUI(true);},destroy:function(){var A=this;A.eachRepeatedEvent(function(bu,bv){bu.destroy();});A.eventStack={};A.get(s).remove(true);},copyDates:function(bu){var A=this;A.set(aM,n.clone(bu.get(aM)));A.set(bk,n.clone(bu.get(bk)));},copyPropagateAttrValues:function(bu,bv){var A=this;A.copyDates(bu);aF.Array.each(aF.SchedulerEvent.PROPAGATE_ATTRS,function(bw){if(!(bw in (bv||{}))){var bx=bu.get(bw);if(!P(bx)){A.set(bw,bx);}}});},getBorderColor:function(){var A=this;return A.borderColorRGB.hex;},getDaysDuration:function(){var A=this;return n.getDayOffset(A.get(aM),A.get(bk));},getHoursDuration:function(){var A=this;return n.getHoursOffset(A.get(aM),A.get(bk));},getMinutesDuration:function(){var A=this;return n.getMinutesOffset(A.get(aM),A.get(bk));},getSecondsDuration:function(){var A=this;return n.getSecondsOffset(A.get(aM),A.get(bk));},sameEndDate:function(bu){var A=this;return n.compare(A.get(aM),bu.get(aM));},sameStartDate:function(bu){var A=this;return n.compare(A.get(bk),bu.get(bk));},isAfter:function(bw){var bv=this;var bu=bv.get(bk);var A=bw.get(bk);return n.after(bu,A);},isBefore:function(bw){var bv=this;var bu=bv.get(bk);var A=bw.get(bk);return n.before(bu,A);},repeatByDate:function(bv){var A=this;var bw=A.uidByDate(bv);if(!A.eventStack[bw]){var bu=n.clone(bv);var bx=n.clone(bv);n.copyHours(bu,A.get(bk));n.copyHours(bx,A.get(aM));var by=new aF.SchedulerEvent({endDate:bx,parentEvent:A,scheduler:A.get(af),startDate:bu});by.copyPropagateAttrValues(A);A.eventStack[bw]=by;}return A.eventStack[bw];},intersects:function(bw){var bv=this;var bx=bv.get(aM);var bu=bv.get(bk);var A=bw.get(bk);return(bv.sameStartDate(bw)||n.between(A,bu,bx));},intersectHours:function(bv){var bu=this;var bx=bu.get(aM);var A=bu.get(bk);var bw=n.clone(A);n.copyHours(bw,bv.get(bk));return(n.compare(A,bw)||n.between(bw,A,bx));},isDayOverlapEvent:function(){var A=this;return n.isDayOverlap(A.get(bk),A.get(aM));},isRepeatableDate:function(bu){var A=this;var bv=A.get(aK);return(bv&&bv.validate(A,bu));},getClearEndDate:function(){var A=this;return n.safeClearTime(A.get(aM));},getClearStartDate:function(){var A=this;return n.safeClearTime(A.get(bk));},uidByDate:function(bu){var A=this;bu=h(bu)?n.safeClearTime(bu):A.getClearStartDate();return[at,bu.getTime()].join(r);},setContent:function(bv,bu){var A=this;A._setContent(ag,bv,bu);},setTitle:function(bv,bu){var A=this;A._setContent(N,bv,bu);},syncNodeUI:function(bu){var A=this;A._syncUIAttrs();A.syncNodeColorUI(bu);A.syncNodeTitleUI(bu);A.syncNodeContentUI(bu);},syncNodeColorUI:function(bu){var A=this;var bv=A.get(s);var bw=A.getBorderColor();if(bv){bv.setStyles({borderWidth:A.get(bp),borderColor:bw,backgroundColor:A.get(a1),borderStyle:A.get(aD)});}if(A.titleNode){A.titleNode.setStyles({backgroundColor:bw});}if(bu){A.eachRepeatedEvent(function(bx,by){bx.syncNodeColorUI();});}},syncNodeContentUI:function(bu){var A=this;A.setContent(A.get(aB),bu);},syncNodeTitleUI:function(bu){var A=this;var bv=A._formatDate(A.get(bk));var bw=A._formatDate(A.get(aM));A.setTitle([bv,bw].join(v+z+v),bu);},eachRepeatedEvent:function(bu){var A=this;aF.each(A.eventStack,bu,A);},unlink:function(){var A=this;if(A.get(aH)){A.set(aH,null);}else{A.eachRepeatedEvent(function(bu,bv){bu.unlink();});}A.eventStack={};A.syncNodeUI();},_afterDisabledChange:function(bu){var A=this;A._uiSetDisabled(bu.newVal);},_afterVisibleChange:function(bu){var A=this;A._uiSetVisible(bu.newVal);},_afterRepeatChange:function(bu){var A=this;A._uiSetRepeat(bu.newVal);},_afterParentEventChange:function(bu){var A=this;A._uiSetParentEvent(bu.newVal);},_bindUIAttrs:function(){var A=this;A.after("disabledChange",A._afterDisabledChange);A.after("visibleChange",A._afterVisibleChange);A.after("parentEventChange",A._afterParentEventChange);A.after("repeatChange",A._afterRepeatChange);A._syncUIAttrs();},_propagateAttrChange:function(bw){var A=this;var bv=bw.attrName;var bu=bw.newVal;A.eachRepeatedEvent(function(bx,by){var bz=bx[aJ+a2(bv)];if(bz){bz.apply(A,[bx,bv,bu]);}else{bx.set(bv,bw.newVal);}bx.syncNodeUI();});A.syncNodeUI();},_propagateSetEndDate:function(A,bu,bw){var bv=n.clone(A.get(aM));n.copyHours(bv,bw);A.set(aM,bv);},_propagateSetStartDate:function(bu,bv,bw){var A=n.clone(bu.get(bk));n.copyHours(A,bw);bu.set(bk,A);},_setColor:function(bu){var A=this;A.hsbColor=aW.rgb2hsb(aW.getRGB(bu));
A.borderColor=aF.clone(A.hsbColor);A.borderColor.b*=A.get(aS);A.borderColor.s*=A.get(bb);A.borderColorRGB=aW.hsb2rgb(A.borderColor);return bu;},_setContent:function(bv,bx,bu){var A=this;var bw=A[bv];if(bw){bw.setContent(bx);}if(bu){A.eachRepeatedEvent(function(by,bz){by[bv].setContent(bx);});}},_setRepeat:function(bu){var A=this;if(bh(bu)){bu=aF.SchedulerEventRepeat[bu];}return P(bu)?bu:null;},_setScheduler:function(bv){var A=this;var bu=A.get(af);if(bu){A.removeTarget(bu);}A.addTarget(bv);return bv;},_syncUIAttrs:function(){var A=this;A._uiSetDisabled(A.get(B));A._uiSetVisible(A.get(an));A._uiSetParentEvent(A.get(aH));A._uiSetRepeat(A.get(aK));},_formatDate:function(bv,bw){var bu=this;var A=bu.get(bo);bw=bw||bu.get(g);return aF.DataType.Date.format(bv,{format:bw,locale:A});},_getTitleDateFormat:function(bv){var A=this;if(!bh(bv)){var bu=A.get(af);bv=(bu&&bu.get(U).get(aU))?f:a3;}return bv;},_uiSetDisabled:function(bu){var A=this;A.get(s).toggleClass(bf,!!bu);},_uiSetParentEvent:function(bu){var A=this;A.get(s).toggleClass(ax,!!bu);},_uiSetRepeat:function(bu){var A=this;A.get(s).toggleClass(al,!!bu);},_uiSetVisible:function(bu){var A=this;A.get(s).toggleClass(G,!bu);}}});aF.SchedulerEvent=V;aF.SchedulerEventRepeat={daily:{description:"Every day",validate:function(A,bu){return true;},value:"daily"},monthly:{description:"Every month",validate:function(bu,bv){var bw=bu.get(aM);var A=bu.get(bk);return(A.getDate()===bv.getDate());},value:"monthly"},monWedFri:{description:"Every Monday, Wednesday and Friday",validate:function(A,bu){return n.isMonWedOrFri(bu);},value:"monWedFri"},tuesThurs:{description:"Every Tuesday and Thursday",validate:function(A,bu){return n.isTueOrThu(bu);},value:"tuesThurs"},weekDays:{description:"Every week days",validate:function(A,bu){return n.isWeekDay(bu);},value:"weekDays"},weekly:{description:"Every week",validate:function(bu,bv){var bw=bu.get(aM);var A=bu.get(bk);return(A.getDay()===bv.getDay());},value:"weekly"},yearly:{description:"Every year",validate:function(bu,bv){var bw=bu.get(aM);var A=bu.get(bk);return((A.getMonth()===bv.getMonth())&&(A.getDay()===bv.getDay()));},value:"yearly"}};var U="activeView",bm="bc",bl="bd",aw="bodyContent",t="boundingBox",aG="button",e="column",aB="content",aC="dateFormat",az="dblclick",aY="desc",ay="disk",br="event",a7="field",aI="fieldset",aA="form",ah="hint",ak="input",aU="isoTime",aL="label",x="layout",aQ="menu",J="overlayContextPanel",p="pencil",aK="repeat",q="row",af="scheduler",Z="select",S="strings",a="tc",M="text",X="when",j="trigger",ai="auiSchedulerEventRecorderWhen",bc="auiSchedulerEventRecorderDesc",aX="auiSchedulerEventRecorderSelect",H="auiSchedulerEventRecorderButtonRow",ae="cancel",E="edit",aE="save",bd="-",K="#",bt=L(at,bs,k),ba=L(at,bs,aA),y=L(aA),l=L(x,aB),be=L(x,aI),ar=L(x,aI,bl),ad=L(x,aI,aB),F=L(x,"w100"),m=L(e),aO=L(e,aB),b=L(a7),C=L(a7,aQ),aP=L(a7,Z),bj=L(a7,aB),d=L(a7,aL),aV=L(a7,M),i=L(aG,q),a9=L(a7,ak),aj=L(a7,ak,Z),D=L(a7,ak,M),aT=L(at,bs,aL,X),c=L(at,bs,aY),R=L(at,bs,a7,ah),ac=L(at,bs,aK),ab=L(at,bs,aG,q),O="<option></option>",bq='<form id="auiSchedulerEventRecorderForm" class="'+[ba,l,y].join(v)+'">'+'<div class="'+[be,F,m].join(v)+'">'+'<div class="'+[ad,aO].join(v)+'aui-fieldset-content aui-column-content">'+'<div class="'+ar+'">'+'<span class="'+[b,aV].join(v)+'">'+'<span class="'+bj+'">'+'<label class="'+d+'">{when}:</label>'+'<span id="auiSchedulerEventRecorderWhen" class="'+aT+'"></span>'+"</span>"+"</span>"+'<span class="'+[b,aV].join(v)+'">'+'<span class="'+bj+'">'+'<label class="'+d+'" for="auiSchedulerEventRecorderDesc">{description}</label>'+'<input id="auiSchedulerEventRecorderDesc" class="'+[a9,D,c].join(v)+'" size="30" type="text" />'+'<div class="'+R+'">'+"<span>{description-hint}</span>"+"</div>"+"</span>"+"</span>"+'<span class="'+[b,C,aP].join(v)+'">'+'<label class="'+d+'" for="auiSchedulerEventRecorderSelect">{repeat}:</label>'+'<select id="auiSchedulerEventRecorderSelect" class="'+[a9,aj,ac].join(v)+'">'+'<option selected="selected" value="">{no-repeat}</option>'+"</select>"+"</span>"+'<div id="auiSchedulerEventRecorderButtonRow" class="'+[b,i,ab].join(v)+'"></div>'+"</div>"+"</div>"+"</div>"+"</form>";var W=aF.Component.create({NAME:au,ATTRS:{content:{value:u},duration:{value:60},dateFormat:{value:"%a, %B %d,",validator:bh},event:{},strings:{value:{},setter:function(A){return aF.merge({save:"Save",cancel:"Cancel",description:"Description",edit:"Edit",repeat:"Repeat",when:"When","description-hint":"e.g., Dinner at Brian's","no-repeat":"No repeat"},A||{});},validator:P},overlayContextPanel:{value:{},setter:function(bu){var A=this;var bv=aF.Node.create(aF.Lang.sub(bq,A.get(S)));return aF.merge({align:{points:[bm,a]},anim:false,bodyContent:bv,hideOn:az,trigger:A.get(s),visible:false,zIndex:9999},bu||{});}}},EXTENDS:aF.SchedulerEvent,prototype:{initializer:function(){var A=this;A._createEvents();A.after("schedulerChange",A._afterSchedulerChange);A.on("startDateChange",A._onStartDateChange);A.get(s).addClass(ao);},showOverlay:function(){var A=this;if(!A.overlay){A._initOverlay();}A.overlay.render().show();},getEventCopy:function(bu){var A=this;var bw=A.overlayDescNode.val();var bv=A.get(br);if(!bv){bv=new aF.SchedulerEvent({endDate:A.get(aM),scheduler:A.get(af),startDate:A.get(bk)});bv.copyPropagateAttrValues(A,{content:true});}bv.set(aK,A.overlaySelectNode.val());if(bw){bv.set(aB,bw);}return bv;},hideOverlay:function(){var A=this;if(A.overlay){A.overlay.hide();}},loadFormValues:function(){var A=this;var bw=u;var bv=u;var bu=A.get(br);if(bu){var bx=bu.get(aK);if(bx){bw=bx.value;}bv=bu.get(aB);}A.overlaySelectNode.val(bw);A.overlayWhenNode.setContent(A._getWhenFormattedDt());setTimeout(function(){A.overlayDescNode.val(bv).selectText();},0);},_afterSchedulerChange:function(bw){var A=this;var bv=bw.newVal;var bu=bv.get(t);bu.delegate("click",aF.bind(A._onClickSchedulerEvent,A),av+w);},_createEvents:function(){var A=this;var bu=function(bv,bw){A.publish(bv,{defaultFn:bw,queuable:false,emitFacade:true,bubbles:true});
};bu(aE,this._defSaveEventFn);bu(E,this._defEditEventFn);bu(ae,this._defCancelEventFn);},_initOverlay:function(){var bu=this;var A=bu.get(S);bu.overlay=new aF.OverlayContextPanel(bu.get(J));var bw=bu.overlay;var bv=bw.get(t);var bx=bw.get(aw);bu.overlayButtonRowNode=bx.one(K+H);bu.overlayDescNode=bx.one(K+bc);bu.overlaySelectNode=bx.one(K+aX);bu.overlayWhenNode=bx.one(K+ai);bu.overlaySaveBtn=new aF.ButtonItem({label:A.save,icon:ay,render:bu.overlayButtonRowNode,handler:{fn:bu._handleSaveEvent,context:bu}});bu.overlayEditBtn=new aF.ButtonItem({label:A.edit,icon:p,render:bu.overlayButtonRowNode,handler:{fn:bu._handleEditEvent,context:bu}});bu.overlayCancelBtn=new aF.ButtonItem({label:A.cancel,render:bu.overlayButtonRowNode,handler:{fn:bu._handleCancelEvent,context:bu}});aF.each(aF.SchedulerEventRepeat,function(bz,by){bu.overlaySelectNode.append(aF.Node.create(O).val(bz.value||by).setContent(bz.description));});bw.on("hide",aF.bind(bu._onOverlayHide,bu));bw.on("show",aF.bind(bu._onOverlayShow,bu));bx.on("submit",aF.bind(bu._onSubmitForm,bu));bv.addClass(bt);},_defCancelEventFn:function(bu){var A=this;A.hideOverlay();},_defEditEventFn:function(bv){var A=this;var bu=A.get(af);A.hideOverlay();bu.syncEventsUI();},_defSaveEventFn:function(bv){var A=this;var bu=A.get(af);bu.addEvent(bv.newSchedulerEvent);A.hideOverlay();bu.syncEventsUI();},_getWhenFormattedDt:function(){var bv=this;var bu=bv.get(aC);var bx=(bv.get(br)||bv);var bz=bx.get(aM);var by=bx.get(af);var A=bx.get(bk);var bw=(by.get(U).get(aU)?n.toIsoTimeString:n.toUsTimeString);return[bx._formatDate(A,bu),bw(A),bd,bw(bz)].join(v);},_handleEditEvent:function(bu){var A=this;A.fire(E,{newSchedulerEvent:A.getEventCopy()});bu.preventDefault();},_handleSaveEvent:function(bu){var A=this;A.fire(aE,{newSchedulerEvent:A.getEventCopy()});bu.preventDefault();},_handleCancelEvent:function(bu){var A=this;A.fire(ae);bu.preventDefault();},_onClickSchedulerEvent:function(bv){var A=this;var bu=bv.currentTarget.getData(at);if(bu){if(!A.overlay){A._initOverlay();}A.set(br,bu);A.overlay.set(j,bu.get(s));A.get(s).remove();A.showOverlay();}},_onOverlayHide:function(bv){var A=this;var bu=A.get(s);if(A.overlay){A.set(br,null);A.overlay.set(j,bu);}bu.remove();},_onOverlayShow:function(bv){var bu=this;var bw=bu.overlayEditBtn;var A=bu.overlaySaveBtn;if(bu.get(br)){bw.show();A.hide();}else{bw.hide();A.show();}bu.loadFormValues();},_onStartDateChange:function(bu){var A=this;var bv=A.get(aZ);A.set(aM,n.add(bu.newVal,n.MINUTES,bv));},_onSubmitForm:function(bu){var A=this;if(A.get(br)){A._handleEditEvent(bu);}else{A._handleSaveEvent(bu);}}}});aF.SchedulerEventRecorder=W;},"@VERSION@",{skinnable:true,requires:["aui-base","aui-color-util","aui-datatype","aui-overlay-context-panel"]});AUI.add("aui-scheduler-calendar",function(d){var i=d.Lang,j=i.isArray,c=i.isBoolean,b=i.isString,g=function(m){return(m instanceof d.SchedulerEvent);},e="scheduler-calendar",a="color",l="events",h="pallete",k="visible";var f=d.Component.create({NAME:e,ATTRS:{color:{valueFn:function(){var n=this;var o=n.get(h);var m=Math.ceil(Math.random()*o.length)-1;return o[m];},validator:b},name:{value:"(no name)",validator:b},pallete:{value:["#d96666","#e67399","#b373b3","#8c66d9","#668cb3","#668cd9","#59bfb3","#65ad89","#4cb052","#8cbf40","#bfbf4d","#e0c240","#f2a640","#e6804d","#be9494","#a992a9","#8997a5","#94a2be","#85aaa5","#a7a77d","#c4a883","#c7561e","#b5515d","#c244ab","#603f99","#536ca6","#3640ad","#3c995b","#5ca632","#7ec225","#a7b828","#cf9911","#d47f1e","#b56414","#914d14","#ab2671","#9643a5","#4585a3","#737373","#41a587","#d1bc36","#ad2d2d"],validator:j},visible:{value:true,validator:c}},EXTENDS:d.Base,AUGMENTS:d.SchedulerEventSupport,prototype:{initializer:function(){var m=this;m.after("eventsChange",m._afterEventsChange);m.on("visibleChange",m._onVisibleChange);m._uiSetVisible(m.get(k));m._uiSetEvents(m.get(l));},syncEventsColor:function(n){var m=this;d.Array.each(n||m.get(l),function(o,p){o.set(a,m.get(a));});},_afterEventsChange:function(n){var m=this;m._uiSetEvents(n.newVal);},_onVisibleChange:function(n){var m=this;m._uiSetVisible(n.newVal);},_uiSetEvents:function(n){var m=this;m.syncEventsColor(n);},_uiSetVisible:function(n){var m=this;m.eachEvent(function(o,p){o.set(k,n);});}}});d.SchedulerCalendar=f;},"@VERSION@",{requires:["aui-scheduler-event"],skinnable:true});AUI.add("aui-scheduler",function(a){},"@VERSION@",{use:["aui-scheduler-base","aui-scheduler-view","aui-scheduler-event","aui-scheduler-calendar"],skinnable:true});