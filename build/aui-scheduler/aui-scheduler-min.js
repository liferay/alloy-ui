AUI.add("aui-scheduler-base",function(aR){var ax=aR.Lang,d=ax.isArray,bi=ax.isBoolean,k=ax.isDate,bd=ax.isFunction,ai=ax.isNumber,T=ax.isObject,bp=ax.isString,a8=aR.ColorUtil,p=aR.DataType.DateMath,aJ=aR.WidgetStdMod,aK=":",m=".",al="",E="&ndash;",bC=" ",ag=function(A){return(A instanceof aR.Scheduler);},aN=function(A){return(A instanceof aR.SchedulerEvent);},D=function(A){return(A instanceof aR.SchedulerView);},F=function(A){return(aR.SchedulerCalendar&&(A instanceof aR.SchedulerCalendar));},i="%H:%M",Z="%l",bA="%M",ay=function(A){var bE=[Z];if(A.getMinutes()>0){bE.push(aK);bE.push(bA);}if(A.getHours()>=12){bE.push("p");}return bE.join(al);},a0="data-view-name",C="scheduler-base",V="scheduler-calendar",aL="scheduler-view",ac="activeView",J="all",Y="allDay",ad="borderColor",aW="borderColorRGB",aQ="borderStyle",bx="borderWidth",aS="button",bn="clearfix",a9="color",a2="colorBrightnessFactor",bk="colorSaturationFactor",aP="content",ab="controls",a5="controlsNode",a3="date",bf="day",I="disabled",aX="endDate",aZ="eventClass",ar="eventRecorder",bq="events",bz="hd",K="header",bl="headerNode",u="helper",aE="hidden",U="hsbColor",aD="icon",r="iconNextNode",bc="iconPrevNode",ah="icons",au="inherit",a4="isoTime",bw="locale",bu="meeting",t="name",az="nav",aq="navNode",f="navigationDateFormatter",v="next",h="nextDate",x="node",av="noscroll",ak="pallete",bj="prev",a6="prevDate",be="radio",an="reminder",by="rendered",bo="repeated",ap="scheduler",aF="scheduler-event",bt="scrollable",a="short",bs="startDate",aa="strings",a1="title",j="titleDateFormat",l="today",aT="todayNode",H="triggerNode",S="view",X="viewDateNode",at="viewStack",bB="views",aI="viewsNode",aB="visible",R=aR.getClassName,aU=R(u,bn),q=R(aD),ba=R(C,ab),o=R(C,bz),aH=R(C,aD,v),W=R(C,aD,bj),br=R(C,az),P=R(C,l),aM=R(C,S),n=R(C,S,al),N=R(C,S,a3),B=R(aL,av),c=R(aL,bt),aj="yui3-button-selected",z=R(C,bB),y=R(aF),Q=R(aF,J,bf),aY=R(aF,aP),bm=R(aF,I),L=R(aF,aE),G=R(aF,aD,I),O=R(aF,aD,bu),aC=R(aF,aD,an),e=R(aF,aD,bo),bv=R(aF,ah),b=R(aF,bu),w=R(aF,an),aG=R(aF,bo),aw=R(aF,a),M=R(aF,a1),a7='<div class="'+ba+'"></div>',g='<div class="'+o+'"></div>',bD='<button type="button" class="'+[q,aH].join(bC)+' yui3-button">Next</button>',aV='<button type="button" class="'+[q,W].join(bC)+' yui3-button">Prev</button>',s='<div class="'+br+'"></div>',aA='<button type="button" class="'+P+' yui3-button">{today}</button>',bh='<button type="button" class="'+[aM,n].join(bC)+'{name}" data-view-name="{name}">{label}</button>',aO='<div class="'+N+'"></div>',am='<div class="'+z+'"></div>';var ao=function(){};ao.ATTRS={eventClass:{valueFn:function(){return aR.SchedulerEvent;}},events:{value:[],setter:"_setEvents",validator:d}};aR.mix(ao.prototype,{addEvent:function(bE){var A=this;A.addEvents([bE]);},addEvents:function(bE){var A=this,bG=A.get(bq),bF=bG.concat();bE=A._normalizeEvents(bE);aR.Array.each(bE,function(bH){if(aR.Array.indexOf(bF,bH)===-1){bF.push(bH);}});if(bF.length!==bG.length){A.set(bq,bF);}},eachEvent:function(bF){var A=this;var bE=A.getEvents(function(){return true;});aR.Array.each(bE,bF,A);},flushEvents:function(){var A=this;aR.Array.each(A.get(bq),function(bE){delete bE._filtered;});},getEventsByDay:function(bE,bF){var A=this;bE=p.safeClearTime(bE);return A.getEvents(function(bG){return p.compare(bG.getClearStartDate(),bE)||(bF&&p.compare(bG.getClearEndDate(),bE));});},getEvents:function(bG){var A=this;var bF=A.get(bq);var bE=[];aR.Array.each(bF,function(bH){if(bG.call(A,bH)){bE.push(bH);}});A.sortEventsByDateAsc(bE);return bE;},getIntersectEvents:function(bE){var A=this;bE=p.safeClearTime(bE);return A.getEvents(function(bG){var bF=bG.getClearStartDate();var bH=bG.getClearEndDate();return(bG.get(aB)&&(p.compare(bE,bF)||p.compare(bE,bH)||p.between(bE,bF,bH)));});},removeEvent:function(bE){var A=this;A.removeEvents([bE]);},removeEvents:function(bE){var A=this,bG=A.get(bq),bF=bG.concat();if(!bG.length){return;}bE=A._normalizeEvents(bE);aR.Array.each(bE,function(bH){aR.Array.removeItem(bF,bH);});if(bF.length!==bG.length){A.set(bq,bF);}},sortEventsByDateAsc:function(bE){var A=this;bE.sort(function(bI,bG){var bH=bI.get(aX);var bF=bG.get(aX);var bK=bI.get(bs);var bJ=bG.get(bs);if(p.after(bK,bJ)||(p.compare(bK,bJ)&&p.before(bH,bF))){return 1;}else{return -1;}});},_normalizeEvents:function(bF){var A=this;var bE=[];bF=aR.Array(bF);aR.Array.each(bF,function(bG){if(aN(bG)){bE.push(bG);}else{if(F(bG)){bE=bE.concat(A._normalizeEvents(bG.get(bq)));}else{bG=new (A.get(aZ))(bG);bE.push(bG);}}var bH=A;if(!ag(bH)){bH=A.get(ap);}if(bH){bG.setAttrs({eventClass:A.get(aZ),scheduler:bH},{silent:true});}});return bE;},_setEvents:function(bE){var A=this;return A._normalizeEvents(bE);}});aR.SchedulerEventSupport=ao;var af=aR.Component.create({NAME:C,ATTRS:{activeView:{validator:D},date:{value:new Date(),validator:k},eventRecorder:{setter:"_setEventRecorder"},strings:{value:{day:"Day",month:"Month",today:"Today",week:"Week",year:"Year"}},navigationDateFormatter:{value:function(bE){var A=this;return aR.DataType.Date.format(bE,{format:"%B %d, %Y",locale:A.get(bw)});},validator:bd},views:{setter:"_setViews",value:[]},viewDate:{getter:"_getViewDate",readOnly:true},firstDayOfWeek:{value:0,validator:ai},controlsNode:{valueFn:function(){return aR.Node.create(a7);}},viewDateNode:{valueFn:function(){return aR.Node.create(aO);}},headerNode:{valueFn:function(){return aR.Node.create(g);}},iconNextNode:{valueFn:function(){return aR.Node.create(bD);}},iconPrevNode:{valueFn:function(){return aR.Node.create(aV);}},navNode:{valueFn:function(){return aR.Node.create(s);}},todayNode:{valueFn:function(){return aR.Node.create(this._processTemplate(aA));}},viewsNode:{valueFn:function(){return aR.Node.create(am);}}},HTML_PARSER:{controlsNode:m+ba,viewDateNode:m+N,headerNode:m+o,iconNextNode:m+aH,iconPrevNode:m+W,navNode:m+br,todayNode:m+P,viewsNode:m+z},UI_ATTRS:[a3,ac],AUGMENTS:[aR.SchedulerEventSupport,aR.WidgetStdMod],prototype:{viewStack:null,initializer:function(){var A=this;A[at]={};A[a5]=A.get(a5);A[X]=A.get(X);
A[K]=A.get(bl);A[r]=A.get(r);A[bc]=A.get(bc);A[aq]=A.get(aq);A[aT]=A.get(aT);A[aI]=A.get(aI);A.after({activeViewChange:A._afterActiveViewChange,render:A._afterRender});},bindUI:function(){var A=this;A._bindDelegate();},syncUI:function(){var A=this;A.syncStdContent();},getViewByName:function(bE){var A=this;return A[at][bE];},getStrings:function(){var A=this;return A.get(aa);},getString:function(bE){var A=this;return A.getStrings()[bE];},renderView:function(bE){var A=this;if(bE){bE.show();if(!bE.get(by)){if(!A.bodyNode){A.setStdModContent(aJ.BODY,al);}bE.render(A.bodyNode);}}},plotViewEvents:function(bE){var A=this;bE.plotEvents(A.get(bq));},syncEventsUI:function(){var A=this,bE=A.get(ac);if(bE){A.plotViewEvents(bE);}},renderButtonGroup:function(){var A=this;A.buttonGroup=new aR.ButtonGroup({srcNode:A[aI],type:be,on:{selectionChange:aR.bind(A._onButtonGroupSelectionChange,A)}}).render();},syncStdContent:function(){var A=this;var bE=A.get(bB);A[aq].append(A[bc]);A[aq].append(A[r]);A[a5].append(A[aT]);A[a5].append(A[aq]);A[a5].append(A[X]);aR.Array.each(bE,function(bF){A[aI].append(A._createViewTriggerNode(bF));});A[K].append(A[a5]);A[K].append(A[aI]);A[K].addClass(aU);A.setStdModContent(aJ.HEADER,A[K].getDOM());},_afterActiveViewChange:function(bG){var bE=this;if(bE.get(by)){var bF=bG.newVal;var A=bG.prevVal;if(A){A.hide();}bE.renderView(bF);var bH=bE.get(ar);if(bH){bH.hideOverlay();}bE._uiSetDate(bE.get(a3));}},_afterRender:function(bF){var A=this,bE=A.get(ac);A.renderView(bE);A.renderButtonGroup();A._uiSetDate(A.get(a3));A._uiSetActiveView(bE);},_bindDelegate:function(){var A=this;A[a5].delegate("click",A._onClickPrevIcon,m+W,A);A[a5].delegate("click",A._onClickNextIcon,m+aH,A);A[a5].delegate("click",A._onClickToday,m+P,A);},_createViewTriggerNode:function(bE){var A=this;if(!bE.get(H)){var bF=bE.get(t);bE.set(H,aR.Node.create(ax.sub(bh,{name:bF,label:(A.getString(bF)||bF)})));}return bE.get(H);},_getViewDate:function(){var A=this,bE=A.get(a3),bF=A.get(ac);if(bF){bE=bF.getAdjustedViewDate(bE);}return bE;},_onClickToday:function(bF){var A=this,bE=A.get(ac);if(bE){A.set(a3,bE.getToday());}bF.preventDefault();},_onClickNextIcon:function(bF){var A=this,bE=A.get(ac);if(bE){A.set(a3,bE.get(h));}bF.preventDefault();},_onClickPrevIcon:function(bF){var A=this,bE=A.get(ac);if(bE){A.set(a3,bE.get(a6));}bF.preventDefault();},_onButtonGroupSelectionChange:function(bE){var A=this,bF=bE.originEvent.target.attr(a0);A.set(ac,A.getViewByName(bF));bE.preventDefault();},_processTemplate:function(bE){var A=this;return ax.sub(bE,A.getStrings());},_setEventRecorder:function(bE){var A=this;if(bE){bE.setAttrs({scheduler:A,eventClass:A.get(aZ)},{silent:true});}},_setViews:function(bF){var A=this;var bE=[];aR.Array.each(bF,function(bG){if(D(bG)&&!bG.get(by)){bG.setAttrs({scheduler:A,eventClass:A.get(aZ)});bE.push(bG);A[at][bG.get(t)]=bG;}});if(!A.get(ac)){A.set(ac,bF[0]);}return bE;},_uiSetActiveView:function(bG){var A=this;if(bG){var bF=bG.get(t),bE=A[aI].one(m+n+bF);if(bE){A[aI].all(aS).removeClass(aj);bE.addClass(aj);}}},_uiSetDate:function(bH){var bE=this;var bG=bE.get(f);var A=bG.call(bE,bH);if(bE.get(by)){var bF=bE.get(ac);if(bF){bF._uiSetDate(bH);bG=bF.get(f);A=bG.call(bF,bH);}bE[X].html(A);bE.syncEventsUI();}}}});aR.Scheduler=af;var bb=aR.Component.create({NAME:V,ATTRS:{color:{valueFn:function(){var bE=this;var bF=bE.get(ak);var A=Math.ceil(Math.random()*bF.length)-1;return bF[A];},validator:bp},disabled:{value:false,validator:bi},name:{value:"(no name)",validator:bp},pallete:{value:["#d96666","#e67399","#b373b3","#8c66d9","#668cb3","#668cd9","#59bfb3","#65ad89","#4cb052","#8cbf40","#bfbf4d","#e0c240","#f2a640","#e6804d","#be9494","#a992a9","#8997a5","#94a2be","#85aaa5","#a7a77d","#c4a883","#c7561e","#b5515d","#c244ab","#603f99","#536ca6","#3640ad","#3c995b","#5ca632","#7ec225","#a7b828","#cf9911","#d47f1e","#b56414","#914d14","#ab2671","#9643a5","#4585a3","#737373","#41a587","#d1bc36","#ad2d2d"],validator:d},scheduler:{lazyAdd:false,setter:"_setScheduler"},visible:{value:true,validator:bi}},EXTENDS:aR.Base,AUGMENTS:aR.SchedulerEventSupport,prototype:{initializer:function(){var A=this;A.after("colorChange",A._afterColorChange);A.after("disabledChange",A._afterDisabledChange);A.after("eventsChange",A._afterEventsChange);A.after("visibleChange",A._afterVisibleChange);A.on("eventsChange",A._onEventsChange);A._uiSetEvents(A.get(bq));A._uiSetColor(A.get(a9));A._uiSetDisabled(A.get(I));A._uiSetVisible(A.get(aB));},_afterColorChange:function(bE){var A=this;A._uiSetColor(bE.newVal);},_afterDisabledChange:function(bE){var A=this;A._uiSetDisabled(bE.newVal);},_afterEventsChange:function(bE){var A=this;A._uiSetEvents(bE.newVal);},_afterVisibleChange:function(bE){var A=this;A._uiSetVisible(bE.newVal);},_onEventsChange:function(bF){var A=this;var bE=A.get(ap);if(bE){bE.removeEvents(A);}},_propagateAttrs:function(bE,bF){var A=this;A.eachEvent(function(bG){bG.setAttrs(bE,bF);});},_setScheduler:function(bF){var A=this;var bE=A.get(ap);if(bE){A.removeTarget(bE);}A.addTarget(bF);return bF;},_uiSetColor:function(bE){var A=this;A._propagateAttrs({color:A.get(a9)});},_uiSetDisabled:function(bE){var A=this;A._propagateAttrs({disabled:bE});},_uiSetEvents:function(bF){var A=this;var bE=A.get(ap);A._propagateAttrs({color:A.get(a9),disabled:A.get(I),visible:A.get(aB)},{silent:true});if(bE){bE.addEvents(bF);bE.syncEventsUI();}},_uiSetVisible:function(bE){var A=this;A._propagateAttrs({visible:bE});}}});aR.SchedulerCalendar=bb;var ae=aR.Component.create({NAME:aF,ATTRS:{allDay:{setter:aR.DataType.Boolean.parse,value:false},borderStyle:{value:"solid",validator:bp},borderWidth:{value:"1px",validator:bp},colorBrightnessFactor:{value:0.75,validator:ai},colorSaturationFactor:{value:1.5,validator:ai},content:{validator:bp},color:{lazyAdd:false,setter:"_setColor",value:"#D96666",validator:bp},titleDateFormat:{getter:"_getTitleDateFormat",value:function(){var A=this,bE=A.get(ap),bF=bE&&bE.get(ac).get(a4),bG={endDate:E+bC+i,startDate:i};if(!bF){bG.endDate=E+bC+ay(A.get(aX));
bG.startDate=ay(A.get(bs));}if(A.getMinutesDuration()<=30){delete bG.endDate;}else{if(A.get(Y)){bG={};}}return bG;}},endDate:{setter:"_setDate",valueFn:function(){var A=p.clone(this.get(bs));A.setHours(A.getHours()+1);return A;}},eventClass:{valueFn:function(){return aR.SchedulerEvent;}},disabled:{value:false,validator:bi},meeting:{value:false,validator:bi},node:{valueFn:function(){return aR.NodeList.create(aR.Node.create(this.EVENT_NODE_TEMPLATE).setData(aF,this));}},reminder:{value:false,validator:bi},repeated:{value:false,validator:bi},scheduler:{lazyAdd:false,setter:"_setScheduler"},startDate:{setter:"_setDate",valueFn:function(){return new Date();}},visible:{value:true,validator:bi}},EXTENDS:aR.Model,PROPAGATE_ATTRS:[Y,bs,aX,aP,a9,a2,bk,aQ,bx,j,aB,I],prototype:{EVENT_NODE_TEMPLATE:'<div class="'+y+'">'+'<div class="'+M+'"></div>'+'<div class="'+aY+'"></div>'+'<div class="'+bv+'">'+'<span class="'+[q,G].join(bC)+'"></span>'+'<span class="'+[q,O].join(bC)+'"></span>'+'<span class="'+[q,aC].join(bC)+'"></span>'+'<span class="'+[q,e].join(bC)+'"></span>'+"</div>"+"</div>",initializer:function(){var A=this;var bE=A.get(x);A.bindUI();A.syncUI();},bindUI:function(){var A=this;A.after({allDayChange:A._afterAllDayChange,colorChange:A._afterColorChange,disabledChange:A._afterDisabledChange,endDateChange:A._afterEndDateChange,meetingChange:A._afterMeetingChange,reminderChange:A._afterReminderChange,repeatedChange:A._afterRepeatedChange,visibleChange:A._afterVisibleChange});},syncUI:function(){var A=this;A._uiSetAllDay(A.get(Y));A._uiSetColor(A.get(a9));A._uiSetDisabled(A.get(I));A._uiSetEndDate(A.get(aX));A._uiSetMeeting(A.get(bu));A._uiSetReminder(A.get(an));A._uiSetRepeated(A.get(bo));A._uiSetVisible(A.get(aB));A.syncNodeTitleUI();A.syncNodeContentUI();},destroy:function(){var A=this;A.get(x).remove(true);},addPaddingNode:function(){var A=this;A.get(x).push(aR.Node.create(A.EVENT_NODE_TEMPLATE).setData(aF,A));A.syncUI();},clone:function(){var bE=this,A=new (bE.get(aZ))();A.copyPropagateAttrValues(bE,null,{silent:true});return A;},copyDates:function(bE,bF){var A=this;A.setAttrs({endDate:p.clone(bE.get(aX)),startDate:p.clone(bE.get(bs))},bF);},copyPropagateAttrValues:function(bF,bH,bG){var A=this,bE={};A.copyDates(bF,bG);aR.Array.each(A.get(aZ).PROPAGATE_ATTRS,function(bI){if(!((bH||{}).hasOwnProperty(bI))){var bJ=bF.get(bI);if(!T(bJ)){bE[bI]=bJ;}}});A.setAttrs(bE,bG);},getBorderColor:function(){var A=this;return A[aW].hex;},getDaysDuration:function(){var A=this;return p.getDayOffset(A.get(aX),A.get(bs));},getHoursDuration:function(){var A=this;return p.getHoursOffset(A.get(aX),A.get(bs));},getMinutesDuration:function(){var A=this;return p.getMinutesOffset(A.get(aX),A.get(bs));},getSecondsDuration:function(){var A=this;return p.getSecondsOffset(A.get(aX),A.get(bs));},sameEndDate:function(bE){var A=this;return p.compare(A.get(aX),bE.get(aX));},sameStartDate:function(bE){var A=this;return p.compare(A.get(bs),bE.get(bs));},isAfter:function(bG){var bF=this;var bE=bF.get(bs);var A=bG.get(bs);return p.after(bE,A);},isBefore:function(bG){var bF=this;var bE=bF.get(bs);var A=bG.get(bs);return p.before(bE,A);},intersects:function(bG){var bF=this;var bH=bF.get(aX);var bE=bF.get(bs);var A=bG.get(bs);return(bF.sameStartDate(bG)||p.between(A,bE,bH));},intersectHours:function(bF){var bE=this;var bH=bE.get(aX);var A=bE.get(bs);var bG=p.clone(A);p.copyHours(bG,bF.get(bs));return(p.compare(A,bG)||p.between(bG,A,bH));},isDayBoundaryEvent:function(){var A=this;return p.isDayBoundary(A.get(bs),A.get(aX));},isDayOverlapEvent:function(){var A=this;return p.isDayOverlap(A.get(bs),A.get(aX));},getClearEndDate:function(){var A=this;return p.safeClearTime(A.get(aX));},getClearStartDate:function(){var A=this;return p.safeClearTime(A.get(bs));},move:function(bF,bE){var A=this;var bG=A.getMinutesDuration();A.setAttrs({endDate:p.add(p.clone(bF),p.MINUTES,bG),startDate:bF},bE);},setContent:function(bE){var A=this;A.get(x).each(function(bG){var bF=bG.one(m+aY);bF.setContent(bE);});},setTitle:function(bE){var A=this;A.get(x).each(function(bF){var bG=bF.one(m+M);bG.setContent(bE);});},syncNodeContentUI:function(){var A=this;A.setContent(A.get(aP));},syncNodeTitleUI:function(){var bE=this,bG=bE.get(j),A=bE.get(bs),bF=bE.get(aX),bH=[];if(bG.startDate){bH.push(bE._formatDate(A,bG.startDate));}if(bG.endDate){bH.push(bE._formatDate(bF,bG.endDate));}bE.setTitle(bH.join(bC));},split:function(){var A=this,bF=p.clone(A.get(bs)),bG=p.clone(A.get(aX));if(A.isDayOverlapEvent()&&!A.isDayBoundaryEvent()){var bE=p.clone(bF);bE.setHours(24,0,0,0);return[[bF,p.toMidnight(p.clone(bF))],[bE,p.clone(bG)]];}return[[bF,bG]];},_afterAllDayChange:function(bE){var A=this;A._uiSetAllDay(bE.newVal);},_afterColorChange:function(bE){var A=this;A._uiSetColor(bE.newVal);},_afterDisabledChange:function(bE){var A=this;A._uiSetDisabled(bE.newVal);},_afterEndDateChange:function(bE){var A=this;A._uiSetEndDate(bE.newVal);},_afterMeetingChange:function(bE){var A=this;A._uiSetMeeting(bE.newVal);},_afterReminderChange:function(bE){var A=this;A._uiSetReminder(bE.newVal);},_afterRepeatedChange:function(bE){var A=this;A._uiSetRepeated(bE.newVal);},_afterVisibleChange:function(bE){var A=this;A._uiSetVisible(bE.newVal);},_setColor:function(bE){var A=this;A[U]=a8.rgb2hsb(a8.getRGB(bE));A[ad]=aR.clone(A[U]);A[ad].b*=A.get(a2);A[ad].s*=A.get(bk);A[aW]=a8.hsb2rgb(A[ad]);return bE;},_setDate:function(bE){var A=this;if(ai(bE)){bE=new Date(bE);}return bE;},_setScheduler:function(bF){var A=this;var bE=A.get(ap);if(bE){A.removeTarget(bE);}A.addTarget(bF);return bF;},_formatDate:function(bF,bG){var bE=this;var A=bE.get(bw);return aR.DataType.Date.format(bF,{format:bG,locale:A});},_getTitleDateFormat:function(bE){var A=this;if(bp(bE)){bE={endDate:bE,startDate:bE};}else{if(bd(bE)){bE=bE.call(A);}}return bE;},_uiSetAllDay:function(bE){var A=this;A.get(x).toggleClass(Q,!!bE);},_uiSetColor:function(bG){var A=this;var bF=A.get(x);var bH=A.getBorderColor();if(bF){var bE={borderWidth:A.get(bx),borderColor:bH,backgroundColor:bG,borderStyle:A.get(aQ),color:au};
bF.setStyles(bE);}},_uiSetDisabled:function(bE){var A=this;A.get(x).toggleClass(bm,!!bE);},_uiSetEndDate:function(bE){var A=this;A.get(x).toggleClass(aw,A.getMinutesDuration()<=30);},_uiSetMeeting:function(bE){var A=this;A.get(x).toggleClass(b,!!bE);},_uiSetReminder:function(bE){var A=this;A.get(x).toggleClass(w,!!bE);},_uiSetRepeated:function(bE){var A=this;A.get(x).toggleClass(aG,!!bE);},_uiSetVisible:function(bE){var A=this;A.get(x).toggleClass(L,!bE);}}});aR.SchedulerEvent=ae;var bg=aR.Component.create({NAME:aL,AUGMENTS:[aR.WidgetStdMod],ATTRS:{bodyContent:{value:al},eventClass:{valueFn:function(){return aR.SchedulerEvent;}},filterFn:{validator:bd,value:function(A){return true;}},height:{value:600},isoTime:{value:false,validator:bi},name:{value:al,validator:bp},navigationDateFormatter:{value:function(bE){var A=this;var bF=A.get(ap);return aR.DataType.Date.format(bE,{format:"%A, %d %B, %Y",locale:bF.get(bw)});},validator:bd},nextDate:{getter:"getNextDate",readOnly:true},prevDate:{getter:"getPrevDate",readOnly:true},scheduler:{lazyAdd:false,setter:"_setScheduler"},scrollable:{value:true,validator:bi},triggerNode:{setter:aR.one},visible:{value:false}},BIND_UI_ATTRS:[bt],prototype:{initializer:function(){var A=this;A.after("render",A._afterRender);},syncUI:function(){var A=this;A.syncStdContent();},getAdjustedViewDate:function(bE){var A=this;return bE;},flushViewCache:function(){},getNextDate:function(){},getPrevDate:function(){},getToday:function(){return p.clearTime(new Date());},limitDate:function(bE,bF){var A=this;if(p.after(bE,bF)){bE=p.clone(bF);}return bE;},plotEvents:function(){},syncStdContent:function(){},syncEventUI:function(A){},_uiSetDate:function(A){},_afterRender:function(bF){var A=this;var bE=A.get(ap);A._uiSetScrollable(A.get(bt));},_setScheduler:function(bF){var A=this;var bE=A.get(ap);if(bE){A.removeTarget(bE);}if(bF){A.addTarget(bF);bF.after("eventsChange",aR.bind(A.flushViewCache,A));}return bF;},_uiSetScrollable:function(bF){var A=this;var bE=A.bodyNode;if(bE){bE.toggleClass(c,bF);bE.toggleClass(B,!bF);}}}});aR.SchedulerView=bg;},"@VERSION@",{skinnable:true,requires:["aui-base","aui-color-util","aui-datatype","button-group","model","model-list","widget-stdmod"]});AUI.add("aui-scheduler-view-day",function(bu){var bE=bu.Lang,az=bE.isBoolean,r=bE.isFunction,al=bE.isNumber,bK=bE.isObject,bn=bE.isString,Y=bu.DataType.DateMath,br=bu.WidgetStdMod,by="a",j=",",Z=".",x="",O="%",a7=" ",o="data-colnumber",bf="scheduler-view",ak="scheduler-view-day",e=bu.cached(function(){var bQ=bu.config.doc,bO=bQ.createElement("div"),A=bQ.getElementsByTagName("body")[0],bP=0.1;if(A){bO.style.cssText="position:absolute;visibility:hidden;overflow:scroll;width:20px;";bO.appendChild(bQ.createElement("p")).style.height="1px";A.insertBefore(bO,A.firstChild);bP=bO.offsetWidth-bO.clientWidth;A.removeChild(bO);}return bP;},null,0.1),D=function(A,bO){return function(bQ){var bP=bQ.all(A);return(bP.size()>=bO)?bP:null;};},be=function(bO,A){return Math.round(bO/A)*A;},bc=function(A){return parseFloat(A)||0;},aJ="activeColumn",bb="activeView",E="allDay",av="boundingBox",S="col",ae="colDaysNode",bw="colHeaderDaysNode",z="colblank",q="coldata",an="colday",a="colgrid",L="colspan",g="coltime",aU="columnData",ay="columnDayHeader",ao="columnShims",aM="columnTime",at="container",M="creationStartDate",a1="date",ba="viewDate",bC="day",J="days",t="delegateConfig",a9="disabled",aT="division",bg="dotted",v="draggingEvent",bl="duration",ag="endDate",bG="eventClass",a8="eventPlaceholder",bM="eventRecorder",l="eventWidth",bq="filterFn",am="first",aL="grid",a0="gridContainer",aF="grip",bL="hd",bt="header",aH="headerDateFormatter",bJ="headerTableNode",aC="headerView",aS="headerViewConfig",aq="headerViewLabelNode",bi="height",aI="horizontal",au="host",aj="hourHeight",n="icon",V="isoTime",N="label",aw="left",af="locale",f="marginRight",P="marker",aG="markercell",aA="markercellsNode",B="markers",a6="markersNode",bN="node",bs="offsetHeight",bv="pad",H="parentNode",aY="proxy",T="px",Q="region",bh="resizer",bo="resizerNode",bd="resizing",aB="right",k="scheduler",ah="scheduler-event",I="shim",bx="startDate",K="startXY",bp="strings",ax="table",a2="tableNode",aV="time",U="timesNode",W="today",aW="top",aZ="view",ad="visible",a5="width",a4="data",u=bu.getClassName,c=u(n),w=u(n,aF,bg,aI),aD=u(bf,ax,a4),ap=u(ah),aP=u(ah,a9),bk=u(ah,aY),F=u(k,W),X=u(k,W,bL),s=u(bf,q),b=u(bf,a),bz=u(bf,aL),bA=u(bf,aL,at),aE=u(bf,bC,bt,S),m=u(bf,bC,bt,bC),bm=u(bf,bC,bt,bC,am),aQ=u(bf,bC,bt,bC,bv,aB),bD=u(bf,bC,bt,ax),aK=u(bf,bC,bt,aZ,N),aR=u(bf,P,aT),bB=u(bf,aG),C=u(bf,B),bj=u(bf,bC,bh),ar=u(bf,bC,bh,n),a3=u(bf,bC,ax),bH=u(bf,bC,ax,S),ai=u(bf,bC,ax,S,I),G=u(bf,bC,ax,z),y=u(bf,bC,ax,an),bF=u(bf,bC,ax,g),aX=u(bf,bC,ax,aV),i='<div class="'+bj+'">'+'<div class="'+[c,w,ar].join(a7)+'"></div>'+"</div>",R='<div class="'+bB+'">'+'<div class="'+aR+'"></div>'+"</div>",h='<span class="'+aK+'">{label}</span>',ab='<table cellspacing="0" cellpadding="0" class="'+a3+'">'+"<tbody>"+'<tr class="'+b+'" height="1">'+'<td height="0" class="'+[bH,G].join(a7)+'"></td>'+'<td class="'+bA+'" colspan="1">'+'<div class="'+bz+'">'+'<div class="'+C+'"></div>'+"</div>"+"</td>"+"</tr>"+'<tr class="'+s+'">'+'<td class="'+[bH,bF].join(a7)+'"></td>'+"</tr>"+"</tbody>"+"</table>",aN='<td class="'+[bH,y].join(a7)+'" data-colnumber="{colNumber}">'+'<div class="'+ai+'"></div>'+"</td>",d='<div class="'+aX+'">{hour}</div>',ac='<table cellspacing="0" cellpadding="0" class="'+bD+'">'+"<tbody>"+'<tr class="'+aE+'"></tr>'+"</tbody>"+"</table>",aO='<th class="'+m+'" data-colnumber="{colNumber}"><a href="#">&nbsp;</a></th>',aa='<td class="'+[m,bm].join(a7)+'"></td>',p='<th class="'+[m,aQ].join(a7)+'">&nbsp;</th>';var bI=bu.Component.create({NAME:ak,ATTRS:{bodyContent:{value:x},days:{value:1,validator:al},delegateConfig:{value:{},setter:function(bO){var A=this;return bu.merge({dragConfig:{useShim:false},bubbleTargets:A,container:A.get(av),nodes:Z+ap,invalid:"input, select, button, a, textarea, "+Z+aP},bO||{});
},validator:bK},eventWidth:{value:95,validator:al},filterFn:{value:function(A){return(A.getHoursDuration()<=24&&!A.get(E));}},headerDateFormatter:{value:function(bO){var A=this;var bP=A.get(k);return bu.DataType.Date.format(bO,{format:"%d %A",locale:bP.get(af)});},validator:bn},headerView:{value:true,validator:az},headerViewConfig:{setter:function(bO){var A=this;return bu.merge({displayDaysInterval:1,displayRows:6,filterFn:function(bP){return((bP.getHoursDuration()>24)||bP.get(E));},height:"auto",visible:true},bO||{});},value:{}},hourHeight:{value:52,validator:al},name:{value:bC},navigationDateFormatter:{value:function(bO){var A=this;var bP=A.get(k);return bu.DataType.Date.format(bO,{format:"%A, %B %d, %Y",locale:bP.get(af)});},validator:r},strings:{value:{allDay:"All day"}},headerTableNode:{valueFn:function(){return bu.Node.create(ac);}},headerViewLabelNode:{valueFn:function(){var bO=this;var A=bO.get(bp);return bu.Node.create(bE.sub(h,{label:A[E]}));}},resizerNode:{valueFn:function(){return bu.Node.create(i);}},tableNode:{valueFn:function(){return bu.Node.create(ab);}},colDaysNode:{valueFn:"_valueColDaysNode"},colHeaderDaysNode:{valueFn:"_valueColHeaderDaysNode"},markercellsNode:{valueFn:"_valueMarkercellsNode"},timesNode:{valueFn:"_valueTimesNode"}},HTML_PARSER:{colDaysNode:D(Z+y,1),colHeaderDaysNode:D(Z+m,2),headerTableNode:Z+bD,headerViewLabelNode:Z+aK,markercellsNode:D(Z+bB,24),resizerNode:Z+bj,tableNode:Z+a3,timesNode:D(Z+aX,24)},EXTENDS:bu.SchedulerView,prototype:{initializer:function(){var A=this;A[ae]=A.get(ae);A[bw]=A.get(bw);A[bJ]=A.get(bJ);A[aA]=A.get(aA);A[bo]=A.get(bo);A[a2]=A.get(a2);A[U]=A.get(U);A[aJ]=null;A[aU]=A[a2].one(Z+s);A[ay]=A.headerTableNode.one(Z+aE);A[ao]=A[ae].all(Z+ai);A[aM]=A[a2].one(Z+bF);A[a0]=A[a2].one(Z+bA);A[a6]=A[a2].one(Z+C);if(A.get(aC)){A[aC]=new bu.SchedulerTableView(A.get(aS));}},renderUI:function(){var A=this;A[aM].setContent(A[U]);A[a6].setContent(A[aA]);A[ae].appendTo(A[aU]);A[bw].appendTo(A[ay]);if(A[aC]){A[aC].set(k,A.get(k));A[aC].render();}},bindUI:function(){var A=this;A[bJ].delegate("click",bu.bind(A._onClickDaysHeader,A),Z+m);A[aU].delegate("mousedown",bu.bind(A._onMouseDownTableCol,A),Z+bH);A[aU].delegate("mouseenter",bu.bind(A._onMouseEnterEvent,A),Z+ap);A[aU].delegate("mouseleave",bu.bind(A._onMouseLeaveEvent,A),Z+ap);A[aU].delegate("mousemove",bu.bind(A._onMouseMoveTableCol,A),Z+y);A[aU].delegate("mouseup",bu.bind(A._onMouseUpTableCol,A),Z+bH);A.on("drag:end",A._onEventDragEnd);A.on("drag:start",A._onEventDragStart);A.on("drag:tickAlignY",A._dragTickAlignY);A.on("schedulerChange",A._onSchedulerChange);A.after("drag:align",A._afterDragAlign);},syncUI:function(){var A=this;bI.superclass.syncUI.apply(this,arguments);A[a0].attr(L,A.get(J));A._setupDragDrop();},syncStdContent:function(){var bO=this;bO.setStdModContent(br.BODY,bO[a2].getDOM());var A=bu.NodeList.create(bO[bJ]);if(bO[aC]){A.push(bO[aC].get(av));A.push(bO.get(aq));}bO.setStdModContent(br.HEADER,A);},calculateEventHeight:function(bP){var bO=this;var A=bO.get(aj);return Math.max(bP*(A/60),A/2);},calculateTop:function(bO){var A=this;return((bO.getHours()*60)+bO.getMinutes()+(bO.getSeconds()/60))*(A.get(aj)/60);},getNextDate:function(){var A=this;var bO=A.get(k).get(a1);return Y.add(bO,Y.DAY,1);},getPrevDate:function(){var A=this;var bO=A.get(k).get(a1);return Y.subtract(bO,Y.DAY,1);},getColumnByDate:function(bO){var A=this;return A[ae].item(A.getDateDaysOffset(bO));},getColumnShimByDate:function(bO){var A=this;return A[ao].item(A.getDateDaysOffset(bO));},getDateByColumn:function(bO){var A=this;var bP=Y.safeClearTime(A.get(k).get(ba));return Y.add(bP,Y.DAY,bO);},getDateDaysOffset:function(bO){var A=this;var bP=Y.safeClearTime(A.get(k).get(ba));return Y.getDayOffset(Y.safeClearTime(bO),bP);},getYCoordTime:function(bR){var bO=this;var A=bO.get(aj);var bS=bc((bR/A).toFixed(2));var bQ=Math.floor((bS*100)%100*0.6);var bP=Math.floor(bS);return[bP,bQ,0];},plotEvent:function(bP){var A=this;var bQ=bP.get(bN);if(bQ.size()<2){bP.addPaddingNode();}var bS=bP.get(bN).item(0);var bO=bP.get(bN).item(1);var bR=A.getColumnShimByDate(bP.get(ag));var bT=A.getColumnShimByDate(bP.get(bx));if(bT){bT.append(bS);if(bP.get(ad)){bS.show();}}else{bS.hide();}if(bR){if(bR.compareTo(bT)||bP.isDayBoundaryEvent()){bO.hide();}else{bR.append(bO);if(bP.get(ad)){bO.show();}}}else{bO.hide();}bP.syncUI();A.syncEventTopUI(bP);A.syncEventHeightUI(bP);},plotEvents:function(){var A=this;var bO=A.get(k);var bP=A.get(bq);A[ao].each(function(bT,bS){var bQ=bO.getEventsByDay(A.getDateByColumn(bS),true);var bR=[];bT.empty();bu.Array.each(bQ,function(bU){if(bP.apply(A,[bU])){A.plotEvent(bU);bR.push(bU);}});A.syncEventsIntersectionUI(bR);});if(A.get(aC)){A.syncHeaderViewUI();}},syncColumnsUI:function(){var A=this;A[ae].each(function(bQ,bP){var bO=A.getDateByColumn(bP);bQ.toggleClass(F,Y.isToday(bO));});},syncDaysHeaderUI:function(){var bO=this;var bQ=bO.get(k).get(ba);var bP=bO.get(aH);var A=bO.get(af);bO[bw].all(by).each(function(bT,bS){var bR=Y.add(bQ,Y.DAY,bS);bT.toggleClass(X,Y.isToday(bR));bT.html(bP.call(bO,bR));});},syncEventsIntersectionUI:function(bO){var A=this;var bP=A.get(l);A.get(k).flushEvents();bu.Array.each(bO,function(bR){var bT=A.findEventIntersections(bR,bO);var bS=bT.length;var bQ=(bP/bS);bu.Array.each(bT,function(bV,bW){var bU=bV.get(bN).item(0);var bY=bQ*bW;var bX=bQ*1.7;if(bW===(bS-1)){bX=bP-bY;}bU.setStyle(a5,bX+O);bU.setStyle(aw,bY+O);var bZ=bU.get(H);if(bZ){bZ.insert(bU,bW);}bV._filtered=true;});});},syncEventHeightUI:function(bQ){var bO=this;var bU=bQ.get(ag);var A=bQ.get(bx);var bR=Y.clone(A);bR.setHours(24,0,0);var bS=Y.getMinutesOffset(bO.limitDate(bU,bR),A);bQ.get(bN).item(0).set(bs,bO.calculateEventHeight(bS));var bP=bQ.get(bN).item(1);if(bP.inDoc()){var bT=Y.getMinutesOffset(bU,Y.toMidnight(bQ.getClearEndDate()));bP.set(bs,bO.calculateEventHeight(bT));}},syncEventTopUI:function(bO){var A=this;bO.get(bN).item(0).setStyle(aW,A.calculateTop(bO.get(bx))+T);bO.get(bN).item(1).setStyle(aW,0);},syncHeaderViewUI:function(){var bO=this;
if(bO.get(aC)){var bQ=bO[aC];bQ.plotEvents();var bR=bQ.get(av);bR.setStyle(f,e());var bP=bR.one(Z+aD);var A=Math.max(bP.get(bs),40);bQ.set(bi,A);bO._fillHeight();}},calculateYDelta:function(bP,bO){var A=this;return(bO[1]-bP[1])/(A.get(aj)/2)*30;},findEventIntersections:function(bO,bP){var A=this;var bQ=[];bu.Array.each(bP,function(bR){if(!bO._filtered&&bR.get(ad)&&bO.intersectHours(bR)){bQ.push(bR);}});return bQ;},getXYDelta:function(bO){var A=this;var bP=bO.currentTarget.getXY(),bQ=[bO.pageX,bO.pageY];return bu.Array.map(bP,function(bS,bR){return(bQ[bR]-bS);});},getTickY:function(){var A=this;return be(Math.ceil(A.get(aj)/2),10);},roundToNearestHour:function(bO,bP){var A=this;bO.setHours(bP[0],be(bP[1],A.getTickY()),bP[2]);},_afterDragAlign:function(bP){var bO=this;var A=bP.target;if(!bO[K]){bO[K]=A.actXY;}A.actXY[0]=null;},_dragTickAlignX:function(bP){var bO=this;var bS=bO[v];if(bS&&!bO[bd]){var bQ=bO[a8];var bR=bc(bP.attr(o))-bO.startColNumber;bO.draggingEventStartDate=Y.add(bS.get(bx),Y.DAY,bR);var A=Y.clone(bO.draggingEventStartDate);Y.copyHours(A,bQ.get(bx));bQ.move(A,{silent:true});bO.plotEvent(bQ);}},_dragTickAlignY:function(A){var bT=this;var bO=bT.get(k);var bV=bO.get(bM);var bQ=bT[v];if(bQ){var bU=A.target.get(au);var bR=bT[a8];var bS=bT.calculateYDelta(bT[K],bU.actXY);if(bT[bd]){var bP=Y.add(bT.draggingEventEndDate,Y.MINUTES,bS);if(Y.getMinutesOffset(bP,bT.draggingEventStartDate)<30){return;}bR.set(ag,bP,{silent:true});}else{bR.move(Y.add(bT.draggingEventStartDate,Y.MINUTES,bS),{silent:true});}bT.plotEvent(bR);}},_setupDragDrop:function(){var bO=this,bR=bO[a8];if(!bR){var bP=bO.get(k);bR=new (bO.get(bG))({scheduler:bP});bR.removeTarget(bP);bR.get(bN).addClass(bk);bR.set(ad,false,{silent:true});bO[a8]=bR;}if(!bO.delegate){bO.delegate=new bu.DD.Delegate(bO.get(t));}var A=bO.delegate.dd;A.unplug(bu.Plugin.DDConstrained);A.unplug(bu.Plugin.DDNodeScroll);var bQ=bO.bodyNode.get(Q);bQ.bottom=Infinity;bQ.top=-Infinity;A.plug(bu.Plugin.DDConstrained,{bubbleTargets:bO,constrain:bQ,stickY:true,tickY:bO.get(aj)/2});A.plug(bu.Plugin.DDNodeScroll,{node:bO.bodyNode,scrollDelay:150});},_uiSetDate:function(bO){var A=this;A.syncColumnsUI();A.syncDaysHeaderUI();},_onClickDaysHeader:function(bQ){var A=this;var bP=A.get(k);if(bQ.target.test(by)){var bR=bP.getViewByName(bC);if(bR){var bO=bc(bQ.currentTarget.attr(o));bP.set(ba,A.getDateByColumn(bO));bP.set(bb,bR);}}bQ.preventDefault();},_onEventDragEnd:function(bO){var A=this;var bQ=A[v];if(bQ){var bP=A[a8];bP.set(ad,false,{silent:true});bQ.set(ad,true,{silent:true});bQ.copyDates(bP);A.get(k).syncEventsUI();}A[K]=null;A[v]=null;},_onEventDragStart:function(bP){var A=this;var bR=A[v]=A.delegate.dd.get(bN).getData(ah);if(bR){var bQ=A[a8];bQ.copyPropagateAttrValues(bR,null,{silent:true});A.plotEvent(bQ);bR.set(ad,false,{silent:true});A.draggingEventStartDate=Y.clone(bR.get(bx));A.draggingEventEndDate=Y.clone(bR.get(ag));var bO=A.getColumnByDate(bR.get(bx));A.startColNumber=bO?bc(bO.attr(o)):0;}},_onMouseDownTableCol:function(bO){var bT=this;var bS=bO.target;var bQ=bT.get(k);var bU=bQ.get(bM);if(bU&&!bQ.get(a9)){bU.hideOverlay();if(bS.test(Z+ai)){bT[K]=[bO.pageX,bO.pageY];var bV=bc(bO.currentTarget.attr(o));var bP=bT.getDateByColumn(bV);var A=bT.getXYDelta(bO);bT.roundToNearestHour(bP,bT.getYCoordTime(A[1]));var bR=Y.add(bP,Y.MINUTES,bU.get(bl));bU.move(bP,{silent:true});bU.setAttrs({allDay:false,endDate:bR},{silent:true});bT[M]=bP;bO.halt();}else{if(bS.test([Z+bj,Z+ar].join(j))){bT[bd]=true;}}}bT.get(av).unselectable();},_onMouseEnterEvent:function(bP){var A=this;var bQ=bP.currentTarget;var bO=bQ.getData(ah);if(bO&&!bO.get(a9)){A[bo].appendTo(bQ);}},_onMouseLeaveEvent:function(bO){var A=this;if(!A[bd]){A._removeResizer();}},_onMouseMoveTableCol:function(bR){var bO=this;var bQ=bR.currentTarget;var bP=bO.get(k).get(bM);if(bO[aJ]!==bQ){bO[aJ]=bQ;bO._dragTickAlignX(bO[aJ]);}var bS=bO[M];if(bS){var bU=be(bO.calculateYDelta(bO[K],[bR.pageX,bR.pageY]),bO.getTickY());var bT=(bU>=bO._delta);if(bO._delta!==bU){if(bU>0){var A=bT?Math.max(bU,bP.get(bl)):bU;bP.set(ag,Y.add(bS,Y.MINUTES,A),{silent:true});}else{bP.set(bx,Y.add(bS,Y.MINUTES,bU),{silent:true});}bO.plotEvent(bP);bO._delta=bU;}}},_onMouseUpTableCol:function(bQ){var A=this;var bP=A.get(k);var bO=bP.get(bM);if(bO&&!bP.get(a9)){if(A[M]){A.plotEvent(bO);bO.showOverlay([bQ.pageX,bQ.pageY]);}}A[M]=null;A[bd]=false;A[K]=null;A._removeResizer();A.get(av).selectable();},_onSchedulerChange:function(bO){var A=this;if(A[aC]){A[aC].set(k,bO.newVal);}},_removeResizer:function(){var A=this;A[bo].remove();},_valueColDaysNode:function(){var A=this;var bQ=A.get(J);var bO=[],bP=0;while(bQ--){bO.push(bu.Lang.sub(aN,{colNumber:bP++}));}return bu.NodeList.create(bO.join(x));},_valueColHeaderDaysNode:function(){var A=this;var bQ=A.get(J);var bO=[],bP=0;bO.push(aa);while(bQ--){bO.push(bu.Lang.sub(aO,{colNumber:bP++}));}bO.push(p);return bu.NodeList.create(bO.join(x));},_valueMarkercellsNode:function(){var A=this;var bO=[],bP;for(bP=0;bP<=23;bP++){bO.push(R);}return bu.NodeList.create(bO.join(x));},_valueTimesNode:function(){var A=this;var bQ=A.get(V);var bP=[],bO;for(bO=0;bO<=23;bO++){bP.push(bE.sub(d,{hour:bQ?Y.toIsoTimeString(bO):Y.toUsTimeString(bO,false,true)}));}return bu.NodeList.create(bP.join(x));}}});bu.SchedulerDayView=bI;},"@VERSION@",{skinnable:true,requires:["aui-scheduler-view-table","dd-drag","dd-delegate","dd-drop","dd-constrain"]});AUI.add("aui-scheduler-view-week",function(g){var j=g.Lang,f=j.isFunction,m="",n="&mdash;",o=" ",h=g.DataType.DateMath,i=h.WEEK_LENGTH,b="scheduler-view-week",e="date",l="days",d="firstDayOfWeek",k="locale",p="scheduler",a="week";var c=g.Component.create({NAME:b,ATTRS:{bodyContent:{value:m},days:{value:7},headerViewConfig:{value:{displayDaysInterval:i}},name:{value:a},navigationDateFormatter:{valueFn:function(){return this._valueNavigationDateFormatter;},validator:f}},EXTENDS:g.SchedulerDayView,prototype:{getAdjustedViewDate:function(t){var q=this;var s=q.get(p);var r=s.get(d);return h.getFirstDayOfWeek(t,r);
},getNextDate:function(){var q=this;var s=q.get(p);var r=s.get(e);var t=q._firstDayOfWeek(r);return h.add(t,h.WEEK,1);},getPrevDate:function(){var q=this;var s=q.get(p);var r=s.get(e);var t=q._firstDayOfWeek(r);return h.subtract(t,h.WEEK,1);},getToday:function(){var q=this;var r=c.superclass.getToday.apply(this,arguments);return q._firstDayOfWeek(r);},_firstDayOfWeek:function(s){var q=this;var t=q.get(p);var r=t.get(d);return h.getFirstDayOfWeek(s,r);},_valueNavigationDateFormatter:function(t){var s=this;var u=s.get(p);var r=u.get(k);var q=s._firstDayOfWeek(t);var v=g.DataType.Date.format(q,{format:"%B %d",locale:r});var x=h.add(q,h.DAY,s.get(l)-1);var w=g.DataType.Date.format(x,{format:(h.isMonthOverlapWeek(t)?"%B %d":"%d")+", %Y",locale:r});return[v,n,w].join(o);}}});g.SchedulerWeekView=c;},"@VERSION@",{skinnable:true,requires:["aui-scheduler-view-day"]});AUI.add("aui-scheduler-view-table",function(an){var aa=an.Lang,aH=aa.isFunction,aQ=aa.isString,q=an.DataType.DateMath,ai=an.WidgetStdMod,aY=q.WEEK_LENGTH,a6="-",l=".",S="",a5=" ",al="scheduler-view",av="scheduler-view-table",a8=function(A,a9){return function(bb){var ba=bb.all(A);return(ba.size()>=a9)?ba:null;};},aw="body",f="close",ao="col",H="colHeaderDaysNode",w="colgrid",aD="colspan",I="columnDayHeader",J="columnTableGrid",a="container",am="content",az="data",aI="day",i="displayDaysInterval",V="displayRows",ad="div",aA="down",ar="endDate",a4="event",aR="events",O="eventsOverlay",aM="filterFn",B="first",L="firstDayOfWeek",j="grid",C="header",d="headerDateFormatter",z="headerTableNode",af="icon",c="left",aV="locale",aL="more",t="next",v="node",o="overlay",m="right",s="row",P="rowsContainerNode",U="scheduler",ag="scheduler-event",aU="showMore",aS="startDate",M="strings",n="table",aB="tableGridNode",u="tableRowContainer",p="tableRows",aP="tbody",ax="title",a2="tl",k="today",aT="tr",W="viewDate",ac="visible",K=an.getClassName,r=K(af),a3=K(af,"arrowstop-1-l"),g=K(af,"arrowstop-1-r"),aq=K(al,n,w),a7=K(al,n,w,B),aJ=K(al,n,w,k),ak=K(al,n,a),T=K(al,n,aR,o,v),b=K(al,n,aR,o,v,aw),aG=K(al,n,aR,o,v,f),ae=K(al,n,C,ao),ay=K(al,n,C,aI),X=K(al,n,C,n),aj=K(al,n,aL),aX=K(al,n,s),aN=K(al,n,s,a),G=K(al,n,az),E=K(al,n,az,ao),Z=K(al,n,az,ao,ax),a1=K(al,n,az,ao,ax,aA),ab=K(al,n,az,ao,ax,B),N=K(al,n,az,ao,ax,t),Q=K(al,n,az,ao,ax,k),x=K(al,n,az,a4),aO=K(al,n,az,a4,c),aZ=K(al,n,az,a4,m),R=K(al,n,az,B),ah=K(al,n,j),F=K(al,n,j,B),aW='<div class="'+ak+'">'+'<div class="'+aN+'"></div>'+"</div>",ap='<div class="'+T+'">'+'<div class="'+b+'"></div>'+'<a href="javascript:;" class="'+aG+'">{label}</a>'+"</div>",aK='<td class="'+aq+'">&nbsp;</td>',a0='<th class="'+ay+'"><div>&nbsp;</div></th>',h='<table cellspacing="0" cellpadding="0" class="'+X+'">'+"<tbody>"+'<tr class="'+ae+'"></tr>'+"</tbody>"+"</table>",aF='<a href="javascript:;" class="'+aj+'">{label} {count}</a>',aC='<div class="'+aX+'" style="top: {top}%; height: {height}%;"></div>',Y='<table cellspacing="0" cellpadding="0" class="'+G+'">'+"<tbody></tbody>"+"</table>",aE='<table cellspacing="0" cellpadding="0" class="'+ah+'">'+"<tbody>"+"<tr></tr>"+"</tbody>"+"</table>",y='<span class="'+[r,a3].join(a5)+'"></span>',au='<span class="'+[r,g].join(a5)+'"></span>',D='<td class="'+E+'"><div></div></td>',at="<tr></tr>";var e=an.Component.create({NAME:av,ATTRS:{bodyContent:{value:S},displayDaysInterval:{value:42},displayRows:{value:4},fixedHeight:{value:true},name:{value:n},headerDateFormatter:{value:function(a9){var A=this;var ba=A.get(U);return an.DataType.Date.format(a9,{format:"%A",locale:ba.get(aV)});},validator:aQ},navigationDateFormatter:{value:function(a9){var A=this;var ba=A.get(U);return an.DataType.Date.format(a9,{format:"%b %Y",locale:ba.get(aV)});},validator:aH},scrollable:{value:false},strings:{value:{close:"Close",showMore:"Show more"}},headerTableNode:{valueFn:function(){return an.Node.create(h);}},colHeaderDaysNode:{valueFn:"_valueColHeaderDaysNode"},rowsContainerNode:{valueFn:function(){return an.Node.create(aW);}},tableGridNode:{valueFn:"_valueTableGridNode"}},HTML_PARSER:{colHeaderDaysNode:a8(l+ay,7),headerTableNode:l+X,rowsContainerNode:l+ak,tableGridNode:a8(l+ah,7)},EXTENDS:an.SchedulerView,prototype:{evtDateStack:null,evtRenderedStack:null,rowDataTableStack:null,initializer:function(){var A=this;A.evtDateStack={};A.evtRenderedStack={};A.rowDataTableStack={};A[H]=A.get(H);A[z]=A.get(z);A[P]=A.get(P);A[aB]=A.get(aB);A[I]=A.headerTableNode.one(l+ae);A[J]=an.NodeList.create();A[u]=A[P].one(l+aN);A[p]=an.NodeList.create();},bindUI:function(){var A=this;A[P].delegate("click",an.bind(A._onClickMore,A),l+aj);},renderUI:function(){var A=this,a9=A._getDisplayRowsCount(),ba;for(ba=0;ba<a9;ba++){A[p].push(A.buildGridRowNode(ba));}A._renderEventsOverlay();A[H].appendTo(A[I]);A[p].appendTo(A[u]);},buildEventsRow:function(a9,be,bd){var A=this;var ba=A.get(V);var bc=0;var bb=an.Node.create(at);A.loopDates(a9,be,function(bn,bj){if(bc>bj){return;}var bo=A.getIntersectEvents(bn);var bl=A._getRenderableEvent(bo,a9,be,bn);var bh=an.Node.create(D);var bg=bh.one(ad);if((ba<bo.length)&&(bd===(ba-1))){var bm=A.get(M);var bi=an.Node.create(aa.sub(aF,{count:(bo.length-(ba-1)),label:bm[aU]}));bi.setData(aR,bo);bg.append(bi);}else{if(bl){var bf=A._getEvtSplitInfo(bl,bn,a9,be);bh.attr(aD,bf.colspan);bc+=(bf.colspan-1);A._syncEventNodeContainerUI(bl,bg,bf);A._syncEventNodeUI(bl,bg,bn);var bk=String(bn.getTime());A.evtRenderedStack[bk].push(bl);}}bc++;bb.append(bh);});return bb;},buildEventsTable:function(A,bc){var bi=this,bg=bi.get(V),bf=q.clearTime(bi._findCurrentIntervalStart()),be=String(bf.getTime()).concat(A.getTime()).concat(bc.getTime()),bh=bi.rowDataTableStack[be],bd;if(!bh){bh=an.Node.create(Y);var bb=bh.one(aP);var ba=bi.buildEventsTitleRow(bh,A,bc);bb.append(ba);for(bd=0;bd<bg;bd++){var a9=bi.buildEventsRow(A,bc,bd);bb.append(a9);}bi.rowDataTableStack[be]=bh;}return bh;},buildEventsTitleRow:function(ba,a9,bc){var A=this;var bb=an.Node.create(at);A.loopDates(a9,bc,function(be,bd){var bf=an.Node.create(D);bf.addClass(Z).toggleClass(ab,(bd===0)).toggleClass(Q,q.isToday(be)).toggleClass(N,q.isToday(q.subtract(be,q.DAY,1))).toggleClass(a1,q.isToday(q.subtract(be,q.WEEK,1)));
bb.append(bf.setContent(be.getDate()));});return bb;},buildGridRowNode:function(bd){var ba=this;var bb=ba._getDisplayRowsCount();var a9=100/bb;var A=ba._getTableGridNode(bd);var bc=an.Node.create(aa.sub(aC,{height:a9,top:a9*bd}));bc.append(A.toggleClass(F,(bd===0)));return bc;},flushViewCache:function(){var A=this;A.evtDateStack={};A.evtRenderedStack={};A.rowDataTableStack={};},getIntersectEvents:function(a9){var A=this;var bc=A.get(U);var bb=String(a9.getTime());if(!A.evtDateStack[bb]){var ba=bc.getIntersectEvents(a9);A.evtDateStack[bb]=ba.filter(A.get(aM));}return A.evtDateStack[bb];},getNextDate:function(){var A=this;var ba=A.get(U);var bb=ba.get(W);var a9=A.get(i);return q.add(bb,q.DAY,a9);},getPrevDate:function(){var A=this;var ba=A.get(U);var bb=ba.get(W);var a9=A.get(i);return q.subtract(bb,q.DAY,a9);},hideEventsOverlay:function(){var A=this;A[O].set(ac,false);},loopDates:function(A,bb,be,bf,bd){var bg=this;var a9=q.clone(A);var ba=bb.getTime();var bc;for(bc=0;a9.getTime()<=ba;bc++){be.apply(bg,[a9,bc]);a9=q.add(a9,(bf||q.DAY),(bd||1));}},plotEvents:function(){var a9=this;var bc=a9._findCurrentIntervalStart();var A=q.safeClearTime(bc);a9.flushViewCache();a9.hideEventsOverlay();a9.bodyNode.all(l+G).remove();var ba=a9.get(i);var bb=Math.min(ba,aY);a9[p].each(function(bg,be){var bd=q.add(A,q.DAY,bb*be);var bh=q.add(bd,q.DAY,bb-1);var bf=a9.buildEventsTable(bd,bh);if(be===0){bf.addClass(R);}bg.append(bf);});},syncDaysHeaderUI:function(){var a9=this;var bc=a9.get(U);var bd=bc.get(W);var bb=a9.get(d);var A=a9.get(aV);var ba=a9._findFirstDayOfWeek(bd);a9.colHeaderDaysNode.all(ad).each(function(bg,bf){var be=q.add(ba,q.DAY,bf);bg.html(bb.call(a9,be));});},syncGridUI:function(){var bi=this;var bc=bi.getToday();var a9=bi.get(U);bi[J].removeClass(aJ);var bb=bi._findCurrentIntervalStart();var be=bi._findCurrentIntervalEnd();if(q.between(bc,bb,be)){var A=a9.get(L);var bg=bi._findFirstDayOfWeek(bc);var bd=q.getWeekNumber(bc,A)-q.getWeekNumber(bb,A);var bh=(bc.getDate()-bg.getDate());var ba=bi._getCellIndex([bh,bd]);var bf=bi[J].item(ba);if(bf){bf.addClass(aJ);}}},syncStdContent:function(){var A=this;A.setStdModContent(ai.BODY,A[P].getDOM());A.setStdModContent(ai.HEADER,A[z].getDOM());},_findCurrentIntervalEnd:function(){var A=this;var ba=A.get(U);var bb=ba.get(W);var a9=A.get(i);return q.add(bb,q.DAY,a9);},_findCurrentIntervalStart:function(){var A=this;var a9=A.get(U);return a9.get(W);},_findFirstDayOfWeek:function(ba){var A=this;var bb=A.get(U);var a9=bb.get(L);return q.getFirstDayOfWeek(ba,a9);},_getCellIndex:function(a9){var A=this;return a9[1]*aY+a9[0];},_getDisplayRowsCount:function(){var A=this;var a9=A.get(i);return Math.ceil(a9/aY);},_getDisplayRowDaysCount:function(){var A=this;var a9=A.get(i);return Math.min(a9,aY);},_getEvtLabel:function(ba){var a9=this;var bb=ba.get(ar);var A=ba.get(aS);return[A.getHours(),a6,bb.getHours(),a5,ba.get(am)].join(S);},_getEvtSplitInfo:function(bd,bg,A,bb){var be=this;var a9=bd.getClearStartDate();var bc=bd.getClearEndDate();var bf=q.getDayOffset(bb,bg);var ba={colspan:Math.min(q.getDayOffset(bc,bg),bf)+1,left:q.before(a9,A),right:q.after(bc,bb)};return ba;},_getRenderableEvent:function(bh,A,bb,bi){var bg=this,be=String(bi.getTime()),ba;if(!bg.evtRenderedStack[be]){bg.evtRenderedStack[be]=[];}for(ba=0;ba<bh.length;ba++){var bf=bh[ba];var a9=bf.get(aS);var bd=q.after(bi,a9)&&!q.isDayOverlap(bi,A);var bc=!q.isDayOverlap(a9,bi);var bj=an.Array.indexOf(bg.evtRenderedStack[be],bf)>-1;if(!bj&&(bc||bd)){return bf;}}return null;},_getTableGridNode:function(be){var a9=this,bb=a9.get(i),A=a9[aB].item(be),bd=A.one(aT),ba;for(ba=0;ba<Math.min(bb,aY);ba++){var bc=an.Node.create(aK);bd.append(bc);if(ba===0){bc.addClass(a7);}a9[J].push(bc);}return A;},_onClickMore:function(ba){var A=this;var bb=ba.target;var a9=bb.getData(aR);var bc=an.NodeList.create();an.Array.each(a9,function(be){var bd=be.get(v).item(0).clone();bd.setData(ag,be);bd.setStyles({height:"auto",left:0,position:"relative",top:0,width:"auto"});bc.push(bd);});A[O].bodyNode.one(l+b).setContent(bc);A[O].setAttrs({visible:true,xy:bb.getXY()});},_renderEventsOverlay:function(){var a9=this;var A=a9.get(M);a9[O]=new an.Overlay({align:{points:[a2,a2]},bodyContent:aa.sub(ap,{label:A[f]}),render:a9[P],visible:false,width:250,zIndex:450});a9[O].bodyNode.delegate("click",an.bind(a9.hideEventsOverlay,a9),l+aG);},_syncEventNodeContainerUI:function(a9,bb,ba){var A=this;bb.addClass(x);if(ba.left){bb.addClass(aO).prepend(y);}if(ba.right){bb.addClass(aZ).append(au);}},_syncEventNodeUI:function(bh,a9,bj){var bi=this;var bc=bi.get(U);var A=bc.get(L);var bb=bh.get(v);var ba=bh.get(aS);var bg=q.clearTime(bi._findCurrentIntervalStart());var bd=q.getFirstDayOfWeek(new Date(Math.max(ba,bg)),A);var bf=Math.floor(q.getDayOffset(bj,bd)/aY);if(bb.size()<=bf){bh.addPaddingNode();}var be=bb.item(bf);be.setStyles({height:"auto",left:0,top:0,width:"auto"});be.appendTo(a9);bh.syncUI();},_uiSetDate:function(a9){var A=this;A.syncDaysHeaderUI();A.syncGridUI();},_valueColHeaderDaysNode:function(){var A=this;var a9=A.get(i);var ba=Math.min(a9,aY);return A._valueNodeList(ba,a0);},_valueTableGridNode:function(){var A=this;var a9=A.get(i);var ba=Math.min(a9,aY);return A._valueNodeList(ba,aE);},_valueNodeList:function(bb,ba){var A=this;var a9=[];while(bb--){a9.push(ba);}return an.NodeList.create(a9.join(S));}}});an.SchedulerTableView=e;},"@VERSION@",{skinnable:true,requires:["aui-scheduler-base","overlay"]});AUI.add("aui-scheduler-view-table-dd",function(j){var S=j.Lang,G=S.isObject,f=j.DataType.DateMath,K=f.WEEK_LENGTH,p=".",F="scheduler-event",z="scheduler-view",M="boundingBox",C="col",g="colgrid",H="content",h="data",b="dd",i="delegate",w="delegateConfig",y="disabled",B="displayDaysInterval",e="dragNode",c="dragging",l="draggingEvent",E="eventRecorder",m="lasso",P="node",I="offsetHeight",J="offsetWidth",R="proxy",L="proxyNode",u="region",r="rowsContainerNode",s="scheduler",N="startDate",t="table",Q="visible",d=j.getClassName,q=d(F),O=d(F,y),o=d(z,t,g),x=d(z,t,c),k=d(z,t,m),a=d(z,t,R,P),D=d(z,t,h,C),v='<div class="'+k+'"></div>',n='<div class="'+a+'"></div>';
j.SchedulerTableViewDD=function(){};j.SchedulerTableViewDD.ATTRS={delegateConfig:{value:{},setter:function(T){var A=this;return j.merge({dragConfig:{offsetNode:false,useShim:false},bubbleTargets:A,container:A.get(M),nodes:p+q,invalid:"input, select, button, a, textarea, "+p+O},T||{});},validator:G}};j.mix(j.SchedulerTableViewDD.prototype,{initializer:function(){var A=this;A[L]=j.Node.create(n);A.after(A.viewDDBindUI,A,"bindUI");A.after(A.viewDDRenderUI,A,"renderUI");A.after(A.viewDDSyncUI,A,"syncUI");},viewDDBindUI:function(){var A=this;var T=A.get(s).get(E);if(T){T.on({cancel:j.bind(A.removeLasso,A),save:j.bind(A.removeLasso,A)});}A[r].on({mousedown:j.bind(A._onMouseDownGrid,A),mousemove:j.bind(A._onMouseMoveGrid,A),mouseup:j.bind(A._onMouseUpGrid,A)});A.after("drag:align",A._afterDragAlign);A.on("drag:end",A._onEventDragEnd);A.on("drag:start",A._onEventDragStart);},viewDDRenderUI:function(){var A=this;},viewDDSyncUI:function(){var A=this;A._setupDragDrop();},removeLasso:function(){var A=this;if(A[m]){A[m].remove();}},removeProxy:function(){var A=this;if(A[L]){A[L].remove();}},renderLasso:function(Z,T){var af=this;var W=Z;var Y=T;if(Z[1]>T[1]){W=T;Y=Z;}var ag=W[0],ab=W[1],U=Y[0],A=Y[1],V;af.removeLasso();af.lasso=j.NodeList.create();for(V=ab;V<=A;V++){var X=af.gridCellHeight,ae=af.gridCellWidth,ac=0,aa=(X*V);if(V===ab){if(ab===A){ac+=Math.min(ag,U)*ae;ae*=Math.abs(U-ag)+1;}else{ac+=ag*ae;ae*=K-ag;}}else{if(V===A){ae*=U+1;}else{ae*=K;}}var ad=j.Node.create(v);af.lasso.push(ad);af[r].append(ad);ad.sizeTo(ae,X);ad.setXY(af._offsetXY([ac,aa],1));}},_afterDragAlign:function(A){var Z=this;var aa=A.target;var W=Z.bodyNode.get(u);var X={bottom:A.pageY,left:A.pageX,right:A.pageX,top:A.pageY};if(!j.DOM.inRegion(null,W,true,X)){return;}var Y=Z[l];var T=[A.pageX,A.pageY];var V=Z._findPosition(Z._offsetXY(T,-1));if(Y&&Z._hasLassoChanged(V)){Z.lassoLastPosition=V;var U=f.add(Z._getPositionDate(V),f.MINUTES,Y.getMinutesDuration());Z.renderLasso(V,Z._getDatePosition(U));}},_findPosition:function(V){var A=this;var U=Math.floor(V[0]/A.gridCellWidth);var T=Math.floor(V[1]/A.gridCellHeight);return[U,T];},_getDatePosition:function(U){var T=this;var V=T._findCurrentIntervalStart();var W=f.getDayOffset(U,V);var A=[];A[1]=Math.floor(W/K);A[0]=W%K;return A;},_getPositionDate:function(U){var T=this;var W=T._findCurrentIntervalStart();var A=f.safeClearTime(T._findFirstDayOfWeek(W));var V=f.add(A,f.DAY,T._getCellIndex(U));V.setHours(0,0,0,0);return V;},_hasLassoChanged:function(T){var A=this;var U=A.lassoLastPosition||A.lassoStartPosition;return U&&((T[0]!==U[0])||(T[1]!==U[1]));},_offsetXY:function(V,U){var A=this;var T=A[r].getXY();return[V[0]+T[0]*U,V[1]+T[1]*U];},_onEventDragEnd:function(T){var A=this;var V=A[l];if(V){var U=A._getPositionDate(A.lassoLastPosition);f.copyHours(U,V.get(N));V.move(U);V.set(Q,true,{silent:true});A[r].removeClass(x).unselectable();T.target.set(e,A.originalDragNode);A.removeLasso();A.removeProxy();A.get(s).syncEventsUI();}A[l]=null;},_onEventDragStart:function(W){var A=this;var X=A[l]=A[i][b].get(P).getData(F);if(X){A._syncCellDimensions();var U=[W.pageX,W.pageY];var V=A._findPosition(A._offsetXY(U,-1));var T=f.add(A._getPositionDate(V),f.MINUTES,X.getMinutesDuration());A.renderLasso(V,A._getDatePosition(T));X.set(Q,false,{silent:true});A._syncProxyNodeUI(X);A.lassoStartPosition=A.lassoLastPosition=V;A[r].addClass(x).unselectable();A.originalDragNode=W.target.get(e);W.target.set(e,A[L]);}},_onMouseDownGrid:function(W){var A=this;var V=A.get(s);var U=V.get(E);var X=W.target;if(U&&X.test([p+o,p+D].join())){A._recording=true;A._syncCellDimensions();var T=A._offsetXY([W.pageX,W.pageY],-1);A.lassoStartPosition=A.lassoLastPosition=A._findPosition(T);A.renderLasso(A.lassoStartPosition,A.lassoLastPosition);A[r].unselectable();}},_onMouseMoveGrid:function(V){var T=this;var W=V.currentTarget;var U=[V.pageX,V.pageY];var A=T._findPosition(T._offsetXY(U,-1));if(T._recording&&T._hasLassoChanged(A)){T.lassoLastPosition=A;T.renderLasso(T.lassoStartPosition,A);}},_onMouseUpGrid:function(Y){var T=this;var X=T.get(s);var V=X.get(E);if(V&&T._recording&&!X.get(y)){var W=T._getPositionDate(T.lassoStartPosition);var U=T._getPositionDate(T.lassoLastPosition);var A=new Date(Math.min(W,U));A.setHours(0,0,0);var Z=new Date(Math.max(W,U));Z.setHours(23,59,59);V.setAttrs({allDay:true,endDate:Z,startDate:A},{silent:true});V.showOverlay([Y.pageX,Y.pageY]);T._recording=false;}},_setupDragDrop:function(){var T=this;if(!T[i]){T[i]=new j.DD.Delegate(T.get(w));}var A=T[i][b];A.unplug(j.Plugin.DDConstrained);A.unplug(j.Plugin.DDNodeScroll);A.unplug(j.Plugin.DDProxy);A.plug(j.Plugin.DDConstrained,{bubbleTargets:T,constrain:T.bodyNode});A.plug(j.Plugin.DDNodeScroll,{node:T.bodyNode,scrollDelay:150});A.plug(j.Plugin.DDProxy,{moveOnEnd:false,positionProxy:false});},_syncCellDimensions:function(){var A=this;var U=A.get(B);var T=Math.ceil(U/K);var V=Math.min(U,K);A.gridCellHeight=A[r].get(I)/T;A.gridCellWidth=A[r].get(J)/V;},_syncProxyNodeUI:function(T){var A=this;var U=T.get(P).item(0);A[L].setStyles({backgroundColor:U.getStyle("backgroundColor"),display:"block",width:"200px"});A[L].appendTo(A[r]);A[L].setContent(T.get(H));}});j.Base.mix(j.SchedulerTableView,[j.SchedulerTableViewDD]);},"@VERSION@",{skinnable:false,requires:["aui-scheduler-view-table","dd-drag","dd-delegate","dd-drop","dd-constrain"]});AUI.add("aui-scheduler-view-month",function(o){var f=o.Lang,a=f.isFunction,c=o.DataType.DateMath,r=".",h="col",g="data",d="date",v="firstDayOfWeek",e="locale",m="month",w="nomonth",i="scheduler",j="table",u="tableRowContainer",n="title",q="viewDate",p="scheduler-view",l="scheduler-view-month",t=o.getClassName,s=t(l,j,g,h,w),k=t(p,j,g,h,n);var b=o.Component.create({NAME:l,ATTRS:{displayDaysInterval:{readOnly:true,value:42},name:{value:m},navigationDateFormatter:{value:function(y){var x=this;var z=x.get(i);return o.DataType.Date.format(y,{format:"%B %Y",locale:z.get(e)});},validator:a}},EXTENDS:o.SchedulerTableView,prototype:{getAdjustedViewDate:function(y){var x=this;
return c.findMonthStart(y);},getNextDate:function(){var x=this;var z=x.get(i);var y=z.get(d);return c.add(y,c.MONTH,1);},getPrevDate:function(){var x=this;var z=x.get(i);var y=z.get(d);return c.subtract(y,c.MONTH,1);},plotEvents:function(){var x=this;o.SchedulerMonthView.superclass.plotEvents.apply(x,arguments);var y=x.get(i);var C=y.get(q);var B=c.findMonthEnd(C);var A=c.findMonthStart(C);var z=x._findCurrentIntervalStart();var D=x[u].all(r+k);D.each(function(G,E){var F=c.add(z,c.DAY,E);if(c.before(F,A)||c.after(F,B)){G.addClass(s);}});},_findCurrentIntervalStart:function(){var x=this;var y=x.get(i);var z=y.get(q);return x._findFirstDayOfWeek(z);},_findFirstDayOfWeek:function(z){var x=this;var A=x.get(i);var y=A.get(v);return c.getFirstDayOfWeek(z,y);}}});o.SchedulerMonthView=b;},"@VERSION@",{skinnable:true,requires:["aui-scheduler-view-table"]});AUI.add("aui-scheduler-event-recorder",function(x){var aq=x.Lang,F=aq.isArray,R=aq.isObject,p=aq.isString,B=aq.isUndefined,ag=x.IO.prototype._serialize,o=x.DataType.DateMath,I="-",D=".",d=" ",Q="scheduler-event",ao="scheduler-event-recorder",e="activeView",M="arrow",Z="body",u="bodyContent",K="bottom",ah="boundingBox",O="cancel",W="click",t="constrain",S="content",r="date",Y="dateFormat",s="delete",an="endDate",h="event",k="footerContent",c="form",L="header",af="isoTime",ap="node",T="offsetHeight",X="offsetWidth",C="overlay",ak="overlayOffset",am="recorder",ae="rendered",al="right",V="save",G="scheduler",ad="schedulerChange",q="shadow",aj="startDate",a="strings",f="submit",j="template",P="title",ac="toolbar",ab="visibleChange",n=x.getClassName,E=n(Q),aa=n(Q,P),w=n(Q,am),v=n(G,h,am,C),b=n(G,h,am,C,M),l=n(G,h,am,C,M,K),J=n(G,h,am,C,M,al),U=n(G,h,am,C,M,q),N=n(G,h,am,C,Z),H=n(G,h,am,C,S),m=n(G,h,am,C,r),ai=n(G,h,am,C,c),z=n(G,h,am,C,L),y=new x.Template('<div class="',U," ",b,'"></div>','<div class="',b,'"></div>','<input type="hidden" name="startDate" value="{startDate}" />','<input type="hidden" name="endDate" value="{endDate}" />','<div class="',z,'">','<input class="',H,'" name="content" value="{content}" />',"</div>",'<div class="',N,'">','<label class="',m,'">{date}</label>',"</div>"),i='<form class="'+ai+'" id="schedulerEventRecorderForm"></form>';var g=x.Component.create({NAME:ao,ATTRS:{allDay:{value:false},content:{},duration:{value:60},dateFormat:{validator:p,value:"%a, %B %d,"},event:{},eventClass:{valueFn:function(){return x.SchedulerEvent;}},strings:{value:{},setter:function(A){return x.merge({"delete":"Delete","description-hint":"e.g., Dinner at Brian's",cancel:"Cancel",description:"Description",edit:"Edit",save:"Save",when:"When"},A||{});},validator:R},overlay:{validator:R,value:{constrain:null,visible:false,width:300,zIndex:500}},overlayOffset:{value:[15,-38],validator:F},template:{value:y},toolbar:{setter:function(at){var ar=this;var A=ar.get(a);return x.merge({children:[{handler:x.bind(ar._handleSaveEvent,ar),label:A[V]},{handler:x.bind(ar._handleCancelEvent,ar),label:A[O]},{handler:x.bind(ar._handleDeleteEvent,ar),label:A[s]}]},at||{});},validator:R,value:{}}},EXTENDS:x.SchedulerEvent,prototype:{initializer:function(){var A=this;A.get(ap).addClass(w);A.publish("cancel",{defaultFn:A._defCancelEventFn});A.publish("delete",{defaultFn:A._defDeleteEventFn});A.publish("edit",{defaultFn:A._defEditEventFn});A.publish("save",{defaultFn:A._defSaveEventFn});A.after(ad,A._afterSchedulerChange);A[C]=new x.Overlay(A.get(C));A[ac]=new x.Toolbar(A.get(ac));},getOverlayContentNode:function(){var A=this;var ar=A[C].get(ah);return ar.one(D+H);},getUpdatedSchedulerEvent:function(at){var A=this,au=A.get(h),ar={silent:!au},av=A.serializeForm();if(!au){au=A.clone();}au.set(G,A.get(G),{silent:true});au.setAttrs(x.merge(av,at),ar);return au;},_afterSchedulerChange:function(au){var A=this;var at=au.newVal;var ar=at.get(ah);A[C].set(t,ar);ar.delegate(W,x.bind(A._onClickSchedulerEvent,A),D+E);},_defCancelEventFn:function(ar){var A=this;A.get(ap).remove();A.hideOverlay();},_defDeleteEventFn:function(at){var A=this;var ar=A.get(G);ar.removeEvent(A.get(h));A.hideOverlay();ar.syncEventsUI();},_defEditEventFn:function(at){var A=this;var ar=A.get(G);A.hideOverlay();ar.syncEventsUI();},_defSaveEventFn:function(at){var A=this;var ar=A.get(G);ar.addEvent(at.newSchedulerEvent);A.hideOverlay();ar.syncEventsUI();},_handleCancelEvent:function(ar){var A=this;A.fire("cancel");ar.preventDefault();},_handleDeleteEvent:function(ar){var A=this;A.fire("delete",{schedulerEvent:A.get(h)});ar.preventDefault();},_handleSaveEvent:function(at){var A=this,ar=A.get(h)?"edit":"save";A.fire(ar,{newSchedulerEvent:A.getUpdatedSchedulerEvent()});at.preventDefault();},_onClickSchedulerEvent:function(at){var A=this;var ar=at.currentTarget.getData(Q);if(ar){A.set(h,ar,{silent:true});A.showOverlay([at.pageX,at.pageY]);A.get(ap).remove();}},_onOverlayVisibleChange:function(ar){var A=this;if(ar.newVal){A.populateForm();if(!A.get(h)){var at=A.getOverlayContentNode();if(at){setTimeout(function(){at.selectText();},0);}}}else{A.set(h,null,{silent:true});A.get(ap).remove();}},_onSubmitForm:function(ar){var A=this;A._handleSaveEvent(ar);},_renderOverlay:function(){var ar=this;var A=ar.get(a);ar[C].render();ar[ac].render();var at=ar[C].get(ah);at.addClass(v);ar[C].set(k,ar[ac].get(ah));ar[C].on(ab,x.bind(ar._onOverlayVisibleChange,ar));ar.formNode=x.Node.create(i);ar[C].set(u,ar.formNode);ar.formNode.on(f,x.bind(ar._onSubmitForm,ar));},getFormattedDate:function(){var at=this;var ar=at.get(Y);var av=(at.get(h)||at);var ax=av.get(an);var aw=av.get(G);var A=av.get(aj);var au=(aw.get(e).get(af)?o.toIsoTimeString:o.toUsTimeString);return[av._formatDate(A,ar),au(A),I,au(ax)].join(d);},getTemplateData:function(){var ar=this,A=ar.get(a),at=ar.get(h)||ar,au=at.get(S);if(B(au)){au=A["description-hint"];}return{content:au,date:ar.getFormattedDate(),endDate:at.get(an).getTime(),startDate:at.get(aj).getTime()};},hideOverlay:function(){var A=this;A[C].hide();},populateForm:function(){var A=this;A.formNode.setContent(A.get(j).parse(A.getTemplateData()));
},serializeForm:function(){var A=this;return x.QueryString.parse(ag(A.formNode.getDOM()));},showOverlay:function(aC,at){var aB=this,az=aB[C].get(t),au=aB.get(ak),ax=aC.concat([]);if(!aB[C].get(ae)){aB._renderOverlay();}aB[C].show();if(!aC){var ay=(aB.get(h)||aB).get(ap);var ar=ay.one(D+aa);at=[au[0]+ar.get(X),au[1]+ar.get(T)/2];aC=ar.getXY();}at=at||au;aC[0]+=at[0];aC[1]+=at[1];var A=aB[C].get(ah),aw=A.get(X),av=A.one(D+z),aA=A.all(D+b);if((aC[0]+aw)>=az.get(X)){aA.addClass(J);aC[0]-=aw+aA.item(0).get(X);}aB[C].set("xy",aC);if(ax[1]>=(av.get(T)+av.getY())){aA.addClass(l);}else{aA.removeClass(l);}}}});x.SchedulerEventRecorder=g;},"@VERSION@",{skinnable:true,requires:["aui-scheduler-base","aui-template","aui-toolbar","io-form","querystring","overlay"]});AUI.add("aui-scheduler",function(a){},"@VERSION@",{use:["aui-scheduler-base","aui-scheduler-view-day","aui-scheduler-view-week","aui-scheduler-view-table","aui-scheduler-view-table-dd","aui-scheduler-view-month","aui-scheduler-event-recorder"],skinnable:false});