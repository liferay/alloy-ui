AUI.add("aui-scheduler-base",function(aQ){var ax=aQ.Lang,d=ax.isArray,bh=ax.isBoolean,k=ax.isDate,bc=ax.isFunction,ai=ax.isNumber,T=ax.isObject,bo=ax.isString,aR=ax.isValue,a7=aQ.ColorUtil,p=aQ.DataType.DateMath,aJ=aQ.WidgetStdMod,aK=":",m=".",al="",F="&ndash;",bA=" ",x=function(A){return A instanceof aQ.ModelList;},E=function(A){return A instanceof aQ.SchedulerView;},i="%H:%M",Z="%l",by="%M",ay=function(A){var bC=[Z];if(A.getMinutes()>0){bC.push(aK);bC.push(by);}if(A.getHours()>=12){bC.push("p");}return bC.join(al);},aZ="data-view-name",D="scheduler-base",V="scheduler-calendar",aL="scheduler-view",ad="activeView",J="all",Y="allDay",ae="borderColor",aW="borderColorRGB",aP="borderStyle",bv="borderWidth",aS="button",bm="clearfix",a8="color",a1="colorBrightnessFactor",bj="colorSaturationFactor",aO="content",ac="controls",a4="controlsNode",a2="date",be="day",I="disabled",aX="endDate",ar="eventRecorder",bx="hd",K="header",bk="headerNode",u="helper",aE="hidden",U="hsbColor",aD="icon",r="iconNextNode",bb="iconPrevNode",ah="icons",au="inherit",a3="isoTime",bu="locale",bs="meeting",t="name",az="nav",aq="navNode",f="navigationDateFormatter",v="next",h="nextDate",y="node",av="noscroll",ak="pallete",bi="prev",a5="prevDate",bd="radio",an="reminder",bw="rendered",bn="repeated",ap="scheduler",aF="scheduler-event",br="scrollable",a="short",bq="startDate",ab="strings",a0="title",j="titleDateFormat",l="today",aT="todayNode",H="triggerNode",S="view",X="viewDateNode",at="viewStack",bz="views",aI="viewsNode",aB="visible",R=aQ.getClassName,aU=R(u,bm),q=R(aD),a9=R(D,ac),o=R(D,bx),aH=R(D,aD,v),W=R(D,aD,bi),bp=R(D,az),P=R(D,l),aM=R(D,S),n=R(D,S,al),N=R(D,S,a2),C=R(aL,av),c=R(aL,br),aj="yui3-button-selected",B=R(D,bz),z=R(aF),Q=R(aF,J,be),aY=R(aF,aO),bl=R(aF,I),L=R(aF,aE),G=R(aF,aD,I),O=R(aF,aD,bs),aC=R(aF,aD,an),e=R(aF,aD,bn),bt=R(aF,ah),b=R(aF,bs),w=R(aF,an),aG=R(aF,bn),aw=R(aF,a),M=R(aF,a0),a6='<div class="'+a9+'"></div>',g='<div class="'+o+'"></div>',bB='<button type="button" class="'+[q,aH].join(bA)+' yui3-button">Next</button>',aV='<button type="button" class="'+[q,W].join(bA)+' yui3-button">Prev</button>',s='<div class="'+bp+'"></div>',aA='<button type="button" class="'+P+' yui3-button">{today}</button>',bg='<button type="button" class="'+[aM,n].join(bA)+'{name}" data-view-name="{name}">{label}</button>',aN='<div class="'+N+'"></div>',am='<div class="'+B+'"></div>';var af=aQ.Component.create({NAME:aF,ATTRS:{allDay:{setter:aQ.DataType.Boolean.parse,value:false},borderStyle:{value:"solid",validator:bo},borderWidth:{value:"1px",validator:bo},colorBrightnessFactor:{value:0.75,validator:ai},colorSaturationFactor:{value:1.5,validator:ai},content:{setter:String,validator:aR},color:{lazyAdd:false,setter:"_setColor",value:"#D96666",validator:bo},titleDateFormat:{getter:"_getTitleDateFormat",value:function(){var A=this,bC=A.get(ap),bD=bC&&bC.get(ad).get(a3),bE={endDate:F+bA+i,startDate:i};if(!bD){bE.endDate=F+bA+ay(A.get(aX));bE.startDate=ay(A.get(bq));}if(A.getMinutesDuration()<=30){delete bE.endDate;}else{if(A.get(Y)){bE={};}}return bE;}},endDate:{setter:"_setDate",valueFn:function(){var A=p.clone(this.get(bq));A.setHours(A.getHours()+1);return A;}},disabled:{value:false,validator:bh},meeting:{value:false,validator:bh},node:{valueFn:function(){return aQ.NodeList.create(aQ.Node.create(this.EVENT_NODE_TEMPLATE).setData(aF,this));}},reminder:{value:false,validator:bh},repeated:{value:false,validator:bh},scheduler:{},startDate:{setter:"_setDate",valueFn:function(){return new Date();}},visible:{value:true,validator:bh}},EXTENDS:aQ.Model,PROPAGATE_ATTRS:[Y,bq,aX,aO,a8,a1,bj,aP,bv,j,aB,I],prototype:{EVENT_NODE_TEMPLATE:'<div class="'+z+'">'+'<div class="'+M+'"></div>'+'<div class="'+aY+'"></div>'+'<div class="'+bt+'">'+'<span class="'+[q,G].join(bA)+'"></span>'+'<span class="'+[q,O].join(bA)+'"></span>'+'<span class="'+[q,aC].join(bA)+'"></span>'+'<span class="'+[q,e].join(bA)+'"></span>'+"</div>"+"</div>",initializer:function(){var A=this;A.bindUI();A.syncUI();},bindUI:function(){var A=this;A.after({allDayChange:A._afterAllDayChange,colorChange:A._afterColorChange,disabledChange:A._afterDisabledChange,endDateChange:A._afterEndDateChange,meetingChange:A._afterMeetingChange,reminderChange:A._afterReminderChange,repeatedChange:A._afterRepeatedChange,visibleChange:A._afterVisibleChange});},syncUI:function(){var A=this;A._uiSetAllDay(A.get(Y));A._uiSetColor(A.get(a8));A._uiSetDisabled(A.get(I));A._uiSetEndDate(A.get(aX));A._uiSetMeeting(A.get(bs));A._uiSetReminder(A.get(an));A._uiSetRepeated(A.get(bn));A._uiSetVisible(A.get(aB));A.syncNodeTitleUI();A.syncNodeContentUI();},destroy:function(){var A=this;A.get(y).remove(true);},addPaddingNode:function(){var A=this;A.get(y).push(aQ.Node.create(A.EVENT_NODE_TEMPLATE).setData(aF,A));A.syncUI();},clone:function(){var bC=this,A=null,bD=bC.get(ap);if(bD){A=new bD.eventModel();A.copyPropagateAttrValues(bC,null,{silent:true});}return A;},copyDates:function(bC,bD){var A=this;A.setAttrs({endDate:p.clone(bC.get(aX)),startDate:p.clone(bC.get(bq))},bD);},copyPropagateAttrValues:function(bD,bF,bE){var A=this,bC={};A.copyDates(bD,bE);aQ.Array.each(A.constructor.PROPAGATE_ATTRS,function(bG){if(!((bF||{}).hasOwnProperty(bG))){var bH=bD.get(bG);if(!T(bH)){bC[bG]=bH;}}});A.setAttrs(bC,bE);},getBorderColor:function(){var A=this;return A[aW].hex;},getDaysDuration:function(){var A=this;return p.getDayOffset(A.get(aX),A.get(bq));},getHoursDuration:function(){var A=this;return p.getHoursOffset(A.get(aX),A.get(bq));},getMinutesDuration:function(){var A=this;return p.getMinutesOffset(A.get(aX),A.get(bq));},getSecondsDuration:function(){var A=this;return p.getSecondsOffset(A.get(aX),A.get(bq));},sameEndDate:function(bC){var A=this;return p.compare(A.get(aX),bC.get(aX));},sameStartDate:function(bC){var A=this;return p.compare(A.get(bq),bC.get(bq));},isAfter:function(bE){var bD=this;var bC=bD.get(bq);var A=bE.get(bq);return p.after(bC,A);},isBefore:function(bE){var bD=this;var bC=bD.get(bq);var A=bE.get(bq);
return p.before(bC,A);},intersects:function(bE){var bD=this;var bF=bD.get(aX);var bC=bD.get(bq);var A=bE.get(bq);return(bD.sameStartDate(bE)||p.between(A,bC,bF));},intersectHours:function(bD){var bC=this;var bF=bC.get(aX);var A=bC.get(bq);var bE=p.clone(A);p.copyHours(bE,bD.get(bq));return(p.compare(A,bE)||p.between(bE,A,bF));},isDayBoundaryEvent:function(){var A=this;return p.isDayBoundary(A.get(bq),A.get(aX));},isDayOverlapEvent:function(){var A=this;return p.isDayOverlap(A.get(bq),A.get(aX));},getClearEndDate:function(){var A=this;return p.safeClearTime(A.get(aX));},getClearStartDate:function(){var A=this;return p.safeClearTime(A.get(bq));},move:function(bD,bC){var A=this;var bE=A.getMinutesDuration();A.setAttrs({endDate:p.add(p.clone(bD),p.MINUTES,bE),startDate:bD},bC);},setContent:function(bC){var A=this;A.get(y).each(function(bE){var bD=bE.one(m+aY);bD.setContent(bC);});},setTitle:function(bC){var A=this;A.get(y).each(function(bD){var bE=bD.one(m+M);bE.setContent(bC);});},syncNodeContentUI:function(){var A=this;A.setContent(A.get(aO));},syncNodeTitleUI:function(){var bC=this,bE=bC.get(j),A=bC.get(bq),bD=bC.get(aX),bF=[];if(bE.startDate){bF.push(bC._formatDate(A,bE.startDate));}if(bE.endDate){bF.push(bC._formatDate(bD,bE.endDate));}bC.setTitle(bF.join(bA));},split:function(){var A=this,bD=p.clone(A.get(bq)),bE=p.clone(A.get(aX));if(A.isDayOverlapEvent()&&!A.isDayBoundaryEvent()){var bC=p.clone(bD);bC.setHours(24,0,0,0);return[[bD,p.toMidnight(p.clone(bD))],[bC,p.clone(bE)]];}return[[bD,bE]];},_afterAllDayChange:function(bC){var A=this;A._uiSetAllDay(bC.newVal);},_afterColorChange:function(bC){var A=this;A._uiSetColor(bC.newVal);},_afterDisabledChange:function(bC){var A=this;A._uiSetDisabled(bC.newVal);},_afterEndDateChange:function(bC){var A=this;A._uiSetEndDate(bC.newVal);},_afterMeetingChange:function(bC){var A=this;A._uiSetMeeting(bC.newVal);},_afterReminderChange:function(bC){var A=this;A._uiSetReminder(bC.newVal);},_afterRepeatedChange:function(bC){var A=this;A._uiSetRepeated(bC.newVal);},_afterVisibleChange:function(bC){var A=this;A._uiSetVisible(bC.newVal);},_setColor:function(bC){var A=this;A[U]=a7.rgb2hsb(a7.getRGB(bC));A[ae]=aQ.clone(A[U]);A[ae].b*=A.get(a1);A[ae].s*=A.get(bj);A[aW]=a7.hsb2rgb(A[ae]);return bC;},_setDate:function(bC){var A=this;if(ai(bC)){bC=new Date(bC);}return bC;},_formatDate:function(bD,bE){var bC=this;var A=bC.get(bu);return aQ.DataType.Date.format(bD,{format:bE,locale:A});},_getTitleDateFormat:function(bC){var A=this;if(bo(bC)){bC={endDate:bC,startDate:bC};}else{if(bc(bC)){bC=bC.call(A);}}return bC;},_uiSetAllDay:function(bC){var A=this;A.get(y).toggleClass(Q,!!bC);},_uiSetColor:function(bE){var A=this;var bD=A.get(y);var bF=A.getBorderColor();if(bD){var bC={borderWidth:A.get(bv),borderColor:bF,backgroundColor:bE,borderStyle:A.get(aP),color:au};bD.setStyles(bC);}},_uiSetDisabled:function(bC){var A=this;A.get(y).toggleClass(bl,!!bC);},_uiSetEndDate:function(bC){var A=this;A.get(y).toggleClass(aw,A.getMinutesDuration()<=30);},_uiSetMeeting:function(bC){var A=this;A.get(y).toggleClass(b,!!bC);},_uiSetReminder:function(bC){var A=this;A.get(y).toggleClass(w,!!bC);},_uiSetRepeated:function(bC){var A=this;A.get(y).toggleClass(aG,!!bC);},_uiSetVisible:function(bC){var A=this;A.get(y).toggleClass(L,!bC);}}});aQ.SchedulerEvent=af;var ba=aQ.Base.create(V,aQ.ModelList,[],{model:aQ.SchedulerEvent,initializer:function(){var A=this;A.after("colorChange",A._afterColorChange);A.after("disabledChange",A._afterDisabledChange);A.after("visibleChange",A._afterVisibleChange);A.after(["add","remove","reset"],A._afterEventsChange);A.on(["remove","reset"],A._onRemoveEvents);A._uiSetEvents(A.toArray());A._setModelsAttrs({color:A.get(a8),disabled:A.get(I),visible:A.get(aB)});},_afterColorChange:function(bC){var A=this;A._setModelsAttrs({color:A.get(a8)},{silent:bC.silent});},_afterDisabledChange:function(bC){var A=this;A._setModelsAttrs({disabled:A.get(I)},{silent:bC.silent});},_afterEventsChange:function(bC){var A=this;A._setModelsAttrs({color:A.get(a8),disabled:A.get(I),visible:A.get(aB)},{silent:true});A._uiSetEvents(A.toArray());},_afterVisibleChange:function(bC){var A=this;A._setModelsAttrs({visible:A.get(aB)},{silent:bC.silent});},_onRemoveEvents:function(bD){var A=this;var bC=A.get(ap);if(bC){bC.removeEvents(A);}},_setModelsAttrs:function(bC,bD){var A=this;A.each(function(bE){bE.setAttrs(bC,bD);});},_uiSetEvents:function(bD){var A=this;var bC=A.get(ap);if(bC){bC.addEvents(bD);bC.syncEventsUI();}}},{ATTRS:{color:{valueFn:function(){var bC=this;var bD=bC.get(ak);var A=Math.ceil(Math.random()*bD.length)-1;return bD[A];},validator:bo},disabled:{value:false,validator:bh},name:{value:"(no name)",validator:bo},pallete:{value:["#d96666","#e67399","#b373b3","#8c66d9","#668cb3","#668cd9","#59bfb3","#65ad89","#4cb052","#8cbf40","#bfbf4d","#e0c240","#f2a640","#e6804d","#be9494","#a992a9","#8997a5","#94a2be","#85aaa5","#a7a77d","#c4a883","#c7561e","#b5515d","#c244ab","#603f99","#536ca6","#3640ad","#3c995b","#5ca632","#7ec225","#a7b828","#cf9911","#d47f1e","#b56414","#914d14","#ab2671","#9643a5","#4585a3","#737373","#41a587","#d1bc36","#ad2d2d"],validator:d},scheduler:{},visible:{value:true,validator:bh}}});aQ.SchedulerCalendar=ba;aQ.SchedulerEvents=aQ.Base.create("scheduler-events",aQ.ModelList,[],{comparator:function(bC){var A=bC.get(bq),bD=bC.get(aX);return A+1/(bD-A);},model:aQ.SchedulerEvent},{ATTRS:{scheduler:{}}});var ao=function(){};ao.ATTRS={};aQ.mix(ao.prototype,{calendarModel:aQ.SchedulerCalendar,eventModel:aQ.SchedulerEvent,eventsModel:aQ.SchedulerEvents,initializer:function(bC){var A=this;A._events=new A.eventsModel({after:{add:aQ.bind(A._afterAddEvent,A)},bubbleTargets:A,scheduler:A});A.addEvents(bC.items||bC.events);},addEvents:function(bD){var A=this,bC=A._toSchedulerEvents(bD);return A._events.add(bC);},eachEvent:function(bC){var A=this;return A._events.each(bC);},flushEvents:function(){var A=this;A._events.each(function(bC){delete bC._filtered;});},getEventByClientId:function(bC){var A=this;
return A._events.getByClientId(bC);},getEvents:function(bD){var A=this,bC=A._events;bC.sort({silent:true});if(bD){bC=bC.filter(bD);}else{bC=bC.toArray();}return bC;},getEventsByDay:function(bC,bD){var A=this;bC=p.safeClearTime(bC);return A.getEvents(function(bE){return p.compare(bE.getClearStartDate(),bC)||(bD&&p.compare(bE.getClearEndDate(),bC));});},getIntersectEvents:function(bC){var A=this;bC=p.safeClearTime(bC);return A.getEvents(function(bE){var bD=bE.getClearStartDate();var bF=bE.getClearEndDate();return(bE.get(aB)&&(p.compare(bC,bD)||p.compare(bC,bF)||p.between(bC,bD,bF)));});},removeEvents:function(bD){var A=this,bC=A._toSchedulerEvents(bD);return A._events.remove(bC);},resetEvents:function(bD){var A=this,bC=A._toSchedulerEvents(bD);return A._events.reset(bC);},_afterAddEvent:function(bC){var A=this;bC.model.set(ap,A);},_toSchedulerEvents:function(bC){var A=this,bD=[];if(x(bC)){bD=bC.toArray();bC.set(ap,A);}else{if(d(bC)){aQ.Array.each(bC,function(bE){if(x(bE)){bD=bD.concat(bE.toArray());bE.set(ap,A);}else{bD.push(bE);}});}else{bD=bC;}}return bD;}});aQ.SchedulerEventSupport=ao;var ag=aQ.Component.create({NAME:D,ATTRS:{activeView:{validator:E},date:{value:new Date(),validator:k},eventRecorder:{setter:"_setEventRecorder"},strings:{value:{agenda:"Agenda",day:"Day",month:"Month",today:"Today",week:"Week",year:"Year"}},navigationDateFormatter:{value:function(bC){var A=this;return aQ.DataType.Date.format(bC,{format:"%B %d, %Y",locale:A.get(bu)});},validator:bc},views:{setter:"_setViews",value:[]},viewDate:{getter:"_getViewDate",readOnly:true},firstDayOfWeek:{value:0,validator:ai},controlsNode:{valueFn:function(){return aQ.Node.create(a6);}},viewDateNode:{valueFn:function(){return aQ.Node.create(aN);}},headerNode:{valueFn:function(){return aQ.Node.create(g);}},iconNextNode:{valueFn:function(){return aQ.Node.create(bB);}},iconPrevNode:{valueFn:function(){return aQ.Node.create(aV);}},navNode:{valueFn:function(){return aQ.Node.create(s);}},todayNode:{valueFn:function(){return aQ.Node.create(this._processTemplate(aA));}},viewsNode:{valueFn:function(){return aQ.Node.create(am);}}},HTML_PARSER:{controlsNode:m+a9,viewDateNode:m+N,headerNode:m+o,iconNextNode:m+aH,iconPrevNode:m+W,navNode:m+bp,todayNode:m+P,viewsNode:m+B},UI_ATTRS:[a2,ad],AUGMENTS:[aQ.SchedulerEventSupport,aQ.WidgetStdMod],prototype:{viewStack:null,initializer:function(){var A=this;A[at]={};A[a4]=A.get(a4);A[X]=A.get(X);A[K]=A.get(bk);A[r]=A.get(r);A[bb]=A.get(bb);A[aq]=A.get(aq);A[aT]=A.get(aT);A[aI]=A.get(aI);A.after({activeViewChange:A._afterActiveViewChange,render:A._afterRender});},bindUI:function(){var A=this;A._bindDelegate();},syncUI:function(){var A=this;A.syncStdContent();},getViewByName:function(bC){var A=this;return A[at][bC];},getStrings:function(){var A=this;return A.get(ab);},getString:function(bC){var A=this;return A.getStrings()[bC];},renderView:function(bC){var A=this;if(bC){bC.show();if(!bC.get(bw)){if(!A.bodyNode){A.setStdModContent(aJ.BODY,al);}bC.render(A.bodyNode);}}},plotViewEvents:function(bC){var A=this;bC.plotEvents(A.getEvents());},syncEventsUI:function(){var A=this,bC=A.get(ad);if(bC){A.plotViewEvents(bC);}},renderButtonGroup:function(){var A=this;A.buttonGroup=new aQ.ButtonGroup({srcNode:A[aI],type:bd,on:{selectionChange:aQ.bind(A._onButtonGroupSelectionChange,A)}}).render();},syncStdContent:function(){var A=this;var bC=A.get(bz);A[aq].append(A[bb]);A[aq].append(A[r]);A[a4].append(A[aT]);A[a4].append(A[aq]);A[a4].append(A[X]);aQ.Array.each(bC,function(bD){A[aI].append(A._createViewTriggerNode(bD));});A[K].append(A[a4]);A[K].append(A[aI]);A[K].addClass(aU);A.setStdModContent(aJ.HEADER,A[K].getDOM());},_afterActiveViewChange:function(bE){var bC=this;if(bC.get(bw)){var bD=bE.newVal;var A=bE.prevVal;if(A){A.hide();}bC.renderView(bD);var bF=bC.get(ar);if(bF){bF.hideOverlay();}bC._uiSetDate(bC.get(a2));}},_afterRender:function(bD){var A=this,bC=A.get(ad);A.renderView(bC);A.renderButtonGroup();A._uiSetDate(A.get(a2));A._uiSetActiveView(bC);},_bindDelegate:function(){var A=this;A[a4].delegate("click",A._onClickPrevIcon,m+W,A);A[a4].delegate("click",A._onClickNextIcon,m+aH,A);A[a4].delegate("click",A._onClickToday,m+P,A);},_createViewTriggerNode:function(bC){var A=this;if(!bC.get(H)){var bD=bC.get(t);bC.set(H,aQ.Node.create(ax.sub(bg,{name:bD,label:(A.getString(bD)||bD)})));}return bC.get(H);},_getViewDate:function(){var A=this,bC=A.get(a2),bD=A.get(ad);if(bD){bC=bD.getAdjustedViewDate(bC);}return bC;},_onClickToday:function(bD){var A=this,bC=A.get(ad);if(bC){A.set(a2,bC.getToday());}bD.preventDefault();},_onClickNextIcon:function(bD){var A=this,bC=A.get(ad);if(bC){A.set(a2,bC.get(h));}bD.preventDefault();},_onClickPrevIcon:function(bD){var A=this,bC=A.get(ad);if(bC){A.set(a2,bC.get(a5));}bD.preventDefault();},_onButtonGroupSelectionChange:function(bC){var A=this,bD=bC.originEvent.target.attr(aZ);A.set(ad,A.getViewByName(bD));bC.preventDefault();},_processTemplate:function(bC){var A=this;return ax.sub(bC,A.getStrings());},_setEventRecorder:function(bC){var A=this;if(bC){bC.setAttrs({scheduler:A},{silent:true});bC.addTarget(A);}},_setViews:function(bD){var A=this;var bC=[];aQ.Array.each(bD,function(bE){if(E(bE)&&!bE.get(bw)){bE.setAttrs({scheduler:A});bC.push(bE);A[at][bE.get(t)]=bE;}});if(!A.get(ad)){A.set(ad,bD[0]);}return bC;},_uiSetActiveView:function(bE){var A=this;if(bE){var bD=bE.get(t),bC=A[aI].one(m+n+bD);if(bC){A[aI].all(aS).removeClass(aj);bC.addClass(aj);}}},_uiSetDate:function(bF){var bC=this;var bE=bC.get(f);var A=bE.call(bC,bF);if(bC.get(bw)){var bD=bC.get(ad);if(bD){bD._uiSetDate(bF);bE=bD.get(f);A=bE.call(bD,bF);}bC[X].html(A);bC.syncEventsUI();}}}});aQ.Scheduler=ag;var aa="firstDayOfWeek";var bf=aQ.Component.create({NAME:aL,AUGMENTS:[aQ.WidgetStdMod],ATTRS:{bodyContent:{value:al},filterFn:{validator:bc,value:function(A){return true;}},height:{value:600},isoTime:{value:false,validator:bh},name:{value:al,validator:bo},navigationDateFormatter:{value:function(bC){var A=this;var bD=A.get(ap);return aQ.DataType.Date.format(bC,{format:"%A, %d %B, %Y",locale:bD.get(bu)});
},validator:bc},nextDate:{getter:"getNextDate",readOnly:true},prevDate:{getter:"getPrevDate",readOnly:true},scheduler:{lazyAdd:false,setter:"_setScheduler"},scrollable:{value:true,validator:bh},triggerNode:{setter:aQ.one},visible:{value:false}},BIND_UI_ATTRS:[br],prototype:{initializer:function(){var A=this;A.after("render",A._afterRender);},syncUI:function(){var A=this;A.syncStdContent();},getAdjustedViewDate:function(bC){var A=this;return p.toMidnight(bC);},flushViewCache:function(){},getNextDate:function(){},getPrevDate:function(){},getToday:function(){return p.clearTime(new Date());},limitDate:function(bC,bD){var A=this;if(p.after(bC,bD)){bC=p.clone(bD);}return bC;},plotEvents:function(){},syncStdContent:function(){},syncEventUI:function(A){},_uiSetDate:function(A){},_afterRender:function(bD){var A=this;var bC=A.get(ap);A._uiSetScrollable(A.get(br));},_setScheduler:function(bD){var A=this;var bC=A.get(ap);if(bC){A.removeTarget(bC);}if(bD){A.addTarget(bD);bD.after(["*:add","*:remove","*:reset"],aQ.bind(A.flushViewCache,A));}return bD;},_uiSetScrollable:function(bD){var A=this;var bC=A.bodyNode;if(bC){bC.toggleClass(c,bD);bC.toggleClass(C,!bD);}},_findFirstDayOfWeek:function(bD){var A=this;var bE=A.get(ap);var bC=bE.get(aa);return p.getFirstDayOfWeek(bD,bC);}}});aQ.SchedulerView=bf;},"@VERSION@",{requires:["aui-base","aui-color-util","aui-datatype","button-group","model","model-list","widget-stdmod"],skinnable:true});AUI.add("aui-scheduler-view-day",function(bu){var bE=bu.Lang,az=bE.isBoolean,r=bE.isFunction,al=bE.isNumber,bK=bE.isObject,bn=bE.isString,Y=bu.DataType.DateMath,br=bu.WidgetStdMod,by="a",j=",",Z=".",x="",O="%",a7=" ",o="data-colnumber",bf="scheduler-view",ak="scheduler-view-day",e=bu.cached(function(){var bQ=bu.config.doc,bO=bQ.createElement("div"),A=bQ.getElementsByTagName("body")[0],bP=0.1;if(A){bO.style.cssText="position:absolute;visibility:hidden;overflow:scroll;width:20px;";bO.appendChild(bQ.createElement("p")).style.height="1px";A.insertBefore(bO,A.firstChild);bP=bO.offsetWidth-bO.clientWidth;A.removeChild(bO);}return bP;},null,0.1),D=function(A,bO){return function(bQ){var bP=bQ.all(A);return(bP.size()>=bO)?bP:null;};},be=function(bO,A){return Math.round(bO/A)*A;},bc=function(A){return parseFloat(A)||0;},aJ="activeColumn",bb="activeView",E="allDay",av="boundingBox",S="col",ae="colDaysNode",bw="colHeaderDaysNode",z="colblank",q="coldata",an="colday",a="colgrid",L="colspan",g="coltime",aU="columnData",ay="columnDayHeader",ao="columnShims",aM="columnTime",at="container",M="creationStartDate",a1="date",ba="viewDate",bC="day",J="days",t="delegateConfig",a9="disabled",aT="division",bg="dotted",v="draggingEvent",bl="duration",ag="endDate",bG="eventClass",a8="eventPlaceholder",bM="eventRecorder",l="eventWidth",bq="filterFn",am="first",aL="grid",a0="gridContainer",aF="grip",bL="hd",bt="header",aH="headerDateFormatter",bJ="headerTableNode",aC="headerView",aS="headerViewConfig",aq="headerViewLabelNode",bi="height",aI="horizontal",au="host",aj="hourHeight",n="icon",V="isoTime",N="label",aw="left",af="locale",f="marginRight",P="marker",aG="markercell",aA="markercellsNode",B="markers",a6="markersNode",bN="node",bs="offsetHeight",bv="pad",H="parentNode",aY="proxy",T="px",Q="region",bh="resizer",bo="resizerNode",bd="resizing",aB="right",k="scheduler",ah="scheduler-event",I="shim",bx="startDate",K="startXY",bp="strings",ax="table",a2="tableNode",aV="time",U="timesNode",W="today",aW="top",aZ="view",ad="visible",a5="width",a4="data",u=bu.getClassName,c=u(n),w=u(n,aF,bg,aI),aD=u(bf,ax,a4),ap=u(ah),aP=u(ah,a9),bk=u(ah,aY),F=u(k,W),X=u(k,W,bL),s=u(bf,q),b=u(bf,a),bz=u(bf,aL),bA=u(bf,aL,at),aE=u(bf,bC,bt,S),m=u(bf,bC,bt,bC),bm=u(bf,bC,bt,bC,am),aQ=u(bf,bC,bt,bC,bv,aB),bD=u(bf,bC,bt,ax),aK=u(bf,bC,bt,aZ,N),aR=u(bf,P,aT),bB=u(bf,aG),C=u(bf,B),bj=u(bf,bC,bh),ar=u(bf,bC,bh,n),a3=u(bf,bC,ax),bH=u(bf,bC,ax,S),ai=u(bf,bC,ax,S,I),G=u(bf,bC,ax,z),y=u(bf,bC,ax,an),bF=u(bf,bC,ax,g),aX=u(bf,bC,ax,aV),i='<div class="'+bj+'">'+'<div class="'+[c,w,ar].join(a7)+'"></div>'+"</div>",R='<div class="'+bB+'">'+'<div class="'+aR+'"></div>'+"</div>",h='<span class="'+aK+'">{label}</span>',ab='<table cellspacing="0" cellpadding="0" class="'+a3+'">'+"<tbody>"+'<tr class="'+b+'" height="1">'+'<td height="0" class="'+[bH,G].join(a7)+'"></td>'+'<td class="'+bA+'" colspan="1">'+'<div class="'+bz+'">'+'<div class="'+C+'"></div>'+"</div>"+"</td>"+"</tr>"+'<tr class="'+s+'">'+'<td class="'+[bH,bF].join(a7)+'"></td>'+"</tr>"+"</tbody>"+"</table>",aN='<td class="'+[bH,y].join(a7)+'" data-colnumber="{colNumber}">'+'<div class="'+ai+'"></div>'+"</td>",d='<div class="'+aX+'">{hour}</div>',ac='<table cellspacing="0" cellpadding="0" class="'+bD+'">'+"<tbody>"+'<tr class="'+aE+'"></tr>'+"</tbody>"+"</table>",aO='<th class="'+m+'" data-colnumber="{colNumber}"><a href="#">&nbsp;</a></th>',aa='<td class="'+[m,bm].join(a7)+'"></td>',p='<th class="'+[m,aQ].join(a7)+'">&nbsp;</th>';var bI=bu.Component.create({NAME:ak,ATTRS:{bodyContent:{value:x},days:{value:1,validator:al},delegateConfig:{value:{},setter:function(bO){var A=this;return bu.merge({dragConfig:{useShim:false},bubbleTargets:A,container:A.get(av),nodes:Z+ap,invalid:"input, select, button, a, textarea, "+Z+aP},bO||{});},validator:bK},eventWidth:{value:95,validator:al},filterFn:{value:function(A){return(A.getHoursDuration()<=24&&!A.get(E));}},headerDateFormatter:{value:function(bO){var A=this;var bP=A.get(k);return bu.DataType.Date.format(bO,{format:"%d %A",locale:bP.get(af)});},validator:bn},headerView:{value:true,validator:az},headerViewConfig:{setter:function(bO){var A=this;return bu.merge({displayDaysInterval:1,displayRows:6,filterFn:function(bP){return((bP.getHoursDuration()>24)||bP.get(E));},height:"auto",visible:true},bO||{});},value:{}},hourHeight:{value:52,validator:al},name:{value:bC},navigationDateFormatter:{value:function(bO){var A=this;var bP=A.get(k);return bu.DataType.Date.format(bO,{format:"%A, %B %d, %Y",locale:bP.get(af)});},validator:r},strings:{value:{allDay:"All day"}},headerTableNode:{valueFn:function(){return bu.Node.create(ac);
}},headerViewLabelNode:{valueFn:function(){var bO=this;var A=bO.get(bp);return bu.Node.create(bE.sub(h,{label:A[E]}));}},resizerNode:{valueFn:function(){return bu.Node.create(i);}},tableNode:{valueFn:function(){return bu.Node.create(ab);}},colDaysNode:{valueFn:"_valueColDaysNode"},colHeaderDaysNode:{valueFn:"_valueColHeaderDaysNode"},markercellsNode:{valueFn:"_valueMarkercellsNode"},timesNode:{valueFn:"_valueTimesNode"}},HTML_PARSER:{colDaysNode:D(Z+y,1),colHeaderDaysNode:D(Z+m,2),headerTableNode:Z+bD,headerViewLabelNode:Z+aK,markercellsNode:D(Z+bB,24),resizerNode:Z+bj,tableNode:Z+a3,timesNode:D(Z+aX,24)},EXTENDS:bu.SchedulerView,prototype:{initializer:function(){var A=this;A[ae]=A.get(ae);A[bw]=A.get(bw);A[bJ]=A.get(bJ);A[aA]=A.get(aA);A[bo]=A.get(bo);A[a2]=A.get(a2);A[U]=A.get(U);A[aJ]=null;A[aU]=A[a2].one(Z+s);A[ay]=A.headerTableNode.one(Z+aE);A[ao]=A[ae].all(Z+ai);A[aM]=A[a2].one(Z+bF);A[a0]=A[a2].one(Z+bA);A[a6]=A[a2].one(Z+C);if(A.get(aC)){A[aC]=new bu.SchedulerTableView(A.get(aS));}},renderUI:function(){var A=this;A[aM].setContent(A[U]);A[a6].setContent(A[aA]);A[ae].appendTo(A[aU]);A[bw].appendTo(A[ay]);if(A[aC]){A[aC].set(k,A.get(k));A[aC].render();}},bindUI:function(){var A=this;A[bJ].delegate("click",bu.bind(A._onClickDaysHeader,A),Z+m);A[aU].delegate("mousedown",bu.bind(A._onMouseDownTableCol,A),Z+bH);A[aU].delegate("mouseenter",bu.bind(A._onMouseEnterEvent,A),Z+ap);A[aU].delegate("mouseleave",bu.bind(A._onMouseLeaveEvent,A),Z+ap);A[aU].delegate("mousemove",bu.bind(A._onMouseMoveTableCol,A),Z+y);A[aU].delegate("mouseup",bu.bind(A._onMouseUpTableCol,A),Z+bH);A.on("drag:end",A._onEventDragEnd);A.on("drag:start",A._onEventDragStart);A.on("drag:tickAlignY",A._dragTickAlignY);A.on("schedulerChange",A._onSchedulerChange);A.after("drag:align",A._afterDragAlign);},syncUI:function(){var A=this;bI.superclass.syncUI.apply(this,arguments);A[a0].attr(L,A.get(J));A._setupDragDrop();},syncStdContent:function(){var bO=this;bO.setStdModContent(br.BODY,bO[a2].getDOM());var A=bu.NodeList.create(bO[bJ]);if(bO[aC]){A.push(bO[aC].get(av));A.push(bO.get(aq));}bO.setStdModContent(br.HEADER,A);},calculateEventHeight:function(bP){var bO=this;var A=bO.get(aj);return Math.max(bP*(A/60),A/2);},calculateTop:function(bO){var A=this;return((bO.getHours()*60)+bO.getMinutes()+(bO.getSeconds()/60))*(A.get(aj)/60);},getNextDate:function(){var A=this;var bO=A.get(k).get(ba);return Y.toLastHour(Y.add(bO,Y.DAY,1));},getPrevDate:function(){var A=this;var bO=A.get(k).get(ba);return Y.toMidnight(Y.subtract(bO,Y.DAY,1));},getColumnByDate:function(bO){var A=this;return A[ae].item(A.getDateDaysOffset(bO));},getColumnShimByDate:function(bO){var A=this;return A[ao].item(A.getDateDaysOffset(bO));},getDateByColumn:function(bO){var A=this;var bP=Y.safeClearTime(A.get(k).get(ba));return Y.add(bP,Y.DAY,bO);},getDateDaysOffset:function(bO){var A=this;var bP=Y.safeClearTime(A.get(k).get(ba));return Y.getDayOffset(Y.safeClearTime(bO),bP);},getYCoordTime:function(bR){var bO=this;var A=bO.get(aj);var bS=bc((bR/A).toFixed(2));var bQ=Math.floor((bS*100)%100*0.6);var bP=Math.floor(bS);return[bP,bQ,0];},plotEvent:function(bP){var A=this;var bQ=bP.get(bN);if(bQ.size()<2){bP.addPaddingNode();}var bS=bP.get(bN).item(0);var bO=bP.get(bN).item(1);var bR=A.getColumnShimByDate(bP.get(ag));var bT=A.getColumnShimByDate(bP.get(bx));if(bT){bT.append(bS);if(bP.get(ad)){bS.show();}}else{bS.hide();}if(bR){if(bR.compareTo(bT)||bP.isDayBoundaryEvent()){bO.hide();}else{bR.append(bO);if(bP.get(ad)){bO.show();}}}else{bO.hide();}bP.syncUI();A.syncEventTopUI(bP);A.syncEventHeightUI(bP);},plotEvents:function(){var A=this;var bO=A.get(k);var bP=A.get(bq);A[ao].each(function(bT,bS){var bQ=bO.getEventsByDay(A.getDateByColumn(bS),true);var bR=[];bT.empty();bu.Array.each(bQ,function(bU){if(bP.apply(A,[bU])){A.plotEvent(bU);bR.push(bU);}});A.syncEventsIntersectionUI(bR);});if(A.get(aC)){A.syncHeaderViewUI();}},syncColumnsUI:function(){var A=this;A[ae].each(function(bQ,bP){var bO=A.getDateByColumn(bP);bQ.toggleClass(F,Y.isToday(bO));});},syncDaysHeaderUI:function(){var bO=this;var bQ=bO.get(k).get(ba);var bP=bO.get(aH);var A=bO.get(af);bO[bw].all(by).each(function(bT,bS){var bR=Y.add(bQ,Y.DAY,bS);bT.toggleClass(X,Y.isToday(bR));bT.html(bP.call(bO,bR));});},syncEventsIntersectionUI:function(bO){var A=this;var bP=A.get(l);A.get(k).flushEvents();bu.Array.each(bO,function(bR){var bT=A.findEventIntersections(bR,bO);var bS=bT.length;var bQ=(bP/bS);bu.Array.each(bT,function(bV,bW){var bU=bV.get(bN).item(0);var bY=bQ*bW;var bX=bQ*1.7;if(bW===(bS-1)){bX=bP-bY;}bU.setStyle(a5,bX+O);bU.setStyle(aw,bY+O);var bZ=bU.get(H);if(bZ){bZ.insert(bU,bW);}bV._filtered=true;});});},syncEventHeightUI:function(bQ){var bO=this;var bU=bQ.get(ag);var A=bQ.get(bx);var bR=Y.clone(A);bR.setHours(24,0,0);var bS=Y.getMinutesOffset(bO.limitDate(bU,bR),A);bQ.get(bN).item(0).set(bs,bO.calculateEventHeight(bS));var bP=bQ.get(bN).item(1);if(bP.inDoc()){var bT=Y.getMinutesOffset(bU,Y.toMidnight(bQ.getClearEndDate()));bP.set(bs,bO.calculateEventHeight(bT));}},syncEventTopUI:function(bO){var A=this;bO.get(bN).item(0).setStyle(aW,A.calculateTop(bO.get(bx))+T);bO.get(bN).item(1).setStyle(aW,0);},syncHeaderViewUI:function(){var bO=this;if(bO.get(aC)){var bQ=bO[aC];bQ.plotEvents();var bR=bQ.get(av);bR.setStyle(f,e());var bP=bR.one(Z+aD);var A=Math.max(bP.get(bs),40);bQ.set(bi,A);bO._fillHeight();}},calculateYDelta:function(bP,bO){var A=this;return(bO[1]-bP[1])/(A.get(aj)/2)*30;},findEventIntersections:function(bO,bP){var A=this;var bQ=[];bu.Array.each(bP,function(bR){if(!bO._filtered&&bR.get(ad)&&bO.intersectHours(bR)){bQ.push(bR);}});return bQ;},getXYDelta:function(bO){var A=this;var bP=bO.currentTarget.getXY(),bQ=[bO.pageX,bO.pageY];return bu.Array.map(bP,function(bS,bR){return(bQ[bR]-bS);});},getTickY:function(){var A=this;return be(Math.ceil(A.get(aj)/2),10);},roundToNearestHour:function(bO,bP){var A=this;bO.setHours(bP[0],be(bP[1],A.getTickY()),bP[2]);},_afterDragAlign:function(bP){var bO=this;var A=bP.target;
if(!bO[K]){bO[K]=A.actXY;}A.actXY[0]=null;},_dragTickAlignX:function(bP){var bO=this;var bS=bO[v];if(bS&&!bO[bd]){var bQ=bO[a8];var bR=bc(bP.attr(o))-bO.startColNumber;bO.draggingEventStartDate=Y.add(bS.get(bx),Y.DAY,bR);var A=Y.clone(bO.draggingEventStartDate);Y.copyHours(A,bQ.get(bx));bQ.move(A,{silent:true});bO.plotEvent(bQ);}},_dragTickAlignY:function(A){var bT=this;var bO=bT.get(k);var bV=bO.get(bM);var bQ=bT[v];if(bQ){var bU=A.target.get(au);var bR=bT[a8];var bS=bT.calculateYDelta(bT[K],bU.actXY);if(bT[bd]){var bP=Y.add(bT.draggingEventEndDate,Y.MINUTES,bS);if(Y.getMinutesOffset(bP,bT.draggingEventStartDate)<30){return;}bR.set(ag,bP,{silent:true});}else{bR.move(Y.add(bT.draggingEventStartDate,Y.MINUTES,bS),{silent:true});}bT.plotEvent(bR);}},_setupDragDrop:function(){var bO=this,bR=bO[a8];if(!bR){var bP=bO.get(k);bR=new bP.eventModel({scheduler:bP});bR.removeTarget(bP);bR.get(bN).addClass(bk);bR.set(ad,false,{silent:true});bO[a8]=bR;}if(!bO.delegate){bO.delegate=new bu.DD.Delegate(bO.get(t));}var A=bO.delegate.dd;A.unplug(bu.Plugin.DDConstrained);A.unplug(bu.Plugin.DDNodeScroll);var bQ=bO.bodyNode.get(Q);bQ.bottom=Infinity;bQ.top=-Infinity;A.plug(bu.Plugin.DDConstrained,{bubbleTargets:bO,constrain:bQ,stickY:true,tickY:bO.get(aj)/2});A.plug(bu.Plugin.DDNodeScroll,{node:bO.bodyNode,scrollDelay:150});},_uiSetDate:function(bO){var A=this;A.syncColumnsUI();A.syncDaysHeaderUI();},_onClickDaysHeader:function(bQ){var A=this;var bP=A.get(k);if(bQ.target.test(by)){var bR=bP.getViewByName(bC);if(bR){var bO=bc(bQ.currentTarget.attr(o));bP.set(a1,A.getDateByColumn(bO));bP.set(bb,bR);}}bQ.preventDefault();},_onEventDragEnd:function(bO){var A=this;var bQ=A[v];if(bQ){var bP=A[a8];bP.set(ad,false,{silent:true});bQ.set(ad,true,{silent:true});bQ.copyDates(bP);A.get(k).syncEventsUI();}A[K]=null;A[v]=null;},_onEventDragStart:function(bP){var A=this;var bR=A[v]=A.delegate.dd.get(bN).getData(ah);if(bR){var bQ=A[a8];bQ.copyPropagateAttrValues(bR,null,{silent:true});A.plotEvent(bQ);bR.set(ad,false,{silent:true});A.draggingEventStartDate=Y.clone(bR.get(bx));A.draggingEventEndDate=Y.clone(bR.get(ag));var bO=A.getColumnByDate(bR.get(bx));A.startColNumber=bO?bc(bO.attr(o)):0;}},_onMouseDownTableCol:function(bO){var bT=this;var bS=bO.target;var bQ=bT.get(k);var bU=bQ.get(bM);if(bU&&!bQ.get(a9)){bU.hideOverlay();if(bS.test(Z+ai)){bT[K]=[bO.pageX,bO.pageY];var bV=bc(bO.currentTarget.attr(o));var bP=bT.getDateByColumn(bV);var A=bT.getXYDelta(bO);bT.roundToNearestHour(bP,bT.getYCoordTime(A[1]));var bR=Y.add(bP,Y.MINUTES,bU.get(bl));bU.move(bP,{silent:true});bU.setAttrs({allDay:false,endDate:bR},{silent:true});bT[M]=bP;bO.halt();}else{if(bS.test([Z+bj,Z+ar].join(j))){bT[bd]=true;}}}bT.get(av).unselectable();},_onMouseEnterEvent:function(bP){var A=this;var bQ=bP.currentTarget;var bO=bQ.getData(ah);if(bO&&!bO.get(a9)){A[bo].appendTo(bQ);}},_onMouseLeaveEvent:function(bO){var A=this;if(!A[bd]){A._removeResizer();}},_onMouseMoveTableCol:function(bR){var bO=this;var bQ=bR.currentTarget;var bP=bO.get(k).get(bM);if(bO[aJ]!==bQ){bO[aJ]=bQ;bO._dragTickAlignX(bO[aJ]);}var bS=bO[M];if(bS){var bU=be(bO.calculateYDelta(bO[K],[bR.pageX,bR.pageY]),bO.getTickY());var bT=(bU>=bO._delta);if(bO._delta!==bU){if(bU>0){var A=bT?Math.max(bU,bP.get(bl)):bU;bP.set(ag,Y.add(bS,Y.MINUTES,A),{silent:true});}else{bP.set(bx,Y.add(bS,Y.MINUTES,bU),{silent:true});}bO.plotEvent(bP);bO._delta=bU;}}},_onMouseUpTableCol:function(bQ){var A=this;var bP=A.get(k);var bO=bP.get(bM);if(bO&&!bP.get(a9)){if(A[M]){A.plotEvent(bO);bO.showOverlay([bQ.pageX,bQ.pageY]);}}A[M]=null;A[bd]=false;A[K]=null;A._removeResizer();A.get(av).selectable();},_onSchedulerChange:function(bO){var A=this;if(A[aC]){A[aC].set(k,bO.newVal);}},_removeResizer:function(){var A=this;A[bo].remove();},_valueColDaysNode:function(){var A=this;var bQ=A.get(J);var bO=[],bP=0;while(bQ--){bO.push(bu.Lang.sub(aN,{colNumber:bP++}));}return bu.NodeList.create(bO.join(x));},_valueColHeaderDaysNode:function(){var A=this;var bQ=A.get(J);var bO=[],bP=0;bO.push(aa);while(bQ--){bO.push(bu.Lang.sub(aO,{colNumber:bP++}));}bO.push(p);return bu.NodeList.create(bO.join(x));},_valueMarkercellsNode:function(){var A=this;var bO=[],bP;for(bP=0;bP<=23;bP++){bO.push(R);}return bu.NodeList.create(bO.join(x));},_valueTimesNode:function(){var A=this;var bQ=A.get(V);var bP=[],bO;for(bO=0;bO<=23;bO++){bP.push(bE.sub(d,{hour:bQ?Y.toIsoTimeString(bO):Y.toUsTimeString(bO,false,true)}));}return bu.NodeList.create(bP.join(x));}}});bu.SchedulerDayView=bI;},"@VERSION@",{requires:["aui-scheduler-view-table","dd-drag","dd-delegate","dd-drop","dd-constrain"],skinnable:true});AUI.add("aui-scheduler-view-week",function(h){var k=h.Lang,g=k.isFunction,n="",o="&mdash;",p=" ",i=h.DataType.DateMath,j=i.WEEK_LENGTH,b="scheduler-view-week",f="date",m="days",e="firstDayOfWeek",l="locale",q="scheduler",d="viewDate",a="week";var c=h.Component.create({NAME:b,ATTRS:{bodyContent:{value:n},days:{value:7},headerViewConfig:{value:{displayDaysInterval:j}},name:{value:a},navigationDateFormatter:{valueFn:function(){return this._valueNavigationDateFormatter;},validator:g}},EXTENDS:h.SchedulerDayView,prototype:{getAdjustedViewDate:function(u){var r=this;var t=r.get(q);var s=t.get(e);return i.toMidnight(i.getFirstDayOfWeek(u,s));},getNextDate:function(){var r=this;var s=r.get(q);var t=s.get(d);return i.toLastHour(i.add(t,i.WEEK,1));},getPrevDate:function(){var r=this;var s=r.get(q);var t=s.get(d);return i.toMidnight(i.subtract(t,i.WEEK,1));},getToday:function(){var r=this;var s=c.superclass.getToday.apply(this,arguments);return r._findFirstDayOfWeek(s);},_valueNavigationDateFormatter:function(u){var t=this;var v=t.get(q);var s=v.get(l);var r=t._findFirstDayOfWeek(u);var w=h.DataType.Date.format(r,{format:"%B %d",locale:s});var y=i.add(r,i.DAY,t.get(m)-1);var x=h.DataType.Date.format(y,{format:(i.isMonthOverlapWeek(u)?"%B %d":"%d")+", %Y",locale:s});return[w,o,x].join(p);}}});h.SchedulerWeekView=c;},"@VERSION@",{requires:["aui-scheduler-view-day"],skinnable:true});
AUI.add("aui-scheduler-view-table",function(an){var aa=an.Lang,aH=aa.isFunction,aQ=aa.isString,q=an.DataType.DateMath,ai=an.WidgetStdMod,aY=q.WEEK_LENGTH,a6="-",l=".",S="",a5=" ",al="scheduler-view",av="scheduler-view-table",a8=function(A,a9){return function(bb){var ba=bb.all(A);return(ba.size()>=a9)?ba:null;};},aw="body",f="close",ao="col",H="colHeaderDaysNode",w="colgrid",aD="colspan",I="columnDayHeader",J="columnTableGrid",a="container",am="content",az="data",aI="day",i="displayDaysInterval",V="displayRows",ad="div",aA="down",ar="endDate",a4="event",aR="events",O="eventsOverlay",aM="filterFn",B="first",L="firstDayOfWeek",j="grid",C="header",d="headerDateFormatter",z="headerTableNode",af="icon",c="left",aV="locale",aL="more",t="next",v="node",o="overlay",m="right",s="row",P="rowsContainerNode",U="scheduler",ag="scheduler-event",aU="showMore",aS="startDate",M="strings",n="table",aB="tableGridNode",u="tableRowContainer",p="tableRows",aP="tbody",ax="title",a2="tl",k="today",aT="tr",W="viewDate",ac="visible",K=an.getClassName,r=K(af),a3=K(af,"arrowstop-1-l"),g=K(af,"arrowstop-1-r"),aq=K(al,n,w),a7=K(al,n,w,B),aJ=K(al,n,w,k),ak=K(al,n,a),T=K(al,n,aR,o,v),b=K(al,n,aR,o,v,aw),aG=K(al,n,aR,o,v,f),ae=K(al,n,C,ao),ay=K(al,n,C,aI),X=K(al,n,C,n),aj=K(al,n,aL),aX=K(al,n,s),aN=K(al,n,s,a),G=K(al,n,az),E=K(al,n,az,ao),Z=K(al,n,az,ao,ax),a1=K(al,n,az,ao,ax,aA),ab=K(al,n,az,ao,ax,B),N=K(al,n,az,ao,ax,t),Q=K(al,n,az,ao,ax,k),x=K(al,n,az,a4),aO=K(al,n,az,a4,c),aZ=K(al,n,az,a4,m),R=K(al,n,az,B),ah=K(al,n,j),F=K(al,n,j,B),aW='<div class="'+ak+'">'+'<div class="'+aN+'"></div>'+"</div>",ap='<div class="'+T+'">'+'<div class="'+b+'"></div>'+'<a href="javascript:;" class="'+aG+'">{label}</a>'+"</div>",aK='<td class="'+aq+'">&nbsp;</td>',a0='<th class="'+ay+'"><div>&nbsp;</div></th>',h='<table cellspacing="0" cellpadding="0" class="'+X+'">'+"<tbody>"+'<tr class="'+ae+'"></tr>'+"</tbody>"+"</table>",aF='<a href="javascript:;" class="'+aj+'">{label} {count}</a>',aC='<div class="'+aX+'" style="top: {top}%; height: {height}%;"></div>',Y='<table cellspacing="0" cellpadding="0" class="'+G+'">'+"<tbody></tbody>"+"</table>",aE='<table cellspacing="0" cellpadding="0" class="'+ah+'">'+"<tbody>"+"<tr></tr>"+"</tbody>"+"</table>",y='<span class="'+[r,a3].join(a5)+'"></span>',au='<span class="'+[r,g].join(a5)+'"></span>',D='<td class="'+E+'"><div></div></td>',at="<tr></tr>";var e=an.Component.create({NAME:av,ATTRS:{bodyContent:{value:S},displayDaysInterval:{value:42},displayRows:{value:4},fixedHeight:{value:true},name:{value:n},headerDateFormatter:{value:function(a9){var A=this;var ba=A.get(U);return an.DataType.Date.format(a9,{format:"%A",locale:ba.get(aV)});},validator:aQ},navigationDateFormatter:{value:function(a9){var A=this;var ba=A.get(U);return an.DataType.Date.format(a9,{format:"%b %Y",locale:ba.get(aV)});},validator:aH},scrollable:{value:false},strings:{value:{close:"Close",showMore:"Show more"}},headerTableNode:{valueFn:function(){return an.Node.create(h);}},colHeaderDaysNode:{valueFn:"_valueColHeaderDaysNode"},rowsContainerNode:{valueFn:function(){return an.Node.create(aW);}},tableGridNode:{valueFn:"_valueTableGridNode"}},HTML_PARSER:{colHeaderDaysNode:a8(l+ay,7),headerTableNode:l+X,rowsContainerNode:l+ak,tableGridNode:a8(l+ah,7)},EXTENDS:an.SchedulerView,prototype:{evtDateStack:null,evtRenderedStack:null,rowDataTableStack:null,initializer:function(){var A=this;A.evtDateStack={};A.evtRenderedStack={};A.rowDataTableStack={};A[H]=A.get(H);A[z]=A.get(z);A[P]=A.get(P);A[aB]=A.get(aB);A[I]=A.headerTableNode.one(l+ae);A[J]=an.NodeList.create();A[u]=A[P].one(l+aN);A[p]=an.NodeList.create();},bindUI:function(){var A=this;A[P].delegate("click",an.bind(A._onClickMore,A),l+aj);},renderUI:function(){var A=this,a9=A._getDisplayRowsCount(),ba;for(ba=0;ba<a9;ba++){A[p].push(A.buildGridRowNode(ba));}A._renderEventsOverlay();A[H].appendTo(A[I]);A[p].appendTo(A[u]);},buildEventsRow:function(a9,be,bd){var A=this;var ba=A.get(V);var bc=0;var bb=an.Node.create(at);A.loopDates(a9,be,function(bn,bj){if(bc>bj){return;}var bo=A.getIntersectEvents(bn);var bl=A._getRenderableEvent(bo,a9,be,bn);var bh=an.Node.create(D);var bg=bh.one(ad);if((ba<bo.length)&&(bd===(ba-1))){var bm=A.get(M);var bi=an.Node.create(aa.sub(aF,{count:(bo.length-(ba-1)),label:bm[aU]}));bi.setData(aR,bo);bg.append(bi);}else{if(bl){var bf=A._getEvtSplitInfo(bl,bn,a9,be);bh.attr(aD,bf.colspan);bc+=(bf.colspan-1);A._syncEventNodeContainerUI(bl,bg,bf);A._syncEventNodeUI(bl,bg,bn);var bk=String(bn.getTime());A.evtRenderedStack[bk].push(bl);}}bc++;bb.append(bh);});return bb;},buildEventsTable:function(A,bc){var bi=this,bg=bi.get(V),bf=q.clearTime(bi._findCurrentIntervalStart()),be=String(bf.getTime()).concat(A.getTime()).concat(bc.getTime()),bh=bi.rowDataTableStack[be],bd;if(!bh){bh=an.Node.create(Y);var bb=bh.one(aP);var ba=bi.buildEventsTitleRow(bh,A,bc);bb.append(ba);for(bd=0;bd<bg;bd++){var a9=bi.buildEventsRow(A,bc,bd);bb.append(a9);}bi.rowDataTableStack[be]=bh;}return bh;},buildEventsTitleRow:function(ba,a9,bc){var A=this;var bb=an.Node.create(at);A.loopDates(a9,bc,function(be,bd){var bf=an.Node.create(D);bf.addClass(Z).toggleClass(ab,(bd===0)).toggleClass(Q,q.isToday(be)).toggleClass(N,q.isToday(q.subtract(be,q.DAY,1))).toggleClass(a1,q.isToday(q.subtract(be,q.WEEK,1)));bb.append(bf.setContent(be.getDate()));});return bb;},buildGridRowNode:function(bd){var ba=this;var bb=ba._getDisplayRowsCount();var a9=100/bb;var A=ba._getTableGridNode(bd);var bc=an.Node.create(aa.sub(aC,{height:a9,top:a9*bd}));bc.append(A.toggleClass(F,(bd===0)));return bc;},flushViewCache:function(){var A=this;A.evtDateStack={};A.evtRenderedStack={};A.rowDataTableStack={};},getIntersectEvents:function(a9){var A=this;var bc=A.get(U);var bb=String(a9.getTime());if(!A.evtDateStack[bb]){var ba=bc.getIntersectEvents(a9);A.evtDateStack[bb]=ba.filter(A.get(aM));}return A.evtDateStack[bb];},getNextDate:function(){var A=this;var ba=A.get(U);var bb=ba.get(W);var a9=A.get(i);return q.toLastHour(q.add(bb,q.DAY,a9));
},getPrevDate:function(){var A=this;var ba=A.get(U);var bb=ba.get(W);var a9=A.get(i);return q.toMidnight(q.subtract(bb,q.DAY,a9));},hideEventsOverlay:function(){var A=this;A[O].set(ac,false);},loopDates:function(A,bb,be,bf,bd){var bg=this;var a9=q.clone(A);var ba=bb.getTime();var bc;for(bc=0;a9.getTime()<=ba;bc++){be.apply(bg,[a9,bc]);a9=q.add(a9,(bf||q.DAY),(bd||1));}},plotEvents:function(){var a9=this;var bc=a9._findCurrentIntervalStart();var A=q.safeClearTime(bc);a9.flushViewCache();a9.hideEventsOverlay();a9.bodyNode.all(l+G).remove();var ba=a9.get(i);var bb=Math.min(ba,aY);a9[p].each(function(bg,be){var bd=q.add(A,q.DAY,bb*be);var bh=q.add(bd,q.DAY,bb-1);var bf=a9.buildEventsTable(bd,bh);if(be===0){bf.addClass(R);}bg.append(bf);});},syncDaysHeaderUI:function(){var a9=this;var bc=a9.get(U);var bd=bc.get(W);var bb=a9.get(d);var A=a9.get(aV);var ba=a9._findFirstDayOfWeek(bd);a9.colHeaderDaysNode.all(ad).each(function(bg,bf){var be=q.add(ba,q.DAY,bf);bg.html(bb.call(a9,be));});},syncGridUI:function(){var bi=this;var bc=bi.getToday();var a9=bi.get(U);bi[J].removeClass(aJ);var bb=bi._findCurrentIntervalStart();var be=bi._findCurrentIntervalEnd();if(q.between(bc,bb,be)){var A=a9.get(L);var bg=bi._findFirstDayOfWeek(bc);var bd=q.getWeekNumber(bc,A)-q.getWeekNumber(bb,A);var bh=(bc.getDate()-bg.getDate());var ba=bi._getCellIndex([bh,bd]);var bf=bi[J].item(ba);if(bf){bf.addClass(aJ);}}},syncStdContent:function(){var A=this;A.setStdModContent(ai.BODY,A[P].getDOM());A.setStdModContent(ai.HEADER,A[z].getDOM());},_findCurrentIntervalEnd:function(){var A=this;var ba=A.get(U);var bb=ba.get(W);var a9=A.get(i);return q.add(bb,q.DAY,a9);},_findCurrentIntervalStart:function(){var A=this;var a9=A.get(U);return a9.get(W);},_getCellIndex:function(a9){var A=this;return a9[1]*aY+a9[0];},_getDisplayRowsCount:function(){var A=this;var a9=A.get(i);return Math.ceil(a9/aY);},_getDisplayRowDaysCount:function(){var A=this;var a9=A.get(i);return Math.min(a9,aY);},_getEvtLabel:function(ba){var a9=this;var bb=ba.get(ar);var A=ba.get(aS);return[A.getHours(),a6,bb.getHours(),a5,ba.get(am)].join(S);},_getEvtSplitInfo:function(bd,bg,A,bb){var be=this;var a9=bd.getClearStartDate();var bc=bd.getClearEndDate();var bf=q.getDayOffset(bb,bg);var ba={colspan:Math.min(q.getDayOffset(bc,bg),bf)+1,left:q.before(a9,A),right:q.after(bc,bb)};return ba;},_getRenderableEvent:function(bh,A,bb,bi){var bg=this,be=String(bi.getTime()),ba;if(!bg.evtRenderedStack[be]){bg.evtRenderedStack[be]=[];}for(ba=0;ba<bh.length;ba++){var bf=bh[ba];var a9=bf.get(aS);var bd=q.after(bi,a9)&&!q.isDayOverlap(bi,A);var bc=!q.isDayOverlap(a9,bi);var bj=an.Array.indexOf(bg.evtRenderedStack[be],bf)>-1;if(!bj&&(bc||bd)){return bf;}}return null;},_getTableGridNode:function(be){var a9=this,bb=a9.get(i),A=a9[aB].item(be),bd=A.one(aT),ba;for(ba=0;ba<Math.min(bb,aY);ba++){var bc=an.Node.create(aK);bd.append(bc);if(ba===0){bc.addClass(a7);}a9[J].push(bc);}return A;},_onClickMore:function(ba){var A=this;var bb=ba.target;var a9=bb.getData(aR);var bc=an.NodeList.create();an.Array.each(a9,function(be){var bd=be.get(v).item(0).clone();bd.setData(ag,be);bd.setStyles({height:"auto",left:0,position:"relative",top:0,width:"auto"});bc.push(bd);});A[O].bodyNode.one(l+b).setContent(bc);A[O].setAttrs({visible:true,xy:bb.getXY()});},_renderEventsOverlay:function(){var a9=this;var A=a9.get(M);a9[O]=new an.Overlay({align:{points:[a2,a2]},bodyContent:aa.sub(ap,{label:A[f]}),render:a9[P],visible:false,width:250,zIndex:450});a9[O].bodyNode.delegate("click",an.bind(a9.hideEventsOverlay,a9),l+aG);},_syncEventNodeContainerUI:function(a9,bb,ba){var A=this;bb.addClass(x);if(ba.left){bb.addClass(aO).prepend(y);}if(ba.right){bb.addClass(aZ).append(au);}},_syncEventNodeUI:function(bh,a9,bj){var bi=this;var bc=bi.get(U);var A=bc.get(L);var bb=bh.get(v);var ba=bh.get(aS);var bg=q.clearTime(bi._findCurrentIntervalStart());var bd=q.getFirstDayOfWeek(new Date(Math.max(ba,bg)),A);var bf=Math.floor(q.getDayOffset(bj,bd)/aY);if(bb.size()<=bf){bh.addPaddingNode();}var be=bb.item(bf);be.setStyles({height:"auto",left:0,top:0,width:"auto"});be.appendTo(a9);bh.syncUI();},_uiSetDate:function(a9){var A=this;A.syncDaysHeaderUI();A.syncGridUI();},_valueColHeaderDaysNode:function(){var A=this;var a9=A.get(i);var ba=Math.min(a9,aY);return A._valueNodeList(ba,a0);},_valueTableGridNode:function(){var A=this;var a9=A.get(i);var ba=Math.min(a9,aY);return A._valueNodeList(ba,aE);},_valueNodeList:function(bb,ba){var A=this;var a9=[];while(bb--){a9.push(ba);}return an.NodeList.create(a9.join(S));}}});an.SchedulerTableView=e;},"@VERSION@",{requires:["aui-scheduler-base","overlay"],skinnable:true});AUI.add("aui-scheduler-view-table-dd",function(j){var S=j.Lang,G=S.isObject,f=j.DataType.DateMath,K=f.WEEK_LENGTH,p=".",F="scheduler-event",z="scheduler-view",M="boundingBox",C="col",g="colgrid",H="content",h="data",b="dd",i="delegate",w="delegateConfig",y="disabled",B="displayDaysInterval",e="dragNode",c="dragging",l="draggingEvent",E="eventRecorder",m="lasso",P="node",I="offsetHeight",J="offsetWidth",R="proxy",L="proxyNode",u="region",r="rowsContainerNode",s="scheduler",N="startDate",t="table",Q="visible",d=j.getClassName,q=d(F),O=d(F,y),o=d(z,t,g),x=d(z,t,c),k=d(z,t,m),a=d(z,t,R,P),D=d(z,t,h,C),v='<div class="'+k+'"></div>',n='<div class="'+a+'"></div>';j.SchedulerTableViewDD=function(){};j.SchedulerTableViewDD.ATTRS={delegateConfig:{value:{},setter:function(T){var A=this;return j.merge({dragConfig:{offsetNode:false,useShim:false},bubbleTargets:A,container:A.get(M),nodes:p+q,invalid:"input, select, button, a, textarea, "+p+O},T||{});},validator:G}};j.mix(j.SchedulerTableViewDD.prototype,{initializer:function(){var A=this;A[L]=j.Node.create(n);A.after(A.viewDDBindUI,A,"bindUI");A.after(A.viewDDRenderUI,A,"renderUI");A.after(A.viewDDSyncUI,A,"syncUI");},viewDDBindUI:function(){var A=this;var T=A.get(s).get(E);if(T){T.on({cancel:j.bind(A.removeLasso,A),save:j.bind(A.removeLasso,A)});}A[r].on({mousedown:j.bind(A._onMouseDownGrid,A),mousemove:j.bind(A._onMouseMoveGrid,A),mouseup:j.bind(A._onMouseUpGrid,A)});
A.after("drag:align",A._afterDragAlign);A.on("drag:end",A._onEventDragEnd);A.on("drag:start",A._onEventDragStart);},viewDDRenderUI:function(){var A=this;},viewDDSyncUI:function(){var A=this;A._setupDragDrop();},removeLasso:function(){var A=this;if(A[m]){A[m].remove();}},removeProxy:function(){var A=this;if(A[L]){A[L].remove();}},renderLasso:function(Z,T){var af=this;var W=Z;var Y=T;if(Z[1]>T[1]){W=T;Y=Z;}var ag=W[0],ab=W[1],U=Y[0],A=Y[1],V;af.removeLasso();af.lasso=j.NodeList.create();for(V=ab;V<=A;V++){var X=af.gridCellHeight,ae=af.gridCellWidth,ac=0,aa=(X*V);if(V===ab){if(ab===A){ac+=Math.min(ag,U)*ae;ae*=Math.abs(U-ag)+1;}else{ac+=ag*ae;ae*=K-ag;}}else{if(V===A){ae*=U+1;}else{ae*=K;}}var ad=j.Node.create(v);af.lasso.push(ad);af[r].append(ad);ad.sizeTo(ae,X);ad.setXY(af._offsetXY([ac,aa],1));}},_afterDragAlign:function(A){var Z=this;var aa=A.target;var W=Z.bodyNode.get(u);var X={bottom:A.pageY,left:A.pageX,right:A.pageX,top:A.pageY};if(!j.DOM.inRegion(null,W,true,X)){return;}var Y=Z[l];var T=[A.pageX,A.pageY];var V=Z._findPosition(Z._offsetXY(T,-1));if(Y&&Z._hasLassoChanged(V)){Z.lassoLastPosition=V;var U=f.add(Z._getPositionDate(V),f.MINUTES,Y.getMinutesDuration());Z.renderLasso(V,Z._getDatePosition(U));}},_findPosition:function(V){var A=this;var U=Math.floor(V[0]/A.gridCellWidth);var T=Math.floor(V[1]/A.gridCellHeight);return[U,T];},_getDatePosition:function(U){var T=this;var V=T._findCurrentIntervalStart();var W=f.getDayOffset(U,V);var A=[];A[1]=Math.floor(W/K);A[0]=W%K;return A;},_getPositionDate:function(U){var T=this;var W=T._findCurrentIntervalStart();var A=f.safeClearTime(W);var V=f.add(A,f.DAY,T._getCellIndex(U));V.setHours(0,0,0,0);return V;},_hasLassoChanged:function(T){var A=this;var U=A.lassoLastPosition||A.lassoStartPosition;return U&&((T[0]!==U[0])||(T[1]!==U[1]));},_offsetXY:function(V,U){var A=this;var T=A[r].getXY();return[V[0]+T[0]*U,V[1]+T[1]*U];},_onEventDragEnd:function(T){var A=this;var V=A[l];if(V){var U=A._getPositionDate(A.lassoLastPosition);f.copyHours(U,V.get(N));V.move(U);V.set(Q,true,{silent:true});A[r].removeClass(x).unselectable();T.target.set(e,A.originalDragNode);A.removeLasso();A.removeProxy();A.get(s).syncEventsUI();}A[l]=null;},_onEventDragStart:function(W){var A=this;var X=A[l]=A[i][b].get(P).getData(F);if(X){A._syncCellDimensions();var U=[W.pageX,W.pageY];var V=A._findPosition(A._offsetXY(U,-1));var T=f.add(A._getPositionDate(V),f.MINUTES,X.getMinutesDuration());A.renderLasso(V,A._getDatePosition(T));A._syncProxyNodeUI(X);X.set(Q,false,{silent:true});A.lassoStartPosition=A.lassoLastPosition=V;A[r].addClass(x).unselectable();A.originalDragNode=W.target.get(e);W.target.set(e,A[L]);}},_onMouseDownGrid:function(W){var A=this;var V=A.get(s);var U=V.get(E);var X=W.target;if(U&&X.test([p+o,p+D].join())){A._recording=true;A._syncCellDimensions();var T=A._offsetXY([W.pageX,W.pageY],-1);A.lassoStartPosition=A.lassoLastPosition=A._findPosition(T);A.renderLasso(A.lassoStartPosition,A.lassoLastPosition);A[r].unselectable();}},_onMouseMoveGrid:function(V){var T=this;var W=V.currentTarget;var U=[V.pageX,V.pageY];var A=T._findPosition(T._offsetXY(U,-1));if(T._recording&&T._hasLassoChanged(A)){T.lassoLastPosition=A;T.renderLasso(T.lassoStartPosition,A);}},_onMouseUpGrid:function(Y){var T=this;var X=T.get(s);var V=X.get(E);if(V&&T._recording&&!X.get(y)){var W=T._getPositionDate(T.lassoStartPosition);var U=T._getPositionDate(T.lassoLastPosition);var A=new Date(Math.min(W,U));A.setHours(0,0,0);var Z=new Date(Math.max(W,U));Z.setHours(23,59,59);V.setAttrs({allDay:true,endDate:Z,startDate:A},{silent:true});V.showOverlay([Y.pageX,Y.pageY]);T._recording=false;}},_setupDragDrop:function(){var T=this;if(!T[i]){T[i]=new j.DD.Delegate(T.get(w));}var A=T[i][b];A.unplug(j.Plugin.DDNodeScroll);A.unplug(j.Plugin.DDProxy);A.plug(j.Plugin.DDNodeScroll,{node:T.bodyNode,scrollDelay:150});A.plug(j.Plugin.DDProxy,{moveOnEnd:false,positionProxy:false});},_syncCellDimensions:function(){var A=this;var U=A.get(B);var T=Math.ceil(U/K);var V=Math.min(U,K);A.gridCellHeight=A[r].get(I)/T;A.gridCellWidth=A[r].get(J)/V;},_syncProxyNodeUI:function(T){var A=this;var V=T.get(P).item(0);var W=T.get(P).item(1);A[L].setStyles({backgroundColor:V.getStyle("backgroundColor"),display:"block"});if(!W||!W.test(":visible")){var U=V.get(J);A[L].set(J,U);}A[L].appendTo(A[r]);A[L].setContent(T.get(H));}});j.Base.mix(j.SchedulerTableView,[j.SchedulerTableViewDD]);},"@VERSION@",{requires:["aui-scheduler-view-table","dd-drag","dd-delegate","dd-drop"],skinnable:false});AUI.add("aui-scheduler-view-month",function(o){var f=o.Lang,a=f.isFunction,c=o.DataType.DateMath,r=".",h="col",g="data",d="date",v="firstDayOfWeek",e="locale",m="month",w="nomonth",i="scheduler",j="table",u="tableRowContainer",n="title",q="viewDate",p="scheduler-view",l="scheduler-view-month",t=o.getClassName,s=t(l,j,g,h,w),k=t(p,j,g,h,n);var b=o.Component.create({NAME:l,ATTRS:{displayDaysInterval:{readOnly:true,value:42},name:{value:m},navigationDateFormatter:{value:function(y){var x=this;var z=x.get(i);return o.DataType.Date.format(y,{format:"%B %Y",locale:z.get(e)});},validator:a}},EXTENDS:o.SchedulerTableView,prototype:{getAdjustedViewDate:function(y){var x=this;return c.toMidnight(c.findMonthStart(y));},getNextDate:function(){var x=this;var y=x.get(i);var z=y.get(q);return c.toLastHour(c.add(z,c.MONTH,1));},getPrevDate:function(){var x=this;var y=x.get(i);var z=y.get(q);return c.toMidnight(c.subtract(z,c.MONTH,1));},plotEvents:function(){var x=this;o.SchedulerMonthView.superclass.plotEvents.apply(x,arguments);var y=x.get(i);var C=y.get(q);var B=c.findMonthEnd(C);var A=c.findMonthStart(C);var z=x._findCurrentIntervalStart();var D=x[u].all(r+k);D.each(function(G,E){var F=c.add(z,c.DAY,E);if(c.before(F,A)||c.after(F,B)){G.addClass(s);}});},_findCurrentIntervalStart:function(){var x=this;var y=x.get(i);var z=y.get(q);return x._findFirstDayOfWeek(z);}}});o.SchedulerMonthView=b;},"@VERSION@",{requires:["aui-scheduler-view-table"],skinnable:true});AUI.add("aui-scheduler-view-agenda",function(aj){var X=aj.Lang,aA=X.isFunction,aP=aj.Array,m=aj.DataType.DateMath,H="%H:%M",av="%l:%M",i=".",P="",w="&mdash;",aO=" ",O="activeView",az="agenda",d="biggie",af="bodyContent",s="boundingBox",aF="clearfix",ax="click",aJ="clientId",ay="color",a="container",ah="content",ar="date",ae="dates",aB="day",y="disabled",ap="endDate",aN="event",S="eventRecorder",aH="events",aw="eventsDateFormatter",b="extra",C="first",E="header",c="headerContent",aC="headerDayDateFormatter",B="headerExtraDateFormatter",r="helper",am="info",n="infoDayDateFormatter",aq="infoLabelBigDateFormatter",N="infoLabelSmallDateFormatter",at="isoTime",an="label",e="last",aL="locale",ao="metal",aK="no",M="noEvents",q="past",ag="pm",Q="scheduler",ab="schedulerEvent",ac="small",aI="startDate",L="strings",f="timestamp",h="today",T="viewDate",Z="visible",ak="scheduler-view-agenda",aa=function(A){return function(aT){var aS=this;
var aU=aS.get(Q);return aj.DataType.Date.format(aT,{format:A,locale:aU.get(aL)});};},D=function(A){return aP.map(A,function(aS){return +aS;}).sort(aP.numericSort);},I=aj.getClassName,ai=I(ak,a),p=I(ak,aN),al=I(ak,aN,ay),x=I(ak,aN,ah),U=I(ak,aN,ae),l=I(ak,aN,C),au=I(ak,am),v=I(ak,am,d),aE=I(ak,am,a),u=I(ak,am,an),V=I(ak,am,an,d),G=I(ak,am,an,ac),j=I(ak,aN,e),ad=I(ak,aK,aH),z=I(ak,aN,q),aQ=I(ak,aH),K=I(ak,E),k=I(ak,E,aB),aM=I(ak,E,b),t=I(ak,E,C),J=I(ak,E,e),g=I(r,aF),aD=I(ak,ao),o='<div class="'+ai+'">{content}</div>',W='<div class="'+[K,aD,g].join(aO)+' {firstClassName} {lastClassName}">'+'<div class="'+k+'">{day}</div>'+'<a href="javascript:;" class="'+aM+'" data-timestamp="{timestamp}">{extra}</a>'+"</div>",aG='<div class="'+aQ+'">{content}</div>',aR='<div class="'+[p,g].join(aO)+' {firstClassName} {lastClassName} {eventClassName}" data-clientId="{clientId}">'+'<div class="'+al+'" style="background-color: {color};"></div>'+'<div class="'+x+'">{content}</div>'+'<div class="'+U+'">{dates}</div>'+"</div>",R='<div class="'+ad+'">{content}</div>',Y='<div class="'+aE+'">'+'<div class="'+[au,g].join(aO)+'">'+'<div class="'+[v,aD].join(aO)+'">{day}</div>'+'<div class="'+u+'">'+'<div class="'+V+'">{labelBig}</div>'+'<div class="'+G+'">{labelSmall}</div>'+"</div>"+"</div>"+"</div>";var F=aj.Component.create({NAME:ak,ATTRS:{bodyContent:{value:P},eventsDateFormatter:{value:function(aS,aW){var aZ=this,aV=aZ.get(Q),A=aV.get(O).get(at),aY=H,aX=H,aT,aU;if(!A){aY=av;aX=av;if(aS.getHours()>=12){aY+=ag;}if(aW.getHours()>=12){aX+=ag;}}if(m.isDayOverlap(aS,aW)){aY+=", %b %e";aX+=", %b %e";}aT=aa.call(aZ,aY);aU=aa.call(aZ,aX);return[aT.call(aZ,aS),w,aU.call(aZ,aW)].join(aO);},validator:aA},headerDayDateFormatter:{value:function(aT){var A=this,aS,aU;if(m.isToday(aT)){aS=h;}else{aS="%A";}aU=aa.call(A,aS);return aU.call(A,aT);},validator:aA},headerExtraDateFormatter:{validator:aA,value:aa("%B %e")},infoDayDateFormatter:{validator:aA,value:aa("%e")},infoLabelBigDateFormatter:{validator:aA,value:aa("%A")},infoLabelSmallDateFormatter:{validator:aA,value:aa("%B %d, %Y")},name:{value:az},strings:{value:{noEvents:"No future events."}}},EXTENDS:aj.SchedulerView,prototype:{bindUI:function(){var A=this,aS=A.get(s);aS.delegate(ax,A._onSchedulerEventClick,i+p,A);aS.delegate(ax,A._onEventsHeaderClick,i+aM,A);},getNextDate:function(){var A=this,aS=A.get(Q).get(T);return m.toMidnight(m.add(aS,m.DAY,1));},getPrevDate:function(){var A=this,aS=A.get(Q).get(T);return m.toLastHour(m.subtract(aS,m.DAY,1));},plotEvents:function(){var aZ=this,a0=aZ.get(L),aV=aZ.get(Q),a4=aV.get(T),a5=aZ.get(aw),aW=aZ.get(aC),aT=aZ.get(B),aU=aZ.get(n),aY=aZ.get(aq),aS=aZ.get(N),a3=[],A=aZ._getDayEventsMap(),a2=aj.Object.keys(A),a1=a2.length;aZ.set(c,aj.Lang.sub(Y,{day:aU.call(aZ,a4),labelBig:aY.call(aZ,a4),labelSmall:aS.call(aZ,a4)}));if(!aj.Object.isEmpty(A)){aP.each(D(a2),function(a9,a7){var a6=new Date(aj.Lang.toInt(a9)),ba=A[a9],a8=ba.length;a3.push(aj.Lang.sub(W,{day:aW.call(aZ,a6),extra:aT.call(aZ,a6),firstClassName:(a7===0)?t:P,lastClassName:(a7===a1-1)?J:P,timestamp:a9}));aP.each(ba,function(be,bd){var bc=m.toMidnight(new Date()),bf=be.get(ap),bb=be.get(aI);a3.push(aj.Lang.sub(aR,{clientId:be.get(aJ),color:be.get(ay),content:be.get(ah),dates:a5.call(aZ,bb,bf),eventClassName:(bb.getTime()<bc.getTime())?z:P,firstClassName:(bd===0)?l:P,lastClassName:(bd===a8-1)?j:P}));});});}else{a3.push(aj.Lang.sub(R,{content:a0[M]}));}var aX=aj.Lang.sub(o,{content:aj.Lang.sub(aG,{content:a3.join(P)})});aZ.set(af,aX);},_getDayEventsMap:function(){var A=this,aT=A.get(Q),aU=m.toMidnight(aT.get(T)),aS={};aT.eachEvent(function(aW){var aV=aW.get(aI),aY=aW.get(Z),aX;if(!aY||(aV.getTime()<aU.getTime())){return;}aX=m.safeClearTime(aV).getTime();if(!aS[aX]){aS[aX]=[];}aS[aX].push(aW);});return aS;},_onEventsHeaderClick:function(aU){var A=this,aT=A.get(Q),aW=aU.currentTarget,aV=aj.Lang.toInt(aW.getData(f))||Date.now(),aS=new Date(aV),aX=aT.getViewByName(aB);if(aX){aT.set(ar,aS);aT.set(O,aX);}},_onSchedulerEventClick:function(aV){var A=this,aW=aV.currentTarget,aT=A.get(Q),aS=aT.get(S),aU=aW.getData(ab);if(!aU){aU=aT.getEventByClientId(aW.getData(aJ));aW.setData(ab,aU);}if(aU&&aS&&!aT.get(y)){aS.set(aN,aU,{silent:true});aS.showOverlay([aV.pageX,aV.pageY]);}}}});aj.SchedulerAgendaView=F;},"@VERSION@",{requires:["aui-scheduler-base"],skinnable:true});AUI.add("aui-scheduler-event-recorder",function(W){var L=W.Lang,a=L.isArray,v=L.isObject,al=L.isString,H=L.isUndefined,m=W.IO.prototype._serialize,t=L.toInt,ah=function(ay,ax,A){return Math.min(Math.max(ay,ax),A);},i=W.DataType.DateMath,at="-",d=".",ar=" ",O="scheduler-event",P="scheduler-event-recorder",z="activeView",c="arrow",Z="body",R="bodyContent",b="borderRadius",l="boundingBox",Q="cancel",ad="click",s="constrain",U="content",ab="date",V="dateFormat",K="delete",X="endDate",aq="event",q="footerContent",T="form",p="header",ac="isoTime",F="keydown",k="node",y="offsetHeight",ak="offsetWidth",g="overlay",B="overlayOffset",M="px",ap="recorder",ao="rendered",e="region",f="right",ae="save",G="scheduler",j="schedulerChange",S="shadow",am="startDate",x="strings",an="submit",af="template",aa="title",E="toolbar",h="top",Y="visibleChange",u=W.getClassName,n=u(O),r=u(O,aa),N=u(O,ap),au=u(G,aq,ap,g),o=u(G,aq,ap,g,c),ai=u(G,aq,ap,g,c,h),aj=u(G,aq,ap,g,c,S),I=u(G,aq,ap,g,Z),ag=u(G,aq,ap,g,U),J=u(G,aq,ap,g,ab),C=u(G,aq,ap,g,T),aw=u(G,aq,ap,g,p),w=new W.Template('<div class="',aj," ",o,'"></div>','<div class="',o,'"></div>','<input type="hidden" name="startDate" value="{startDate}" />','<input type="hidden" name="endDate" value="{endDate}" />','<div class="',aw,'">','<input class="',ag,'" name="content" value="{content}" />',"</div>",'<div class="',I,'">','<label class="',J,'">{date}</label>',"</div>"),av='<form class="'+C+'" id="schedulerEventRecorderForm"></form>';var D=W.Component.create({NAME:P,ATTRS:{allDay:{value:false},content:{},duration:{value:60},dateFormat:{validator:al,value:"%a, %B %d,"},event:{},eventClass:{valueFn:function(){return W.SchedulerEvent;
}},strings:{value:{},setter:function(A){return W.merge({"delete":"Delete","description-hint":"e.g., Dinner at Brian's",cancel:"Cancel",description:"Description",edit:"Edit",save:"Save",when:"When"},A||{});},validator:v},overlay:{validator:v,value:{constrain:true,visible:false,width:300,zIndex:500}},overlayOffset:{value:[15,-38],validator:a},template:{value:w},toolbar:{setter:function(ay){var ax=this;var A=ax.get(x);return W.merge({children:[{handler:W.bind(ax._handleSaveEvent,ax),label:A[ae]},{handler:W.bind(ax._handleCancelEvent,ax),label:A[Q]},{handler:W.bind(ax._handleDeleteEvent,ax),label:A[K]}]},ay||{});},validator:v,value:{}}},EXTENDS:W.SchedulerEvent,prototype:{initializer:function(){var A=this;A.get(k).addClass(N);A.publish("cancel",{defaultFn:A._defCancelEventFn});A.publish("delete",{defaultFn:A._defDeleteEventFn});A.publish("edit",{defaultFn:A._defEditEventFn});A.publish("save",{defaultFn:A._defSaveEventFn});A.after(j,A._afterSchedulerChange);A[g]=new W.Overlay(A.get(g));A[E]=new W.Toolbar(A.get(E));A[g].on(Y,W.bind(A._onOverlayVisibleChange,A));},getOverlayContentNode:function(){var A=this;var ax=A[g].get(l);return ax.one(d+ag);},getUpdatedSchedulerEvent:function(ay){var A=this,az=A.get(aq),ax={silent:!az},aA=A.serializeForm();if(!az){az=A.clone();}az.set(G,A.get(G),{silent:true});az.setAttrs(W.merge(aA,ay),ax);return az;},_afterSchedulerChange:function(az){var A=this;var ay=az.newVal;var ax=ay.get(l);ax.delegate(ad,W.bind(A._onClickSchedulerEvent,A),d+n);},_defCancelEventFn:function(ax){var A=this;A.get(k).remove();A.hideOverlay();},_defDeleteEventFn:function(ay){var A=this;var ax=A.get(G);ax.removeEvents(A.get(aq));A.hideOverlay();ax.syncEventsUI();},_defEditEventFn:function(ay){var A=this;var ax=A.get(G);A.hideOverlay();ax.syncEventsUI();},_defSaveEventFn:function(ay){var A=this;var ax=A.get(G);ax.addEvents(ay.newSchedulerEvent);A.hideOverlay();ax.syncEventsUI();},_handleCancelEvent:function(ax){var A=this;A.fire("cancel");ax.preventDefault();},_handleClickOutSide:function(ax){var A=this;A.fire("cancel");},_handleDeleteEvent:function(ax){var A=this;A.fire("delete",{schedulerEvent:A.get(aq)});ax.preventDefault();},_handleEscapeEvent:function(ax){var A=this;if(A[g].get(ao)&&(ax.keyCode==W.Event.KeyMap.ESC)){A.fire("cancel");ax.preventDefault();}},_handleSaveEvent:function(ay){var A=this,ax=A.get(aq)?"edit":"save";A.fire(ax,{newSchedulerEvent:A.getUpdatedSchedulerEvent()});ay.preventDefault();},_onClickSchedulerEvent:function(ay){var A=this;var ax=ay.currentTarget.getData(O);if(ax){A.set(aq,ax,{silent:true});A.showOverlay([ay.pageX,ay.pageY]);A.get(k).remove();}},_onOverlayVisibleChange:function(ax){var A=this;if(ax.newVal){A.populateForm();if(!A.get(aq)){var ay=A.getOverlayContentNode();if(ay){setTimeout(function(){ay.selectText();},0);}}}else{A.set(aq,null,{silent:true});A.get(k).remove();}},_onSubmitForm:function(ax){var A=this;A._handleSaveEvent(ax);},_renderOverlay:function(){var ax=this;var aA=ax.get(G);var az=aA.get(l);var A=ax.get(x);ax[g].render(az);ax[E].render(az);var ay=ax[g].get(l);ay.addClass(au);ax[g].set(q,ax[E].get(l));ax.formNode=W.Node.create(av);ax[g].set(R,ax.formNode);ax.formNode.on(an,W.bind(ax._onSubmitForm,ax));aA.get(l).on("clickoutside",W.bind(ax._handleClickOutSide,ax));},getFormattedDate:function(){var ay=this;var ax=ay.get(V);var aA=(ay.get(aq)||ay);var aC=aA.get(X);var aB=aA.get(G);var A=aA.get(am);var az=(aB.get(z).get(ac)?i.toIsoTimeString:i.toUsTimeString);return[aA._formatDate(A,ax),az(A),at,az(aC)].join(ar);},getTemplateData:function(){var ax=this,A=ax.get(x),ay=ax.get(aq)||ax,az=ay.get(U);if(H(az)){az=A["description-hint"];}return{content:az,date:ax.getFormattedDate(),endDate:ay.get(X).getTime(),startDate:ay.get(am).getTime()};},hideOverlay:function(){var A=this;A[g].hide();},populateForm:function(){var A=this;A.formNode.setContent(A.get(af).parse(A.getTemplateData()));},serializeForm:function(){var A=this;return W.QueryString.parse(m(A.formNode.getDOM()));},showOverlay:function(aG){var aF=this,aC=aG.concat([]),aD=aF[g],aB=aD.get(l);if(!aF[g].get(ao)){aF._renderOverlay();}aD.show();aF.handleEscapeEvent=W.on(F,W.bind(aF._handleEscapeEvent,aF));var aE=aB.all(d+o),aA=aE.item(0),ax=aA.get(y),az=aA.get(ak);aE.removeClass(ai).show();aG[0]-=aB.get(ak)*0.5;aG[1]-=aB.get(y)+ax*0.5;var ay=aD.getConstrainedXY(aG);if(ay[1]!==aG[1]){aG[1]=aC[1]+ax*0.5;aE.addClass(ai);}aG=aD.getConstrainedXY(aG);aD.set("xy",aG);var A=ah(aC[0]-az*0.5,aG[0],aG[0]+aB.get(ak));aE.setX(A);}}});W.SchedulerEventRecorder=D;},"@VERSION@",{requires:["aui-scheduler-base","aui-template","aui-toolbar","io-form","querystring","overlay"],skinnable:true});AUI.add("aui-scheduler",function(a){},"@VERSION@",{skinnable:false,use:["aui-scheduler-base","aui-scheduler-view-day","aui-scheduler-view-week","aui-scheduler-view-table","aui-scheduler-view-table-dd","aui-scheduler-view-month","aui-scheduler-view-agenda","aui-scheduler-event-recorder"]});