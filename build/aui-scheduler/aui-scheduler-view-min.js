AUI.add("aui-scheduler-view",function(b5){var cm=b5.Lang,cD=cm.isObject,bU=cm.isString,aU=cm.isBoolean,aG=cm.isNumber,be=function(A){return A==0?0:(A<0?-1:1);},aK=function(A,cH){return Math.max(Math.abs(A),cH)*be(A);},bH=function(A){return parseFloat(A)||0;},bJ=function(cH,A){return Math.round(cH/A)*A;},aq=b5.DataType.DateMath,b1=b5.WidgetStdMod,aL=aq.WEEK_LENGTH,bL="scheduler-view",aF="scheduler-view-day",b9="scheduler-view-week",cw="scheduler-view-month",bG="activeView",a6="am",u="borderLeftWidth",cd="borderRightWidth",aQ="boundingBox",q="children",bx="childNodes",ag="col",I="colblank",y="coldata",aI="colday",a="colgrid",bs="colmonth",W="colspan",m="coltime",cr="columnNode",ax="colDaysNode",b7="colHeaderDaysNode",aO="container",aM="content",ct="contentBox",av="createDocumentFragment",bb="currentDate",by="data",ba="dateFormat",cj="day",U="days",E="delegateConfig",bE="disabled",X="div",bk="division",ab="down",cb="dragNode",bT="duration",aA="endDate",a2="event",bZ="events",cF="eventRecorder",s="eventWidth",aH="first",ca="firstDayOfWeek",a8="grid",cE="hd",b3="header",a9="headerDateFormat",cA="headerTableNode",bO="height",aP="host",aE="hourHeight",v="icon",ak="isoTime",bf="labelAM",aC="labelPM",aR="left",ay="locale",ac="marker",a4="markercell",aX="markercellsNode",bM="markercellNode",L="markers",bD="month",a7="monthContainerNode",bB="navigationDateFormat",aN="next",bK="nextDate",cG="node",aj="nomonth",ar="noscroll",b2="offsetHeight",K="offsetTop",b4="offsetWidth",ch="ownerDocument",b6="pad",co="parentEvent",R="parentNode",an="pm",aa="prevDate",br="proxy",ah="px",aS="rendered",b0="repeated",aY="right",bp="row",r="scheduler",aD="scheduler-event",Y="scrollable",T="shim",b8="startDate",aT="table",cu="tableColNode",j="tableDataNode",D="tableGridNode",bv="tableNode",bV="tableTimeNode",bt="tbody",e="td",bm="time",ai="timesNode",g="title",al="today",bq="top",cB="tr",z="trigger",cp="week",bz="width",bI="-",k="a",bN=".",bF="",bA="%",V=" ",F=b5.getClassName,bl=F(bL,ar),ad=F(bL,Y);var aW=b5.Component.create({NAME:bL,AUGMENTS:[b5.WidgetStdMod],ATTRS:{bodyContent:{value:bF},height:{value:600},isoTime:{value:false,validator:aU},name:{value:bF,validator:bU},navigationDateFormat:{value:"%A - %d %b %Y",validator:bU},nextDate:{getter:"getNextDate",readOnly:true},prevDate:{getter:"getPrevDate",readOnly:true},scheduler:{lazyAdd:false,setter:"_setScheduler"},scrollable:{value:true,validator:aU},triggerNode:{setter:b5.one},visible:{value:false}},BIND_UI_ATTRS:[Y],prototype:{initializer:function(){var A=this;A.after("render",A._afterRender);},syncUI:function(){var A=this;A.syncStdContent();},adjustCurrentDate:function(){var A=this;var cI=A.get(r);var cH=cI.get(bb);cI.set(bb,cH);},flushViewCache:function(){},getNextDate:function(){},getPrevDate:function(){},getToday:function(){return aq.clearTime(new Date());},limitDate:function(cH,cI){var A=this;if(aq.after(cH,cI)){cH=aq.clone(cI);}return cH;},plotEvents:function(A){},syncStdContent:function(){},syncEventUI:function(A){},_uiSetCurrentDate:function(A){},_afterRender:function(cI){var A=this;var cH=A.get(r);A.adjustCurrentDate();A._uiSetScrollable(A.get(Y));},_setScheduler:function(cI){var A=this;var cH=A.get(r);if(cH){A.removeTarget(cH);}if(cI){A.addTarget(cI);cI.after("eventsChange",b5.bind(A.flushViewCache,A));}return cI;},_uiSetScrollable:function(cI){var A=this;var cH=A.bodyNode;if(cH){cH.toggleClass(ad,cI);cH.toggleClass(bl,!cI);}},_uiSetVisible:function(cH){var A=this;aW.superclass._uiSetVisible.apply(this,arguments);if(cH&&A.get(aS)){A.adjustCurrentDate();}}}});b5.SchedulerView=aW;var O=function(A,cH){return function(cJ){var cI=cJ.all(A);return(cI.size()>=cH)?cI:null;};},aJ=F(aD),bh=F(aD,bE),bQ=F(aD,br),B=F(bL,y),c=F(bL,a),Q=F(r,al),ap=F(r,al,cE),ce=F(bL,a8),cf=F(bL,a8,aO),ci=F(bL,a4),M=F(bL,L),bj=F(bL,ac,bk),bw=F(bL,aT),cl=F(bL,cj,b3,aT),t=F(bL,cj,b3,cj),bi=F(bL,cj,b3,cj,b6,aY),bS=F(bL,cj,b3,cj,aH),a1=F(bL,cj,b3,ag),cy=F(bL,aT,ag),aB=F(bL,aT,ag,T),P=F(bL,aT,I),H=F(bL,aT,aI),n=F(bL,aT,aI,b3),cq=F(bL,aT,m),bo=F(bL,aT,bm),ae='<div class="'+ci+'">'+'<div class="'+bj+'"></div>'+"</div>",au='<table class="'+bw+'">'+"<tbody>"+'<tr class="'+c+'" height="1">'+'<td height="0" class="'+[cy,P].join(V)+'"></td>'+'<td class="'+cf+'" colspan="1">'+'<div class="'+ce+'">'+'<div class="'+M+'"></div>'+"</div>"+"</td>"+"</tr>"+'<tr class="'+B+'">'+'<td class="'+[cy,cq].join(V)+'"></td>'+"</tr>"+"</tbody>"+"</table>",bd='<td class="'+[cy,H].join(V)+'">'+'<div class="'+aB+'"></div>'+"</td>",i='<div class="'+bo+'">{hour}</div>',aw='<table class="'+cl+'">'+"<tbody>"+'<tr class="'+a1+'"></tr>'+"</tbody>"+"</table>",bg='<th class="'+t+'"><a href="#">&nbsp;</a></th>',at='<td class="'+[t,bS].join(V)+'"></td>',w='<th class="'+[t,bi].join(V)+'">&nbsp;</th>';var cz=b5.Component.create({NAME:aF,ATTRS:{bodyContent:{value:bF},days:{value:1,validator:aG},delegateConfig:{value:{},setter:function(cH){var A=this;return b5.merge({bubbleTargets:A,container:A.get(aQ),nodes:bN+aJ,invalid:"input, select, button, a, textarea, "+bN+bh},cH||{});},validator:cD},headerDateFormat:{value:"%a %d/%m",validator:bU},name:{value:cj},hourHeight:{value:52,validator:aG},eventWidth:{value:95,validator:aG},headerTableNode:{valueFn:function(){return b5.Node.create(aw);}},tableNode:{valueFn:function(){return b5.Node.create(au);}},colDaysNode:{valueFn:"_valueColDaysNode"},colHeaderDaysNode:{valueFn:"_valueColHeaderDaysNode"},markercellsNode:{valueFn:"_valueMarkercellsNode"},timesNode:{valueFn:"_valueTimesNode"}},HTML_PARSER:{colHeaderDaysNode:O(bN+t,2),colDaysNode:O(bN+H,1),markercellsNode:O(bN+ci,24),timesNode:O(bN+bo,24),headerTableNode:bN+cl,tableNode:bN+bw},EXTENDS:b5.SchedulerView,prototype:{initializer:function(){var A=this;A.colDaysNode=A.get(ax);A.colHeaderDaysNode=A.get(b7);A.headerTableNode=A.get(cA);A.markercellsNode=A.get(aX);A.tableNode=A.get(bv);A.timesNode=A.get(ai);A.colShimNodes=A.colDaysNode.all(bN+aB);A.colDataNode=A.tableNode.one(bN+B);A.colTimeNode=A.tableNode.one(bN+cq);A.dayHeaderColNode=A.headerTableNode.one(bN+a1);
A.gridContainer=A.tableNode.one(bN+cf);A.markersNode=A.tableNode.one(bN+M);},renderUI:function(){var A=this;A.colTimeNode.setContent(A.timesNode);A.markersNode.setContent(A.markercellsNode);A.colDaysNode.appendTo(A.colDataNode);A.colHeaderDaysNode.appendTo(A.dayHeaderColNode);},bindUI:function(){var A=this;A.headerTableNode.delegate("click",b5.bind(A._onClickDaysHeader,A),bN+t);A.colDataNode.delegate("mousedown",b5.bind(A._onMouseDownTableCol,A),bN+cy);A.colDataNode.delegate("mouseup",b5.bind(A._onMouseUpTableCol,A),bN+cy);A.colDataNode.delegate("mousemove",b5.bind(A._onMouseMoveTableCol,A),bN+cy);A.on("drag:end",A._onEventDragEnd);A.on("drag:start",A._onEventDragStart);A.on("drag:align",A._dragAlign);A.on("drag:tickAlignX",A._dragTickAlignX);A.on("drag:tickAlignY",A._dragTickAlignY);},syncUI:function(){var A=this;cz.superclass.syncUI.apply(this,arguments);A.gridContainer.attr(W,A.get(U));A._setupDragDrop();},syncStdContent:function(){var A=this;A.setStdModContent(b1.BODY,A.tableNode.getDOM());A.setStdModContent(b1.HEADER,A.headerTableNode.getDOM());},calculateTopByDate:function(cJ){var cH=this;var A=cH.get(aE);var cI=cJ.getHours();var cK=cJ.getMinutes();var cL=cJ.getSeconds();return((cI*60)+cK+(cL/60))*(A/60);},calculateHoursByTop:function(cK){var cH=this;var A=cH.get(aE);var cM=bH((cK/A).toFixed(2));var cL=0;var cJ=Math.floor((cM*100)%100*0.6);var cI=Math.floor(cM);return[cI,cJ,cL];},getNextDate:function(){var A=this;var cI=A.get(r);var cH=cI.get(bb);return aq.add(cH,aq.DAY,1);},getPrevDate:function(){var A=this;var cI=A.get(r);var cH=cI.get(bb);return aq.subtract(cH,aq.DAY,1);},getColumnByDate:function(cI){var A=this;var cJ=A.get(r);var cH=aq.safeClearTime(cJ.get(bb));var cK=aq.getDayOffset(aq.safeClearTime(cI),cH);return A.colDaysNode.item(cK);},getDateByColumn:function(cI){var A=this;var cJ=A.get(r);var cH=aq.safeClearTime(cJ.get(bb));return aq.add(cH,aq.DAY,cI);},plotEvents:function(cI){var A=this;var cH=A.get(r);A.colShimNodes.each(function(cM,cL){var cK=A.getDateByColumn(cL);var cJ=cH.getEventsByDay(cK);cM.empty();b5.Array.each(cJ,function(cN,cO){if(!cN.isDayOverlapEvent()){cM.append(cN.get(cG));cN.set(cr,cM.get(R));A.syncEventTopUI(cN);A.syncEventHeightUI(cN);}});A.syncEventsIntersectionUI(cJ);});},syncColumnsUI:function(){var A=this;A.colDaysNode.each(function(cJ,cI){var cH=A.getDateByColumn(cI);cJ.toggleClass(Q,aq.isToday(cH));});},syncDaysHeaderUI:function(){var cI=this;var cK=cI.get(r);var cJ=cK.get(bb);var cH=cI.get(a9);var A=cI.get(ay);cI.colHeaderDaysNode.all(k).each(function(cN,cM){var cL=aq.add(cJ,aq.DAY,cM);var cO=b5.DataType.Date.format(cL,{format:cH,locale:A});cN.toggleClass(ap,aq.isToday(cL));cN.html(cO);});},syncEventsIntersectionUI:function(cH){var A=this;var cI=A.get(r);var cJ=A.get(s);cI.flushEvents();b5.Array.each(cH,function(cL,cM){var cO=A.findEventIntersections(cL,cH);var cN=cO.length;var cK=(cJ/cN);b5.Array.each(cO,function(cQ,cR){var cP=cQ.get(cG);var cT=cK*cR;var cS=cK*1.7;if(cR==(cN-1)){cS=cJ-cT;}cP.setStyle(bz,cS+bA);cP.setStyle(aR,cT+bA);var cU=cP.get(R);if(cU){cU.insert(cP,cR);}cQ._filtered=true;});});},syncEventHeightUI:function(cI){var cH=this;var A=cH.get(aE);var cK=cH.calculateTopByDate(cI.get(b8));var cJ=cH.calculateTopByDate(cI.get(aA));cI.get(cG).set(b2,Math.max(cJ-cK,A/2));},syncEventRecorderUI:function(cJ){var A=this;var cI=A.get(r);var cK=cI.get(cF);var cH=cK.get(cG);if(cJ&&!cH.inDoc()){cJ.append(cH);}A.syncEventTopUI(cK);A.syncEventHeightUI(cK);},syncEventTopUI:function(cI){var cH=this;var A=cI.get(cG);var cJ=cH.calculateTopByDate(cI.get(b8));A.setStyle(bq,cJ+ah);},findEventIntersections:function(cH,cI){var A=this;var cJ=[];b5.Array.each(cI,function(cL,cK){if(!cH._filtered&&!cL.isDayOverlapEvent()&&cH.intersectHours(cL)){cJ.push(cL);}});return cJ;},_createEvents:function(){var A=this;var cH=function(cI,cJ){A.publish(cI,{defaultFn:cJ,queuable:false,emitFacade:true,bubbles:true});};},_dragTickAlignX:function(cH){var cQ=this;var cR=cH.target.get(aP);var cS=cQ._getColumnRefWidth();var cK=cR.get(cG);var cN=cQ.proxyEvt;var cO=cK.getData(aD);var cP=(cR.actXY[0]-cQ.bodyNode.getX()-cQ.colTimeNode.get(b4));var cI=Math.floor(cP/cS);var cM=cQ.colDaysNode.item(cI);var cL=cQ.getDateByColumn(cI);var A=aq.clone(cL);var cJ=aq.clone(cL);aq.copyHours(cJ,cN.get(aA));aq.copyHours(A,cN.get(b8));cN.set(aA,cJ);cN.set(b8,A);},_dragTickAlignY:function(cI){var cN=this;var cO=cI.target.get(aP);var cK=cO.get(cG);var cL=cN.proxyEvt;var cM=cK.getData(aD);var cH=aq.clone(cL.get(b8));var A=cN.calculateHoursByTop(bH(cO.get(cb).getComputedStyle(bq)));cN._setTickedHours(cH,A);var cJ=aq.clone(cH);cL.set(aA,aq.add(cJ,aq.MINUTES,cN._currentEvtDuration));cL.set(b8,cH);cL.syncNodeTitleUI();},_getXYDelta:function(cH){var A=this;var cJ=cH.currentTarget;var cI=cJ.getXY(),cK=[cH.pageX,cH.pageY];return b5.Array.map(cI,function(cM,cL){return(cK[cL]-cM);});},_getTickY:function(){var A=this;return bJ(Math.ceil(A.get(aE)/2),10);},_getColumnRefWidth:function(){var A=this;var cH=A.colDaysNode.item(0);return bH(cH.getStyle(bz))-bH(cH.getStyle(cd))-bH(cH.getStyle(u));},_setupDragDrop:function(){var cI=this;var cJ=cI.get(aQ);if(!cI.proxyEvt){var cK=cI.get(r);cI.proxyEvt=new b5.SchedulerEvent({scheduler:cK});cI.proxyEvt.removeTarget(cK);cI.proxyEvt.get(cG).addClass(bQ);}if(!cI.delegate){cI.delegate=new b5.DD.Delegate(cI.get(E));}var cH=cI.delegate.dd;var cL=cI.proxyEvt;var cM=cI.get(aE)/2;var A=cI._getColumnRefWidth();cH.unplug(b5.Plugin.DDConstrained);cH.unplug(b5.Plugin.DDNodeScroll);cH.plug(b5.Plugin.DDConstrained,{bubbleTargets:cI,constrain:cI.bodyNode,tickX:A,tickY:cM});cH.plug(b5.Plugin.DDNodeScroll,{node:cI.bodyNode,scrollDelay:150});},_uiSetCurrentDate:function(cH){var A=this;A.syncColumnsUI();A.syncDaysHeaderUI();},_onClickDaysHeader:function(cJ){var A=this;var cI=A.get(r);if(cJ.target.test(k)){var cK=cI.getViewByName(cj);var cH=A.colHeaderDaysNode.indexOf(cJ.currentTarget)-1;if(cK){cI.set(bb,A.getDateByColumn(cH));cI.set(bG,cK);}}cJ.preventDefault();},_onEventDragEnd:function(A){var cN=this;
var cK=cN.get(r);var cJ=cN.get(aQ);var cO=cN.delegate.dd;var cI=cO.get(cG);var cL=cN.proxyEvt;var cH=cL.get(cG);var cM=cI.getData(aD);cI.show();cH.hide();cJ.selectable();cM.copyDates(cL);cK.syncEventsUI();},_onEventDragStart:function(A){var cN=this;var cK=cN.get(aQ);var cO=cN.delegate.dd;var cJ=cO.get(cG);var cL=cN.proxyEvt;var cM=cJ.getData(aD);var cI=bH(cJ.getComputedStyle(aR));if(cI){cO.deltaXY[0]=(cI+bH(cO.deltaXY[0]));}if(cM){var cP=cM.get(cr);var cH=cL.get(cG);cO.set(cb,cH);cP.append(cH);cL.copyPropagateAttrValues(cM);cN.syncEventTopUI(cL);cN.syncEventHeightUI(cL);cH.show();cN._currentEvtDuration=cM.getMinutesDuration();}cJ.hide();cK.unselectable();},_onMouseDownTableCol:function(cJ){var A=this;var cI=A.get(r);var cK=cI.get(cF);if(cK&&!cI.get(bE)){cK.hideOverlay();if(cJ.target.test(bN+aB)){var cH=A.colDaysNode.indexOf(cJ.currentTarget);A.dragXY=A.startXY=A._getXYDelta(cJ);A.ddStartDate=A.getDateByColumn(cH);A.ddEndDate=aq.clone(A.ddStartDate);A._setTickedHours(A.ddStartDate,A.calculateHoursByTop(A.startXY[1]));A.ddMaxDate=aq.clone(A.ddStartDate);A.ddMaxDate.setHours(23,59,59);cK.set(b8,A.ddStartDate);cK.set(aA,A.limitDate(cK.get(aA),A.ddMaxDate));cJ.halt();}}},_onMouseMoveTableCol:function(cK){var A=this;var cJ=A.get(r);var cN=cJ.get(cF);var cL=A.ddStartDate;if(cL){A.dragXY=A._getXYDelta(cK);A._setTickedHours(A.ddEndDate,A.calculateHoursByTop(A.dragXY[1]));var cM=aq.getMinutesOffset(A.ddEndDate,cL);if((A.dragXY[1]-A.startXY[1])>0){cM=aK(cM,cN.get(bT));}var cH=A.limitDate(aq.add(cL,aq.MINUTES,cM),A.ddMaxDate);if(cM>0){cN.set(aA,cH);}else{var cI=cN.get(aA);cN.set(b8,cH);cN.set(aA,cI);}A.syncEventRecorderUI(cK.currentTarget);}},_onMouseUpTableCol:function(cI){var A=this;var cH=A.get(r);var cJ=cH.get(cF);if(cJ&&!cH.get(bE)){if(A.ddStartDate){A.syncEventRecorderUI(cI.currentTarget);cJ.showOverlay();}A.ddEndDate=null;A.ddStartDate=null;}},_setTickedHours:function(cH,cI){var A=this;cH.setHours(cI[0],bJ(cI[1],A._getTickY()),cI[2]);},_valueColDaysNode:function(){var A=this;var cI=A.get(U);var cH=[];while(cI--){cH.push(bd);}return b5.NodeList.create(cH.join(bF));},_valueColHeaderDaysNode:function(){var A=this;var cI=A.get(U);var cH=[];cH.push(at);while(cI--){cH.push(bg);}cH.push(w);return b5.NodeList.create(cH.join(bF));},_valueMarkercellsNode:function(){var A=this;var cH=[];for(var cI=0;cI<=23;cI++){cH.push(ae);}return b5.NodeList.create(cH.join(bF));},_valueTimesNode:function(){var A=this;var cJ=A.get(ak);var cI=[];for(var cH=0;cH<=23;cH++){cI.push(b5.Lang.sub(i,{hour:cJ?aq.toIsoTimeString(cH):aq.toUsTimeString(cH,false,true)}));}return b5.NodeList.create(cI.join(bF));}}});b5.SchedulerDayView=cz;var am=b5.Component.create({NAME:b9,ATTRS:{bodyContent:{value:bF},days:{value:7},name:{value:cp}},EXTENDS:b5.SchedulerDayView,prototype:{adjustCurrentDate:function(){var A=this;var cJ=A.get(r);var cH=cJ.get(bb);var cI=cJ.get(ca);cJ.set(bb,aq.getFirstDayOfWeek(cH,cI));},getNextDate:function(){var A=this;var cI=A.get(r);var cH=cI.get(bb);var cJ=A._firstDayOfWeek(cH);return aq.add(cJ,aq.WEEK,1);},getPrevDate:function(){var A=this;var cI=A.get(r);var cH=cI.get(bb);var cJ=A._firstDayOfWeek(cH);return aq.subtract(cJ,aq.WEEK,1);},getToday:function(){var A=this;var cH=am.superclass.getToday.apply(this,arguments);return A._firstDayOfWeek(cH);},_firstDayOfWeek:function(cI){var A=this;var cJ=A.get(r);var cH=cJ.get(ca);return aq.getFirstDayOfWeek(cI,cH);}}});b5.SchedulerWeekView=am;var h=F(bL,bD,aO),a3=F(bL,bD,b3,ag),x=F(bL,bD,b3,cj),cv=F(bL,bD,b3,aT),bX=F(bL,bD,bp),ao=F(bL,bD,bp,aO),f=F(v),l=F(v,"arrowstop-1-l"),cs=F(v,"arrowstop-1-r"),bY=F(bL,bD,a),b=F(bL,bD,a,al),o=F(bL,bD,a,aH),bC=F(bL,bD,aT,by),aZ=F(bL,bD,aT,by,aH),bW=F(bL,bD,aT,by,ag),cc=F(bL,bD,aT,by,ag,aH),a0=F(bL,bD,aT,by,ag,aj),aV=F(bL,bD,aT,by,ag,g),S=F(bL,bD,aT,by,ag,g,al),af=F(bL,bD,aT,by,ag,g,aH),C=F(bL,bD,aT,by,ag,g,aN),cx=F(bL,bD,aT,by,ag,g,ab),bn=F(bL,bD,aT,by,a2),d=F(bL,bD,aT,by,a2,aR),bP=F(bL,bD,aT,by,a2,aY),p=F(bL,bD,aT,by,a2,b0),bc=F(bL,bD,aT,a8),cn=F(bL,bD,aT,a8,aH),cC=F(bL,aT,bs,b3),G='<table class="'+cv+'">'+"<tbody>"+'<tr class="'+a3+'"></tr>'+"</tbody>"+"</table>",N='<th class="'+x+'"><div>&nbsp;</div></th>',ck='<div class="'+h+'">'+'<div class="'+ao+'">'+'<div class="'+bX+'" style="top: 0; height: 16.6667%;"></div>'+'<div class="'+bX+'" style="top: 16.6667%; height: 16.6667%;"></div>'+'<div class="'+bX+'" style="top: 33.3333%; height: 16.6667%;"></div>'+'<div class="'+bX+'" style="top: 50%; height: 16.6667%;"></div>'+'<div class="'+bX+'" style="top: 66.6667%; height: 16.6667%;"></div>'+'<div class="'+bX+'" style="top: 83.3333%; height: 16.6667%;"></div>'+"</div>"+"</div>",bu='<table cellspacing="0" cellpadding="0" class="'+bc+'">'+"<tbody>"+"<tr>"+'<td class="'+[bY,o].join(V)+'">&nbsp;</td>'+'<td class="'+bY+'">&nbsp;</td>'+'<td class="'+bY+'">&nbsp;</td>'+'<td class="'+bY+'">&nbsp;</td>'+'<td class="'+bY+'">&nbsp;</td>'+'<td class="'+bY+'">&nbsp;</td>'+'<td class="'+bY+'">&nbsp;</td>'+"</tr>"+"</tbody>"+"</table>",bR='<table cellspacing="0" cellpadding="0" class="'+bC+'">'+"<tbody></tbody>"+"</table>",cg="<tr></tr>",a5='<td class="'+bW+'"><div></div></td>',Z='<span class="'+[f,l].join(V)+'"></span>',J='<span class="'+[f,cs].join(V)+'"></span>';var az=b5.Component.create({NAME:cw,ATTRS:{bodyContent:{value:bF},name:{value:bD},headerDateFormat:{value:"%a"},navigationDateFormat:{value:"%b %Y"},scrollable:{value:false},monthContainerNode:{valueFn:function(){return b5.Node.create(ck);}},headerTableNode:{valueFn:function(){return b5.Node.create(G);}},colHeaderDaysNode:{valueFn:"_valueColHeaderDaysNode"},tableGridNode:{valueFn:"_valueTableGridNode"}},HTML_PARSER:{tableGridNode:O(bN+bc,7),colHeaderDaysNode:O(bN+x,7),monthContainerNode:bN+h,headerTableNode:bN+cv},EXTENDS:b5.SchedulerView,prototype:{evtDateStack:null,evtDataTableStack:null,initializer:function(){var A=this;var cH=A.get(r);A.evtDateStack={};A.evtDataTableStack={};A.colHeaderDaysNode=A.get(b7);A.headerTableNode=A.get(cA);A.monthContainerNode=A.get(a7);A.tableGridNode=A.get(D);A.dayHeaderColNode=A.headerTableNode.one(bN+a3);
A.monthRows=A.monthContainerNode.all(bN+bX);A.tableGridCols=A.tableGridNode.all(e);},renderUI:function(){var A=this;A.colHeaderDaysNode.appendTo(A.dayHeaderColNode);A.monthRows.each(function(cJ,cI){var cH=A.tableGridNode.item(cI);cJ.append(cH.toggleClass(cn,(cI==0)));});},buildEventsTable:function(cH,cM){var cS=this;var cP=5;var cJ=aq.clearTime(cS._findCurrentMonthEnd());var cR=aq.clearTime(cS._findCurrentMonthStart());var cO=String(cR.getTime()).concat(cH.getTime()).concat(cM.getTime());var cN=cS.evtDataTableStack[cO];if(!cN){cN=b5.Node.create(bR);var cQ=cN.one(bt);var cK=b5.Node.create(cg);cS.loopDates(cH,cM,function(cU,cT){var cV=b5.Node.create(a5);cV.addClass(aV).toggleClass(af,(cT==0)).toggleClass(S,aq.isToday(cU)).toggleClass(C,aq.isToday(aq.subtract(cU,aq.DAY,1))).toggleClass(cx,aq.isToday(aq.subtract(cU,aq.WEEK,1)));if(aq.before(cU,cR)||aq.after(cU,cJ)){cV.addClass(a0);}cK.append(cV.setContent(cU.getDate()));});cQ.append(cK);for(var A=0;A<cP;A++){var cL=0;var cI=b5.Node.create(cg);cS.loopDates(cH,cM,function(cY,cW){if(cL<=cW){var cX=cS.getIntersectEvents(cY),cU=cX[A];var cZ=b5.Node.create(a5);if(cU){var cT=cZ.one(X);var cV=cS._getEvtSplitInfo(cU,cH,cM);cZ.attr(W,cV.colspan);cT.addClass(bn).setContent(cS._getEvtLabel(cU));if(cV.left){cT.addClass(d).prepend(Z);}if(cV.right){cT.addClass(bP).append(J);}if(cU.get(co)){cT.addClass(p);}cL+=cV.colspan;}else{cL++;}cI.append(cZ);}});cQ.append(cI);}cS.evtDataTableStack[cO]=cN;}return cN;},flushViewCache:function(){var A=this;A.evtDateStack={};A.evtDataTableStack={};},getIntersectEvents:function(cH){var A=this;var cJ=A.get(r);var cI=String(cH.getTime());if(!A.evtDateStack[cI]){A.evtDateStack[cI]=cJ.getIntersectEvents(cH);}return A.evtDateStack[cI];},loopDates:function(A,cJ,cM,cN,cL){var cO=this;var cH=aq.clone(A);var cI=cJ.getTime();for(var cK=0;cH.getTime()<=cI;cK++){cM.apply(cO,[cH,cK]);cH=aq.add(cH,(cN||aq.DAY),(cL||1));}},plotEvents:function(){var cH=this;var cI=cH._findCurrentMonthStart();var A=aq.safeClearTime(cH._findFirstDayOfWeek(cI));cH.bodyNode.all(bN+bC).remove();cH.monthRows.each(function(cM,cK){var cJ=aq.add(A,aq.WEEK,cK);var cN=aq.add(cJ,aq.DAY,aL-1);var cL=cH.buildEventsTable(cJ,cN);if(cK==0){cL.addClass(aZ);}cM.append(cL);});},syncStdContent:function(){var A=this;A.setStdModContent(b1.BODY,A.monthContainerNode.getDOM());A.setStdModContent(b1.HEADER,A.headerTableNode.getDOM());},syncGridUI:function(){var cO=this;var cI=cO.getToday();var cH=cO.get(r);cO.tableGridCols.removeClass(b);if(aq.isSameMonth(cI,cH.get(bb))){var A=cH.get(ca);var cI=cO.getToday();var cK=cO._findCurrentMonthStart();var cM=cO._findFirstDayOfWeek(cI);var cJ=aq.getWeekNumber(cI,A)-aq.getWeekNumber(cK,A);var cN=(cI.getDate()-cM.getDate());var cL=cO.tableGridNode.item(cJ).all(e).item(cN);if(cL){cL.addClass(b);}}},adjustCurrentDate:function(){var A=this;var cH=A.get(r);cH.set(bb,A._findCurrentMonthStart());},getNextDate:function(){var A=this;var cI=A.get(r);var cH=cI.get(bb);return aq.add(cH,aq.MONTH,1);},getPrevDate:function(){var A=this;var cI=A.get(r);var cH=cI.get(bb);return aq.subtract(cH,aq.MONTH,1);},syncDaysHeaderUI:function(){var cI=this;var cL=cI.get(r);var cJ=cL.get(bb);var cH=cI.get(a9);var A=cI.get(ay);var cK=cI._findFirstDayOfWeek(cJ);cI.colHeaderDaysNode.all(X).each(function(cO,cN){var cM=aq.add(cK,aq.DAY,cN);var cP=b5.DataType.Date.format(cM,{format:cH,locale:A});cO.html(cP);});},_findCurrentMonthEnd:function(){var A=this;var cI=A.get(r);var cH=cI.get(bb);return aq.findMonthEnd(cH);},_findCurrentMonthStart:function(){var A=this;var cI=A.get(r);var cH=cI.get(bb);return aq.findMonthStart(cH);},_findFirstDayOfWeek:function(cI){var A=this;var cJ=A.get(r);var cH=cJ.get(ca);return aq.getFirstDayOfWeek(cI,cH);},_getEvtLabel:function(cI){var cH=this;var cJ=cI.get(aA);var A=cI.get(b8);return[A.getHours(),bI,cJ.getHours(),V,cI.get(aM)].join(bF);},_getEvtSplitInfo:function(cN,A,cL){var cO=this;var cH=cN.getClearStartDate();var cM=cN.getClearEndDate();var cK=cN.getDaysDuration();var cJ={};var cI=1;if(aq.after(cH,A)){cI=Math.min(cK,Math.abs(aq.getDayOffset(cL,cH))+1);if(cI>1){cJ.right=true;}}else{cI=Math.abs(aq.getDayOffset(cM,A)+1);if(cI>1){cJ.left=true;}}cJ.colspan=Math.min(cI,aL);if(cI>=aL){cJ.right=true;cJ.left=true;}return cJ;},_uiSetCurrentDate:function(cH){var A=this;A.syncDaysHeaderUI();A.syncGridUI();},_valueColHeaderDaysNode:function(){var A=this;return A._valueNodeList(aL,N);},_valueTableGridNode:function(){var A=this;return A._valueNodeList(aL,bu);},_valueNodeList:function(cJ,cI){var A=this;var cH=[];while(cJ--){cH.push(cI);}return b5.NodeList.create(cH.join(bF));}}});b5.SchedulerMonthView=az;},"@VERSION@",{requires:["aui-scheduler-event","aui-calendar","aui-button-item","dd-drag","dd-delegate","dd-drop","dd-constrain"],skinnable:true});