AUI.add("aui-scheduler-view-agenda",function(aj){var X=aj.Lang,aA=X.isFunction,aP=aj.Array,m=aj.DataType.DateMath,H="%H:%M",av="%l:%M",i=".",P="",w="&mdash;",aO=" ",O="activeView",az="agenda",d="biggie",af="bodyContent",s="boundingBox",aF="clearfix",ax="click",aJ="clientId",ay="color",a="container",ah="content",ar="date",ae="dates",aB="day",y="disabled",ap="endDate",aN="event",S="eventRecorder",aH="events",aw="eventsDateFormatter",b="extra",C="first",E="header",c="headerContent",aC="headerDayDateFormatter",B="headerExtraDateFormatter",r="helper",am="info",n="infoDayDateFormatter",aq="infoLabelBigDateFormatter",N="infoLabelSmallDateFormatter",at="isoTime",an="label",e="last",aL="locale",ao="metal",aK="no",M="noEvents",q="past",ag="pm",Q="scheduler",ab="schedulerEvent",ac="small",aI="startDate",L="strings",f="timestamp",h="today",T="viewDate",Z="visible",ak="scheduler-view-agenda",aa=function(A){return function(aT){var aS=this;var aU=aS.get(Q);return aj.DataType.Date.format(aT,{format:A,locale:aU.get(aL)});};},D=function(A){return aP.map(A,function(aS){return +aS;}).sort(aP.numericSort);},I=aj.getClassName,ai=I(ak,a),p=I(ak,aN),al=I(ak,aN,ay),x=I(ak,aN,ah),U=I(ak,aN,ae),l=I(ak,aN,C),au=I(ak,am),v=I(ak,am,d),aE=I(ak,am,a),u=I(ak,am,an),V=I(ak,am,an,d),G=I(ak,am,an,ac),j=I(ak,aN,e),ad=I(ak,aK,aH),z=I(ak,aN,q),aQ=I(ak,aH),K=I(ak,E),k=I(ak,E,aB),aM=I(ak,E,b),t=I(ak,E,C),J=I(ak,E,e),g=I(r,aF),aD=I(ak,ao),o='<div class="'+ai+'">{content}</div>',W='<div class="'+[K,aD,g].join(aO)+' {firstClassName} {lastClassName}">'+'<div class="'+k+'">{day}</div>'+'<a href="javascript:;" class="'+aM+'" data-timestamp="{timestamp}">{extra}</a>'+"</div>",aG='<div class="'+aQ+'">{content}</div>',aR='<div class="'+[p,g].join(aO)+' {firstClassName} {lastClassName} {eventClassName}" data-clientId="{clientId}">'+'<div class="'+al+'" style="background-color: {color};"></div>'+'<div class="'+x+'">{content}</div>'+'<div class="'+U+'">{dates}</div>'+"</div>",R='<div class="'+ad+'">{content}</div>',Y='<div class="'+aE+'">'+'<div class="'+[au,g].join(aO)+'">'+'<div class="'+[v,aD].join(aO)+'">{day}</div>'+'<div class="'+u+'">'+'<div class="'+V+'">{labelBig}</div>'+'<div class="'+G+'">{labelSmall}</div>'+"</div>"+"</div>"+"</div>";var F=aj.Component.create({NAME:ak,ATTRS:{bodyContent:{value:P},eventsDateFormatter:{value:function(aS,aW){var aZ=this,aV=aZ.get(Q),A=aV.get(O).get(at),aY=H,aX=H,aT,aU;if(!A){aY=av;aX=av;if(aS.getHours()>=12){aY+=ag;}if(aW.getHours()>=12){aX+=ag;}}if(m.isDayOverlap(aS,aW)){aY+=", %b %e";aX+=", %b %e";}aT=aa.call(aZ,aY);aU=aa.call(aZ,aX);return[aT.call(aZ,aS),w,aU.call(aZ,aW)].join(aO);},validator:aA},headerDayDateFormatter:{value:function(aT){var A=this,aS,aU;if(m.isToday(aT)){aS=h;}else{aS="%A";}aU=aa.call(A,aS);return aU.call(A,aT);},validator:aA},headerExtraDateFormatter:{validator:aA,value:aa("%B %e")},infoDayDateFormatter:{validator:aA,value:aa("%e")},infoLabelBigDateFormatter:{validator:aA,value:aa("%A")},infoLabelSmallDateFormatter:{validator:aA,value:aa("%B %d, %Y")},name:{value:az},strings:{value:{noEvents:"No future events."}}},EXTENDS:aj.SchedulerView,prototype:{bindUI:function(){var A=this,aS=A.get(s);aS.delegate(ax,A._onSchedulerEventClick,i+p,A);aS.delegate(ax,A._onEventsHeaderClick,i+aM,A);},getNextDate:function(){var A=this,aS=A.get(Q).get(T);return m.toMidnight(m.add(aS,m.DAY,1));},getPrevDate:function(){var A=this,aS=A.get(Q).get(T);return m.toLastHour(m.subtract(aS,m.DAY,1));},plotEvents:function(){var aZ=this,a0=aZ.get(L),aV=aZ.get(Q),a4=aV.get(T),a5=aZ.get(aw),aW=aZ.get(aC),aT=aZ.get(B),aU=aZ.get(n),aY=aZ.get(aq),aS=aZ.get(N),a3=[],A=aZ._getDayEventsMap(),a2=aj.Object.keys(A),a1=a2.length;aZ.set(c,aj.Lang.sub(Y,{day:aU.call(aZ,a4),labelBig:aY.call(aZ,a4),labelSmall:aS.call(aZ,a4)}));if(!aj.Object.isEmpty(A)){aP.each(D(a2),function(a9,a7){var a6=new Date(aj.Lang.toInt(a9)),ba=A[a9],a8=ba.length;a3.push(aj.Lang.sub(W,{day:aW.call(aZ,a6),extra:aT.call(aZ,a6),firstClassName:(a7===0)?t:P,lastClassName:(a7===a1-1)?J:P,timestamp:a9}));aP.each(ba,function(be,bd){var bc=m.toMidnight(new Date()),bf=be.get(ap),bb=be.get(aI);a3.push(aj.Lang.sub(aR,{clientId:be.get(aJ),color:be.get(ay),content:be.get(ah),dates:a5.call(aZ,bb,bf),eventClassName:(bb.getTime()<bc.getTime())?z:P,firstClassName:(bd===0)?l:P,lastClassName:(bd===a8-1)?j:P}));});});}else{a3.push(aj.Lang.sub(R,{content:a0[M]}));}var aX=aj.Lang.sub(o,{content:aj.Lang.sub(aG,{content:a3.join(P)})});aZ.set(af,aX);},_getDayEventsMap:function(){var A=this,aT=A.get(Q),aU=m.toMidnight(aT.get(T)),aS={};aT.eachEvent(function(aW){var aV=aW.get(aI),aY=aW.get(Z),aX;if(!aY||(aV.getTime()<aU.getTime())){return;}aX=m.safeClearTime(aV).getTime();if(!aS[aX]){aS[aX]=[];}aS[aX].push(aW);});return aS;},_onEventsHeaderClick:function(aU){var A=this,aT=A.get(Q),aW=aU.currentTarget,aV=aj.Lang.toInt(aW.getData(f))||Date.now(),aS=new Date(aV),aX=aT.getViewByName(aB);if(aX){aT.set(ar,aS);aT.set(O,aX);}},_onSchedulerEventClick:function(aV){var A=this,aW=aV.currentTarget,aT=A.get(Q),aS=aT.get(S),aU=aW.getData(ab);if(!aU){aU=aT.getEventByClientId(aW.getData(aJ));aW.setData(ab,aU);}if(aU&&aS&&!aT.get(y)){aS.set(aN,aU,{silent:true});aS.showOverlay([aV.pageX,aV.pageY]);}}}});aj.SchedulerAgendaView=F;},"@VERSION@",{requires:["aui-scheduler-base"],skinnable:true});