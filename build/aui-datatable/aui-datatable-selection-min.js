AUI.add("aui-datatable-selection",function(B){var j=B.Lang,s=j.isBoolean,v=j.isString,H=B.getClassName,h=B.cached(function(A){return A.substring(0,1).toUpperCase()+A.substring(1);}),o="cell",C="columns",f="columnsChange",m="data",i="dataChange",r="datatable",F="down",J="esc",u="focused",I="host",p="id",d="keydown",x="left",q="mousedown",E="mouseEvent",w="multiple",l="return",t="right",n="row",c="select",k="selected",y="selectRow",e="tab",z="tabindex",G="tr",g="up",a=H(r,o,k),D=H(r,n,k);var b=B.Base.create("dataTableSelection",B.Plugin.Base,[],{activeColumnIndex:-1,activeRecordIndex:-1,handlerKeyDown:null,selectedCellHash:null,selectedColumnHash:null,selectedRowHash:null,initializer:function(){var A=this;A.selectedCellHash={};A.selectedColumnHash={};A.selectedRowHash={};A.publish({select:{defaultFn:A._defSelectFn}});A.afterHostEvent(A.get(E),A._afterMouseEvent);A.afterHostEvent(f,A._afterHostColumnsChange);A.afterHostEvent(i,A._afterHostDataChange);A.handlerKeyDown=B.getDoc().on(d,B.bind(A._afterKeyEvent,A));},destroy:function(){var A=this;var K=A.handlerKeyDown;if(K){K.detach();}},getActiveColumn:function(){var A=this;var K=A.get(I);return K.get(C).getColumn(A.activeColumnIndex);},getActiveRecord:function(){var A=this;var K=A.get(I);return K.get(m).getRecord(A.activeRecordIndex);},isCellSelected:function(K){var A=this;return A.selectedCellHash[K.get(p)];},isColumnSelected:function(A){},isRowSelected:function(K){var A=this;return A.selectedRowHash[K.get(p)];},select:function(K,Q){var A=this;var O=A.get(I);var M=O.get(C);var P=O.get(m);var N=M.getColumnByCell(K);var L=P.getRecordByRow(Q||K.ancestor(G));A.activeColumnIndex=M.getColumnIndex(N);A.activeRecordIndex=P.getRecordIndex(L);if(K){A.selectCell(K);}if(A.get(y)&&Q){A.selectRow(Q);}},selectCell:function(K){var A=this;if(!A.get(w)){A.unselectAllCells();}A.selectedCellHash[K.get(p)]=K;K.setAttribute(z,0).focus();K.addClass(a);},selectColumn:function(A){},selectRow:function(K){var A=this;if(!A.get(w)){A.unselectAllRows();}A.selectedRowHash[K.get(p)]=K;K.addClass(D);},toggleCell:function(K,L){var A=this;if(L||!A.isCellSelected(K)){A.selectCell(K);}else{A.unselectCell(K);}},toggleColumn:function(A,K){},toggleRow:function(L,K){var A=this;if(K||!A.isRowSelected(L)){A.selectRow(L);}else{A.unselectRow(L);}},unselectCell:function(K){var A=this;delete A.selectedCellHash[K.get(p)];K.removeAttribute(z);K.removeClass(a);},unselectColumn:function(A){},unselectRow:function(K){var A=this;delete A.selectedRowHash[K.get(p)];K.removeClass(D);},unselectAllCells:function(){var A=this;B.each(A.selectedCellHash,B.bind(A.unselectCell,A));},unselectAllColumns:function(){},unselectAllRows:function(){var A=this;B.each(A.selectedRowHash,B.bind(A.unselectRow,A));},_afterHostColumnsChange:function(K){var A=this;A._cleanUp();},_afterHostDataChange:function(K){var A=this;A._cleanUp();},_afterMouseEvent:function(K){var A=this;A._handleSelectEvent(K);},_afterKeyEvent:function(N){var A=this;var M=A.get(I);var L=A.getActiveColumn();var K=A.getActiveRecord();if(!M.get(u)||!L||!K){return;}if(M.events){M.events.updateEventPayload(M.getCellNode(K,L),N);}if(N.isNavKey()){if(N.isKey(J)){A._onEscKey(N);}else{if(N.isKey(l)){A._onReturnKey(N);}else{A._navigate(N);}}N.halt();}},_cleanUp:function(){var A=this;A.selectedCellHash={};A.selectedColumnHash={};A.selectedRowHash={};},_defSelectFn:function(K){var A=this;A.select(K.cell,K.row);},_navigate:function(K){var A=this;A._updateNavKeyInfo(K);A._handleSelectEvent(K);},_onEscKey:function(M){var A=this;var L=A.get(I);var K=L.getCellEditor(M.record,M.column);if(K){K.hide();}},_onReturnKey:function(L){var A=this;var K=A.get(I);K._editCell(L);},_handleSelectEvent:function(K){var A=this;A.fire(c,{cell:K.cell,column:K.column,inHead:K.inHead,liner:K.liner,originalEvent:K.originalEvent,row:K.row,record:K.record});},_updateNavKeyInfo:function(A){var T=this;var U=T.get(I);var K=A.originalEvent;var M=U.get(C);var R=A.column.keyIndex;var P=U.get(m);var N=P.getRecordIndex(A.record);var L=K.ctrlKey||K.metaKey;var S=K.shiftKey;if(K.isKey(x)||(S&&K.isKey(e))){if(L){R=0;}else{R--;}}else{if(K.isKey(t)||(!S&&K.isKey(e))){if(L){R=M.getLength()-1;}else{R++;}}else{if(K.isKey(F)){if(L){N=P.getLength()-1;}else{N++;}}else{if(K.isKey(g)){if(L){N=0;}else{N--;}}}}}R=Math.max(Math.min(R,M.getLength()-1),0);N=Math.max(Math.min(N,P.getLength()-1),0);if(U.events){var O=M.getColumn(R);var Q=P.getRecord(N);U.events.updateEventPayload(U.getCellNode(Q,O),A);}},_setMouseEvent:function(A){return o+h(A);}},{NS:"selection",NAME:"dataTableSelection",ATTRS:{selectRow:{value:false,validator:s},multiple:{value:false,validator:s},mouseEvent:{setter:"_setMouseEvent",value:q,validator:v}}});B.namespace("Plugin").DataTableSelection=b;},"@VERSION@",{skinnable:true,requires:["aui-datatable-base"]});