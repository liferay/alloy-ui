AUI.add("aui-tree-view",function(ae){var W=ae.Lang,av=W.isBoolean,aA=W.isString,aw=ae.UA,r="boundingBox",e="children",a="container",ab="content",t="contentBox",U=".",at="file",T="hidden",C="hitarea",R="icon",b="invalid",ai="label",P="lastSelected",ay="leaf",q="node",Y="ownerTree",H="root",V="selectOnToggle",s=" ",g="tree",D="tree-node",N="tree-view",f="type",z="view",aB=function(){return Array.prototype.slice.call(arguments).join(s);},an=function(A){return(A instanceof ae.TreeNode);},B=ae.getClassName,aq=B(g,C),y=B(g,R),j=B(g,ai),w=B(g,q,ab),u=B(g,q,ab,b),ar=B(g,q,T,C),m=B(g,H,a),aj=B(g,z,ab);var Q=ae.Component.create({NAME:N,ATTRS:{type:{value:at,validator:aA},lastSelected:{value:null,validator:an},lazyLoad:{validator:av,value:true},selectOnToggle:{validator:av,value:false}},AUGMENTS:[ae.TreeData,ae.TreeViewPaginator,ae.TreeViewIO],prototype:{CONTENT_TEMPLATE:"<ul></ul>",initializer:function(){var A=this;var L=A.get(r);L.setData(N,A);},bindUI:function(){var A=this;A.after("childrenChange",ae.bind(A._afterSetChildren,A));A._delegateDOM();},createNodes:function(L){var A=this;ae.Array.each(ae.Array(L),function(aE){var aD=A.createNode(aE);A.appendChild(aD);});A._syncPaginatorUI(L);},renderUI:function(){var A=this;A._renderElements();},_afterSetChildren:function(L){var A=this;A._syncPaginatorUI();},_createFromHTMLMarkup:function(L){var A=this;L.all("> li").each(function(aH){var aG=aH.one("> *").remove();var aF=aG.outerHTML();var aE=aH.one("> ul");var aI=new ae.TreeNode({boundingBox:aH,container:aE,label:aF,leaf:!aE,ownerTree:A});if(aE){aI.render();A._createFromHTMLMarkup(aE);}else{aI.render();}var aD=aH.get(d).get(d);var aJ=aD.getData(D);if(!ae.instanceOf(aJ,ae.TreeNode)){aJ=aD.getData(N);}aJ.appendChild(aI);});},_createNodeContainer:function(){var A=this;var L=A.get(t);A.set(a,L);return L;},_renderElements:function(){var A=this;var L=A.get(t);var aD=A.get(e);var aE=A.get(f);var aF=B(g,aE);L.addClass(aj);L.addClass(aB(aF,m));if(!aD.length){A._createFromHTMLMarkup(L);}},_delegateDOM:function(){var A=this;var L=A.get(r);L.delegate("click",ae.bind(A._onClickNodeEl,A),U+w);L.delegate("dblclick",ae.bind(A._onClickHitArea,A),U+y);L.delegate("dblclick",ae.bind(A._onClickHitArea,A),U+j);L.delegate("mouseenter",ae.bind(A._onMouseEnterNodeEl,A),U+w);L.delegate("mouseleave",ae.bind(A._onMouseLeaveNodeEl,A),U+w);},_onClickNodeEl:function(L){var A=this;var aE=A.getNodeByChild(L.currentTarget);var aF=L.target;if(aE&&!aF.hasClass(ar)){if(aF.hasClass(aq)){aE.toggle();if(!A.get(V)){return;}}if(!aE.isSelected()){var aD=A.get(P);if(aD){aD.unselect();}aE.select();}}},_onMouseEnterNodeEl:function(L){var A=this;var aD=A.getNodeByChild(L.currentTarget);if(aD){aD.over();}},_onMouseLeaveNodeEl:function(L){var A=this;var aD=A.getNodeByChild(L.currentTarget);if(aD){aD.out();}},_onClickHitArea:function(L){var A=this;var aD=A.getNodeByChild(L.currentTarget);if(aD){aD.toggle();}}}});ae.TreeView=Q;var M=W.isNumber,af="above",c="append",ah="below",ap="block",ak="body",az="clearfix",ad="default",v="display",am="down",x="drag",n="draggable",aa="dragCursor",au="dragNode",i="expanded",o="helper",ax="insert",F="offsetHeight",d="parentNode",aC="scrollDelay",O="state",al="tree-drag-drop",ao="up",K=ae.DD.DDM,ag=B(o,az),k=B(R),ac=B(g,x,o),p=B(g,x,o,ab),J=B(g,x,o,ai),G=B(g,x,ax,af),Z=B(g,x,ax,c),I=B(g,x,ax,ah),l=B(g,x,O,c),S=B(g,x,O,ax,af),X=B(g,x,O,ax,ah),E='<div class="'+ac+'">'+'<div class="'+[p,ag].join(s)+'">'+'<span class="'+k+'"></span>'+'<span class="'+J+'"></span>'+"</div>"+"</div>";var h=ae.Component.create({NAME:al,ATTRS:{helper:{value:null},scrollDelay:{value:100,validator:M}},EXTENDS:ae.TreeView,prototype:{direction:ah,dropAction:null,lastY:0,node:null,nodeContent:null,destructor:function(){var A=this;var L=A.get(o);if(L){L.remove(true);}if(A.ddDelegate){A.ddDelegate.destroy();}},bindUI:function(){var A=this;ae.TreeViewDD.superclass.bindUI.apply(this,arguments);A._bindDragDrop();},renderUI:function(){var A=this;ae.TreeViewDD.superclass.renderUI.apply(this,arguments);var L=ae.Node.create(E).hide();ae.one(ak).append(L);A.set(o,L);K.set(aa,ad);},_bindDragDrop:function(){var A=this,aD=A.get(r),L=null;A._createDragInitHandler=function(){A.ddDelegate=new ae.DD.Delegate({bubbleTargets:A,container:aD,invalid:U+u,nodes:U+w,target:true});var aE=A.ddDelegate.dd;aE.plug(ae.Plugin.DDProxy,{moveOnEnd:false,positionProxy:false,borderStyle:null}).plug(ae.Plugin.DDNodeScroll,{scrollDelay:A.get(aC),node:aD});aE.removeInvalid("a");if(L){L.detach();}};if(!aw.touch){L=aD.on(["focus","mousedown","mousemove"],A._createDragInitHandler);}else{A._createDragInitHandler();}A.on("drag:align",A._onDragAlign);A.on("drag:start",A._onDragStart);A.on("drop:exit",A._onDropExit);A.after("drop:hit",A._afterDropHit);A.on("drop:hit",A._onDropHit);A.on("drop:over",A._onDropOver);},_appendState:function(L){var A=this;A.dropAction=c;A.get(o).addClass(l);L.addClass(Z);},_goingDownState:function(L){var A=this;A.dropAction=ah;A.get(o).addClass(X);L.addClass(I);},_goingUpState:function(L){var A=this;A.dropAction=af;A.get(o).addClass(S);L.addClass(G);},_resetState:function(L){var A=this;var aD=A.get(o);aD.removeClass(l);aD.removeClass(S);aD.removeClass(X);if(L){L.removeClass(G);L.removeClass(Z);L.removeClass(I);}},_updateNodeState:function(A){var aM=this;var aI=A.drag;var aF=A.drop;var L=aF.get(q);var aL=L.get(d);var aH=aI.get(q).get(d);var aE=aL.getData(D);aM._resetState(aM.nodeContent);if(!aH.contains(aL)){var aN=L.get(F)/3;var aD=L.getY();var aK=aD+aN;var aJ=aD+aN*2;var aG=aI.mouseXY[1];if((aG>aD)&&(aG<aK)){aM._goingUpState(L);}else{if(aG>aJ){aM._goingDownState(L);}else{if((aG>aK)&&(aG<aJ)){if(aE&&!aE.isLeaf()){aM._appendState(L);}else{if(aM.direction===ao){aM._goingUpState(L);}else{aM._goingDownState(L);}}}}}}aM.nodeContent=L;},_afterDropHit:function(aF){var A=this;var aH=A.dropAction;var aG=aF.drag.get(q).get(d);var aD=aF.drop.get(q).get(d);var aI=aD.getData(D);var aE=aG.getData(D);var L=A.getEventOutputMap(A);L.tree.dropNode=aI;L.tree.dragNode=aE;if(aH===af){aI.insertBefore(aE);
A.bubbleEvent("dropInsert",L);}else{if(aH===ah){aI.insertAfter(aE);A.bubbleEvent("dropInsert",L);}else{if(aH===c){if(aI&&!aI.isLeaf()){aI.appendChild(aE);if(!aI.get(i)){aI.expand();}A.bubbleEvent("dropAppend",L);}}}}A._resetState(A.nodeContent);A.bubbleEvent("drop",L);A.dropAction=null;},_onDragAlign:function(aD){var A=this;var L=A.lastY;var aE=aD.target.lastXY[1];if(aE!==L){A.direction=(aE<L)?ao:am;}A.lastY=aE;},_onDragStart:function(aG){var A=this;var aE=aG.target;var aI=aE.get(q).get(d);var aD=aI.getData(D);var aH=A.get(P);if(aH){aH.unselect();}aD.select();var aF=A.get(o);var L=aF.one(U+J);aF.setStyle(v,ap).show();L.html(aD.get(ai));aE.set(au,aF);},_onDropOver:function(L){var A=this;A._updateNodeState(L);},_onDropHit:function(L){var A=L.drop.get(q).get(d);var aD=A.getData(D);if(!an(aD)){L.preventDefault();}},_onDropExit:function(){var A=this;A.dropAction=null;A._resetState(A.nodeContent);}}});ae.TreeViewDD=h;},"@VERSION@",{skinnable:true,requires:["aui-tree-node","aui-tree-paginator","aui-tree-io","dd-delegate","dd-proxy"]});