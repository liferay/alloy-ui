AUI.add("aui-tree-view",function(y){var q=y.Lang,r=q.isString,ao="boundingBox",F="children",h="container",aa="content",S="contentBox",O=".",ad="file",al="hitarea",W="icon",aq="label",b="lastSelected",t="leaf",au="node",ai="ownerTree",am="root",a=" ",ab="tree",at="tree-node",H="tree-view",D="type",J="view",R=function(){return Array.prototype.slice.call(arguments).join(a);},X=function(A){return(A instanceof y.TreeNode);},o=y.getClassName,C=o(ab,al),s=o(ab,W),n=o(ab,aq),Q=o(ab,au,aa),G=o(ab,am,h),j=o(ab,J,aa);var v=y.Component.create({NAME:H,ATTRS:{type:{value:ad,validator:r},lastSelected:{value:null,validator:X},io:{value:null},paginator:{value:null}},AUGMENTS:[y.TreeData],prototype:{CONTENT_TEMPLATE:"<ul></ul>",initializer:function(){var A=this;var aw=A.get(ao);var L=A.get(S);A.set(h,L);aw.setData(H,A);},bindUI:function(){var A=this;A._delegateDOM();},renderUI:function(){var A=this;A._renderElements();},syncUI:function(){var A=this;A.refreshIndex();},registerNode:function(L){var A=this;L.set(ai,A);y.TreeView.superclass.registerNode.apply(this,arguments);},_createFromHTMLMarkup:function(L){var A=this;L.all("> li").each(function(aA){var az=aA.one("> *").remove();var ay=az.outerHTML();var aB=new y.TreeNode({boundingBox:aA,label:ay});var ax=aA.one("> ul");if(ax){aB.set(t,false);aB.set(h,ax);aB.render();A._createFromHTMLMarkup(ax);}else{aB.render();}var aw=aA.get(u).get(u);var aC=aw.getData(at);if(!y.instanceOf(aC,y.TreeNode)){aC=aw.getData(H);}aC.appendChild(aB);});},_renderElements:function(){var A=this;var L=A.get(S);var aw=A.get(F);var ax=A.get(D);var ay=o(ab,ax);L.addClass(j);L.addClass(R(ay,G));if(!aw.length){A._createFromHTMLMarkup(L);}},_delegateDOM:function(){var A=this;var L=A.get(ao);L.delegate("click",y.bind(A._onClickHitArea,A),O+C);L.delegate("dblclick",y.bind(A._onClickHitArea,A),O+s);L.delegate("dblclick",y.bind(A._onClickHitArea,A),O+n);L.delegate("mouseenter",y.bind(A._onMouseEnterNodeEl,A),O+Q);L.delegate("mouseleave",y.bind(A._onMouseLeaveNodeEl,A),O+Q);L.delegate("click",y.bind(A._onClickNodeEl,A),O+Q);},_onClickNodeEl:function(L){var A=this;var ax=A.getNodeByChild(L.currentTarget);if(ax&&!ax.isSelected()){var aw=A.get(b);if(aw){aw.unselect();}ax.select();}},_onMouseEnterNodeEl:function(L){var A=this;var aw=A.getNodeByChild(L.currentTarget);if(aw){aw.over();}},_onMouseLeaveNodeEl:function(L){var A=this;var aw=A.getNodeByChild(L.currentTarget);if(aw){aw.out();}},_onClickHitArea:function(L){var A=this;var aw=A.getNodeByChild(L.currentTarget);if(aw){aw.toggle();}}}});y.TreeView=v;var av=q.isNumber,E="above",x="append",ae="below",B="block",aj="body",g="clearfix",ag="default",d="display",T="down",N="drag",w="draggable",ap="dragCursor",m="dragNode",c="expanded",ah="helper",af="insert",Z="offsetHeight",u="parentNode",V="scrollDelay",k="state",ac="tree-drag-drop",I="up",l=y.DD.DDM,p=o(ah,g),an=o(W),P=o(ab,N,ah),i=o(ab,N,ah,aa),z=o(ab,N,ah,aq),f=o(ab,N,af,E),ar=o(ab,N,af,x),M=o(ab,N,af,ae),Y=o(ab,N,k,x),K=o(ab,N,k,af,E),ak=o(ab,N,k,af,ae),e='<div class="'+P+'">'+'<div class="'+[i,p].join(a)+'">'+'<span class="'+an+'"></span>'+'<span class="'+z+'"></span>'+"</div>"+"</div>";var U=y.Component.create({NAME:ac,ATTRS:{helper:{value:null},scrollDelay:{value:100,validator:av}},EXTENDS:y.TreeView,prototype:{direction:ae,dropAction:null,lastY:0,node:null,nodeContent:null,destructor:function(){var A=this;var L=A.get(ah);if(L){L.remove(true);}A.eachChildren(function(ax){if(ax.get(w)){var aw=l.getDrag(ax.get(S));if(aw){aw.destroy();}}},true);},bindUI:function(){var A=this;y.TreeViewDD.superclass.bindUI.apply(this,arguments);A._bindDragDrop();},renderUI:function(){var A=this;y.TreeViewDD.superclass.renderUI.apply(this,arguments);var L=y.Node.create(e).hide();y.one(aj).append(L);A.set(ah,L);l.set(ap,ag);},_createDrag:function(ax){var L=this;if(!L.dragTimers){L.dragTimers=[];}if(!l.getDrag(ax)){var A=L.dragTimers;var aw=50*A.length;var ay=setTimeout(function(){if(!l.getDrag(ax)){var az=new y.DD.Drag({bubbleTargets:L,node:ax,target:true}).plug(y.Plugin.DDProxy,{moveOnEnd:false,positionProxy:false,borderStyle:null}).plug(y.Plugin.DDNodeScroll,{scrollDelay:L.get(V),node:L.get(ao)});az.removeInvalid("a");}y.Array.removeItem(A,ay);},aw);A.push(ay);}},_bindDragDrop:function(){var A=this;var L=A.get(ao);A._createDragInitHandler=y.bind(function(){A.eachChildren(function(aw){if(aw.get(w)){A._createDrag(aw.get(S));}},true);L.detach("mouseover",A._createDragInitHandler);},A);L.on("mouseover",A._createDragInitHandler);A.after("insert",y.bind(A._afterAppend,A));A.after("append",y.bind(A._afterAppend,A));A.on("drag:align",A._onDragAlign);A.on("drag:start",A._onDragStart);A.on("drop:exit",A._onDropExit);A.after("drop:hit",A._afterDropHit);A.on("drop:hit",A._onDropHit);A.on("drop:over",A._onDropOver);},_appendState:function(L){var A=this;A.dropAction=x;A.get(ah).addClass(Y);L.addClass(ar);},_goingDownState:function(L){var A=this;A.dropAction=ae;A.get(ah).addClass(ak);L.addClass(M);},_goingUpState:function(L){var A=this;A.dropAction=E;A.get(ah).addClass(K);L.addClass(f);},_resetState:function(L){var A=this;var aw=A.get(ah);aw.removeClass(Y);aw.removeClass(K);aw.removeClass(ak);if(L){L.removeClass(f);L.removeClass(ar);L.removeClass(M);}},_updateNodeState:function(A){var aF=this;var aB=A.drag;var ay=A.drop;var L=ay.get(au);var aE=L.get(u);var aA=aB.get(au).get(u);var ax=aE.getData(at);aF._resetState(aF.nodeContent);if(!aA.contains(aE)){var aG=L.get(Z)/3;var aw=L.getY();var aD=aw+aG;var aC=aw+aG*2;var az=aB.mouseXY[1];if((az>aw)&&(az<aD)){aF._goingUpState(L);}else{if(az>aC){aF._goingDownState(L);}else{if((az>aD)&&(az<aC)){if(ax&&!ax.isLeaf()){aF._appendState(L);}else{if(aF.direction===I){aF._goingUpState(L);}else{aF._goingDownState(L);}}}}}}aF.nodeContent=L;},_afterAppend:function(L){var A=this;var aw=L.tree.node;if(aw.get(w)){A._createDrag(aw.get(S));}},_afterDropHit:function(ay){var A=this;var aA=A.dropAction;var az=ay.drag.get(au).get(u);var aw=ay.drop.get(au).get(u);var aB=aw.getData(at);var ax=az.getData(at);var L=A.getEventOutputMap(A);
L.tree.dropNode=aB;L.tree.dragNode=ax;if(aA===E){aB.insertBefore(ax);A.bubbleEvent("dropInsert",L);}else{if(aA===ae){aB.insertAfter(ax);A.bubbleEvent("dropInsert",L);}else{if(aA===x){if(aB&&!aB.isLeaf()){aB.appendChild(ax);if(!aB.get(c)){aB.expand();}A.bubbleEvent("dropAppend",L);}}}}A._resetState(A.nodeContent);A.bubbleEvent("drop",L);A.dropAction=null;},_onDragAlign:function(aw){var A=this;var L=A.lastY;var ax=aw.target.lastXY[1];if(ax!==L){A.direction=(ax<L)?I:T;}A.lastY=ax;},_onDragStart:function(az){var A=this;var ax=az.target;var aB=ax.get(au).get(u);var aw=aB.getData(at);var aA=A.get(b);if(aA){aA.unselect();}aw.select();var ay=A.get(ah);var L=ay.one(O+z);ay.setStyle(d,B).show();L.html(aw.get(aq));ax.set(m,ay);},_onDropOver:function(L){var A=this;A._updateNodeState(L);},_onDropHit:function(L){var A=L.drop.get(au).get(u);var aw=A.getData(at);if(!X(aw)){L.preventDefault();}},_onDropExit:function(){var A=this;A.dropAction=null;A._resetState(A.nodeContent);}}});y.TreeViewDD=U;},"@VERSION@",{skinnable:true,requires:["aui-tree-node","dd-drag","dd-drop","dd-proxy"]});